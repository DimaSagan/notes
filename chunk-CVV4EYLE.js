import{n as Ws,o as bp}from"./chunk-GBOIA3S4.js";import{$ as dt,$a as vp,A as Xe,B as sp,C as Au,Cb as fi,Db as Ep,Ea as Pu,Eb as Gs,F as Jn,Fa as In,Fb as Hs,G as Xn,Gb as Tp,H as hi,Ha as pp,Hb as Ap,Ia as En,Ib as xu,J as Du,Ja as qe,Jb as Fu,K as Zn,Ka as Nu,La as zs,Lb as Dp,M as op,Ma as gp,Na as ku,Nb as nr,Oa as mp,Ob as Sp,Pa as tn,Q as Us,Qa as Ou,Qb as Lu,R as en,Sa as tr,T as Su,U as ap,Ua as nn,Va as yp,Wa as qs,X as up,Xa as Mu,_ as cp,_a as _p,a as F,aa as lp,b as Te,ba as Ae,c as Jt,d as v,da as ye,e as Zf,f as ep,fa as Y,g as Xt,ga as Bs,h as vu,ha as hp,i as wu,ia as pe,j as Rt,ja as bu,jb as wp,k as Je,ka as ie,la as V,lb as Ze,m as tp,mb as _e,n as np,na as Pt,o as Zt,p as Vs,pa as di,q as Iu,qa as dp,r as Eu,ra as $s,s as at,sa as er,t as q,ta as Cu,u as li,ua as wn,v as rp,va as fp,w as ip,wa as js,xa as Nt,xb as Ip,y as ue,z as Tu,za as Ru}from"./chunk-CWLYJARK.js";var kp=null;function rr(){return kp}function Op(n){kp??=n}var no=class{};var tt=new pe(""),Mp=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>V(Dv),providedIn:"platform"})}}return n})();var Dv=(()=>{class n extends Mp{constructor(){super(),this._doc=V(tt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return rr().getBaseHref(this._doc)}onPopState(t){let r=rr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=rr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function xp(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function Cp(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Tn(n){return n&&n[0]!=="?"?"?"+n:n}var so=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>V(Fp),providedIn:"root"})}}return n})(),Sv=new pe(""),Fp=(()=>{class n extends so{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??V(tt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return xp(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Tn(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+Tn(s));this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+Tn(s));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(ie(Mp),ie(Sv,8))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var pi=(()=>{class n{constructor(t){this._subject=new En,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=Rv(Cp(Rp(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Tn(r))}normalize(t){return n.stripTrailingSlash(Cv(this._basePath,Rp(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Tn(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Tn(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Tn}static{this.joinWithSlash=xp}static{this.stripTrailingSlash=Cp}static{this.\u0275fac=function(r){return new(r||n)(ie(so))}}static{this.\u0275prov=Y({token:n,factory:()=>bv(),providedIn:"root"})}}return n})();function bv(){return new pi(ie(so))}function Cv(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Rp(n){return n.replace(/\/index.html$/,"")}function Rv(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var je=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(je||{}),ae=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(ae||{}),Ge=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Ge||{}),rn={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Pv(n){return Ze(n)[_e.LocaleId]}function Nv(n,e,t){let r=Ze(n),i=[r[_e.DayPeriodsFormat],r[_e.DayPeriodsStandalone]],s=et(i,e);return et(s,t)}function kv(n,e,t){let r=Ze(n),i=[r[_e.DaysFormat],r[_e.DaysStandalone]],s=et(i,e);return et(s,t)}function Ov(n,e,t){let r=Ze(n),i=[r[_e.MonthsFormat],r[_e.MonthsStandalone]],s=et(i,e);return et(s,t)}function Mv(n,e){let r=Ze(n)[_e.Eras];return et(r,e)}function Ks(n,e){let t=Ze(n);return et(t[_e.DateFormat],e)}function Qs(n,e){let t=Ze(n);return et(t[_e.TimeFormat],e)}function Ys(n,e){let r=Ze(n)[_e.DateTimeFormat];return et(r,e)}function oo(n,e){let t=Ze(n),r=t[_e.NumberSymbols][e];if(typeof r>"u"){if(e===rn.CurrencyDecimal)return t[_e.NumberSymbols][rn.Decimal];if(e===rn.CurrencyGroup)return t[_e.NumberSymbols][rn.Group]}return r}function Lp(n){if(!n[_e.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[_e.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function xv(n){let e=Ze(n);return Lp(e),(e[_e.ExtraData][2]||[]).map(r=>typeof r=="string"?Vu(r):[Vu(r[0]),Vu(r[1])])}function Fv(n,e,t){let r=Ze(n);Lp(r);let i=[r[_e.ExtraData][0],r[_e.ExtraData][1]],s=et(i,e)||[];return et(s,t)||[]}function et(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function Vu(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var Lv=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Js={},Vv=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,Ot=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(Ot||{}),te=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(te||{}),ee=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}(ee||{});function Uv(n,e,t,r){let i=Kv(n);e=kt(t,e)||e;let a=[],u;for(;e;)if(u=Vv.exec(e),u){a=a.concat(u.slice(1));let p=a.pop();if(!p)break;e=p}else{a.push(e);break}let c=i.getTimezoneOffset();r&&(c=Up(r,c),i=Wv(i,r,!0));let d="";return a.forEach(p=>{let m=Gv(p);d+=m?m(i,t,c):p==="''"?"'":p.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function ro(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function kt(n,e){let t=Pv(n);if(Js[t]??={},Js[t][e])return Js[t][e];let r="";switch(e){case"shortDate":r=Ks(n,Ge.Short);break;case"mediumDate":r=Ks(n,Ge.Medium);break;case"longDate":r=Ks(n,Ge.Long);break;case"fullDate":r=Ks(n,Ge.Full);break;case"shortTime":r=Qs(n,Ge.Short);break;case"mediumTime":r=Qs(n,Ge.Medium);break;case"longTime":r=Qs(n,Ge.Long);break;case"fullTime":r=Qs(n,Ge.Full);break;case"short":let i=kt(n,"shortTime"),s=kt(n,"shortDate");r=Xs(Ys(n,Ge.Short),[i,s]);break;case"medium":let a=kt(n,"mediumTime"),u=kt(n,"mediumDate");r=Xs(Ys(n,Ge.Medium),[a,u]);break;case"long":let c=kt(n,"longTime"),d=kt(n,"longDate");r=Xs(Ys(n,Ge.Long),[c,d]);break;case"full":let p=kt(n,"fullTime"),m=kt(n,"fullDate");r=Xs(Ys(n,Ge.Full),[p,m]);break}return r&&(Js[t][e]=r),r}function Xs(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function ut(n,e,t="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=t));let a=String(n);for(;a.length<e;)a="0"+a;return r&&(a=a.slice(a.length-e)),s+a}function Bv(n,e){return ut(n,3).substring(0,e)}function ve(n,e,t=0,r=!1,i=!1){return function(s,a){let u=$v(n,s);if((t>0||u>-t)&&(u+=t),n===te.Hours)u===0&&t===-12&&(u=12);else if(n===te.FractionalSeconds)return Bv(u,e);let c=oo(a,rn.MinusSign);return ut(u,e,c,r,i)}}function $v(n,e){switch(n){case te.FullYear:return e.getFullYear();case te.Month:return e.getMonth();case te.Date:return e.getDate();case te.Hours:return e.getHours();case te.Minutes:return e.getMinutes();case te.Seconds:return e.getSeconds();case te.FractionalSeconds:return e.getMilliseconds();case te.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function ce(n,e,t=je.Format,r=!1){return function(i,s){return jv(i,s,n,e,t,r)}}function jv(n,e,t,r,i,s){switch(t){case ee.Months:return Ov(e,i,r)[n.getMonth()];case ee.Days:return kv(e,i,r)[n.getDay()];case ee.DayPeriods:let a=n.getHours(),u=n.getMinutes();if(s){let d=xv(e),p=Fv(e,i,r),m=d.findIndex(I=>{if(Array.isArray(I)){let[b,R]=I,O=a>=b.hours&&u>=b.minutes,P=a<R.hours||a===R.hours&&u<R.minutes;if(b.hours<R.hours){if(O&&P)return!0}else if(O||P)return!0}else if(I.hours===a&&I.minutes===u)return!0;return!1});if(m!==-1)return p[m]}return Nv(e,i,r)[a<12?0:1];case ee.Eras:return Mv(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function Zs(n){return function(e,t,r){let i=-1*r,s=oo(t,rn.MinusSign),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case Ot.Short:return(i>=0?"+":"")+ut(a,2,s)+ut(Math.abs(i%60),2,s);case Ot.ShortGMT:return"GMT"+(i>=0?"+":"")+ut(a,1,s);case Ot.Long:return"GMT"+(i>=0?"+":"")+ut(a,2,s)+":"+ut(Math.abs(i%60),2,s);case Ot.Extended:return r===0?"Z":(i>=0?"+":"")+ut(a,2,s)+":"+ut(Math.abs(i%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}var zv=0,to=4;function qv(n){let e=ro(n,zv,1).getDay();return ro(n,0,1+(e<=to?to:to+7)-e)}function Vp(n){let e=n.getDay(),t=e===0?-3:to-e;return ro(n.getFullYear(),n.getMonth(),n.getDate()+t)}function Uu(n,e=!1){return function(t,r){let i;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,a=t.getDate();i=1+Math.floor((a+s)/7)}else{let s=Vp(t),a=qv(s.getFullYear()),u=s.getTime()-a.getTime();i=1+Math.round(u/6048e5)}return ut(i,n,oo(r,rn.MinusSign))}}function eo(n,e=!1){return function(t,r){let s=Vp(t).getFullYear();return ut(s,n,oo(r,rn.MinusSign),e)}}var Bu={};function Gv(n){if(Bu[n])return Bu[n];let e;switch(n){case"G":case"GG":case"GGG":e=ce(ee.Eras,ae.Abbreviated);break;case"GGGG":e=ce(ee.Eras,ae.Wide);break;case"GGGGG":e=ce(ee.Eras,ae.Narrow);break;case"y":e=ve(te.FullYear,1,0,!1,!0);break;case"yy":e=ve(te.FullYear,2,0,!0,!0);break;case"yyy":e=ve(te.FullYear,3,0,!1,!0);break;case"yyyy":e=ve(te.FullYear,4,0,!1,!0);break;case"Y":e=eo(1);break;case"YY":e=eo(2,!0);break;case"YYY":e=eo(3);break;case"YYYY":e=eo(4);break;case"M":case"L":e=ve(te.Month,1,1);break;case"MM":case"LL":e=ve(te.Month,2,1);break;case"MMM":e=ce(ee.Months,ae.Abbreviated);break;case"MMMM":e=ce(ee.Months,ae.Wide);break;case"MMMMM":e=ce(ee.Months,ae.Narrow);break;case"LLL":e=ce(ee.Months,ae.Abbreviated,je.Standalone);break;case"LLLL":e=ce(ee.Months,ae.Wide,je.Standalone);break;case"LLLLL":e=ce(ee.Months,ae.Narrow,je.Standalone);break;case"w":e=Uu(1);break;case"ww":e=Uu(2);break;case"W":e=Uu(1,!0);break;case"d":e=ve(te.Date,1);break;case"dd":e=ve(te.Date,2);break;case"c":case"cc":e=ve(te.Day,1);break;case"ccc":e=ce(ee.Days,ae.Abbreviated,je.Standalone);break;case"cccc":e=ce(ee.Days,ae.Wide,je.Standalone);break;case"ccccc":e=ce(ee.Days,ae.Narrow,je.Standalone);break;case"cccccc":e=ce(ee.Days,ae.Short,je.Standalone);break;case"E":case"EE":case"EEE":e=ce(ee.Days,ae.Abbreviated);break;case"EEEE":e=ce(ee.Days,ae.Wide);break;case"EEEEE":e=ce(ee.Days,ae.Narrow);break;case"EEEEEE":e=ce(ee.Days,ae.Short);break;case"a":case"aa":case"aaa":e=ce(ee.DayPeriods,ae.Abbreviated);break;case"aaaa":e=ce(ee.DayPeriods,ae.Wide);break;case"aaaaa":e=ce(ee.DayPeriods,ae.Narrow);break;case"b":case"bb":case"bbb":e=ce(ee.DayPeriods,ae.Abbreviated,je.Standalone,!0);break;case"bbbb":e=ce(ee.DayPeriods,ae.Wide,je.Standalone,!0);break;case"bbbbb":e=ce(ee.DayPeriods,ae.Narrow,je.Standalone,!0);break;case"B":case"BB":case"BBB":e=ce(ee.DayPeriods,ae.Abbreviated,je.Format,!0);break;case"BBBB":e=ce(ee.DayPeriods,ae.Wide,je.Format,!0);break;case"BBBBB":e=ce(ee.DayPeriods,ae.Narrow,je.Format,!0);break;case"h":e=ve(te.Hours,1,-12);break;case"hh":e=ve(te.Hours,2,-12);break;case"H":e=ve(te.Hours,1);break;case"HH":e=ve(te.Hours,2);break;case"m":e=ve(te.Minutes,1);break;case"mm":e=ve(te.Minutes,2);break;case"s":e=ve(te.Seconds,1);break;case"ss":e=ve(te.Seconds,2);break;case"S":e=ve(te.FractionalSeconds,1);break;case"SS":e=ve(te.FractionalSeconds,2);break;case"SSS":e=ve(te.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=Zs(Ot.Short);break;case"ZZZZZ":e=Zs(Ot.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Zs(Ot.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=Zs(Ot.Long);break;default:return null}return Bu[n]=e,e}function Up(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function Hv(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function Wv(n,e,t){let r=t?-1:1,i=n.getTimezoneOffset(),s=Up(e,i);return Hv(n,r*(s-i))}function Kv(n){if(Pp(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,a=1]=n.split("-").map(u=>+u);return ro(i,s-1,a)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(Lv))return Qv(r)}let e=new Date(n);if(!Pp(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function Qv(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let a=Number(n[4]||0)-t,u=Number(n[5]||0)-r,c=Number(n[6]||0),d=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,a,u,c,d),e}function Pp(n){return n instanceof Date&&!isNaN(n.valueOf())}function Bp(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var $u=/\s+/,Np=[],xb=(()=>{class n{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=Np,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split($u):Np}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split($u):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split($u).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||n)(nn(zs),nn(qs))}}static{this.\u0275dir=er({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();function $p(n,e){return new ye(2100,!1)}var ju=class{createSubscription(e,t){return Lu(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){Lu(()=>e.unsubscribe())}},zu=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},Yv=new zu,Jv=new ju,Fb=(()=>{class n{constructor(t){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(Hs(t))return Yv;if(Tp(t))return Jv;throw $p(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(r){return new(r||n)(nn(nr,16))}}static{this.\u0275pipe=Cu({name:"async",type:n,pure:!1,standalone:!0})}}return n})();var Xv="mediumDate",Zv=new pe(""),ew=new pe(""),Lb=(()=>{class n{constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,s){if(t==null||t===""||t!==t)return null;try{let a=r??this.defaultOptions?.dateFormat??Xv,u=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return Uv(t,a,s||this.locale,u)}catch(a){throw $p(n,a.message)}}static{this.\u0275fac=function(r){return new(r||n)(nn(Dp,16),nn(Zv,24),nn(ew,24))}}static{this.\u0275pipe=Cu({name:"date",type:n,pure:!0,standalone:!0})}}return n})();var tw=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=$s({type:n})}static{this.\u0275inj=Bs({})}}return n})(),jp="browser",nw="server";function qu(n){return n===nw}var io=class{};var Wu=class extends no{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ku=class n extends Wu{static makeCurrent(){Op(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=iw();return t==null?null:sw(t)}resetBaseElement(){gi=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Bp(document.cookie,e)}},gi=null;function iw(){return gi=gi||document.querySelector("base"),gi?gi.getAttribute("href"):null}function sw(n){return new URL(n,document.baseURI).pathname}var ow=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Qu=new pe(""),Hp=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new ye(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(ie(Qu),ie(qe))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),ao=class{constructor(e){this._doc=e}},Gu="ng-app-id",Wp=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=qu(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${Gu}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(Gu),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(Gu,this.appId),t.appendChild(a),a}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,a=s.get(r)?.elements;a?a.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(ie(tt),ie(ku),ie(Ou,8),ie(tn))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Hu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Ju=/%COMP%/g,Kp="%COMP%",aw=`_nghost-${Kp}`,uw=`_ngcontent-${Kp}`,cw=!0,lw=new pe("",{providedIn:"root",factory:()=>cw});function hw(n){return uw.replace(Ju,n)}function dw(n){return aw.replace(Ju,n)}function Qp(n,e){return e.map(t=>t.replace(Ju,n))}var zp=(()=>{class n{constructor(t,r,i,s,a,u,c,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=qu(u),this.defaultRenderer=new mi(t,a,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===di.ShadowDom&&(r=Te(F({},r),{encapsulation:di.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof uo?i.applyToHost(t):i instanceof yi&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let a=this.doc,u=this.ngZone,c=this.eventManager,d=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(r.encapsulation){case di.Emulated:s=new uo(c,d,r,this.appId,p,a,u,m);break;case di.ShadowDom:return new Yu(c,d,t,r,a,u,this.nonce,m);default:s=new yi(c,d,r,p,a,u,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(ie(Hp),ie(Wp),ie(ku),ie(lw),ie(tt),ie(tn),ie(qe),ie(Ou))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),mi=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Hu[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(qp(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(qp(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ye(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Hu[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Hu[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(tr.DashCase|tr.Important)?e.style.setProperty(t,r,i&tr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&tr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=rr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function qp(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Yu=class extends mi{constructor(e,t,r,i,s,a,u,c){super(e,s,a,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=Qp(i.id,i.styles);for(let p of d){let m=document.createElement("style");u&&m.setAttribute("nonce",u),m.textContent=p,this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},yi=class extends mi{constructor(e,t,r,i,s,a,u,c){super(e,s,a,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?Qp(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},uo=class extends yi{constructor(e,t,r,i,s,a,u,c){let d=i+"-"+r.id;super(e,t,r,s,a,u,c,d),this.contentAttr=hw(d),this.hostAttr=dw(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},fw=(()=>{class n extends ao{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(ie(tt))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})(),Gp=["alt","control","meta","shift"],pw={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},gw={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},mw=(()=>{class n extends ao{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>rr().onAndCancel(t,s.domEventName,a))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),a="",u=r.indexOf("code");if(u>-1&&(r.splice(u,1),a="code."),Gp.forEach(d=>{let p=r.indexOf(d);p>-1&&(r.splice(p,1),a+=d+".")}),a+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=a,c}static matchEventFullKeyCode(t,r){let i=pw[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Gp.forEach(a=>{if(a!==i){let u=gw[a];u(t)&&(s+=a+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(ie(tt))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac})}}return n})();function gC(n,e){return Sp(F({rootComponent:n},yw(e)))}function yw(n){return{appProviders:[...Ew,...n?.providers??[]],platformProviders:Iw}}function _w(){Ku.makeCurrent()}function vw(){return new Nu}function ww(){return gp(document),document}var Iw=[{provide:tn,useValue:jp},{provide:mp,useValue:_w,multi:!0},{provide:tt,useFactory:ww,deps:[]}];var Ew=[{provide:fp,useValue:"root"},{provide:Nu,useFactory:vw,deps:[]},{provide:Qu,useClass:fw,multi:!0,deps:[tt,qe,tn]},{provide:Qu,useClass:mw,multi:!0,deps:[tt]},zp,Wp,Hp,{provide:yp,useExisting:zp},{provide:io,useClass:ow,deps:[]},[]];var Yp=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(ie(tt))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Xp=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Aw=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Zp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,p=s>>2,m=(s&3)<<4|u>>4,I=(u&15)<<2|d>>6,b=d&63;c||(b=64,a||(I=64)),r.push(t[p],t[m],t[I],t[b])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xp(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Aw(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||m==null)throw new Zu;let I=s<<2|u>>4;if(r.push(I),d!==64){let b=u<<4&240|d>>2;if(r.push(b),m!==64){let R=d<<6&192|m;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Zu=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Dw=function(n){let e=Xp(n);return Zp.encodeByteArray(e,!0)},_i=function(n){return Dw(n).replace(/\./g,"")},tc=function(n){try{return Zp.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Sw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var bw=()=>Sw().__FIREBASE_DEFAULTS__,Cw=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Rw=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&tc(n[1]);return e&&JSON.parse(e)},lo=()=>{try{return bw()||Cw()||Rw()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},nc=n=>{var e,t;return(t=(e=lo())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},eg=n=>{let e=nc(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},rc=()=>{var n;return(n=lo())===null||n===void 0?void 0:n.config},ic=n=>{var e;return(e=lo())===null||e===void 0?void 0:e[`_${n}`]};var co=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function tg(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[_i(JSON.stringify(t)),_i(JSON.stringify(a)),""].join(".")}function De(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ng(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(De())}function Pw(){var n;let e=(n=lo())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rg(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ig(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function sg(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function og(){let n=De();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ag(){return!Pw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sc(){try{return typeof indexedDB=="object"}catch{return!1}}function ug(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var Nw="FirebaseError",He=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Nw,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mt.prototype.create)}},Mt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?kw(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new He(i,u,r)}};function kw(n,e){return n.replace(Ow,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Ow=/\{\$([^}]+)}/g;function cg(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function An(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(Jp(s)&&Jp(a)){if(!An(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Jp(n){return n!==null&&typeof n=="object"}function sr(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function lg(n,e){let t=new ec(n,e);return t.subscribe.bind(t)}var ec=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Mw(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Xu),i.error===void 0&&(i.error=Xu),i.complete===void 0&&(i.complete=Xu);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Mw(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Xu(){}var yC=4*60*60*1e3;function Se(n){return n&&n._delegate?n._delegate:n}var nt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Dn="[DEFAULT]";var oc=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new co;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Fw(e))try{this.getOrInitializeService({instanceIdentifier:Dn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Dn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return v(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Dn){return this.instances.has(e)}getOptions(e=Dn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:xw(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Dn){return this.component?this.component.multipleInstances?e:Dn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function xw(n){return n===Dn?void 0:n}function Fw(n){return n.instantiationMode==="EAGER"}var ho=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new oc(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Lw=[],K=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(K||{}),Vw={debug:K.DEBUG,verbose:K.VERBOSE,info:K.INFO,warn:K.WARN,error:K.ERROR,silent:K.SILENT},Uw=K.INFO,Bw={[K.DEBUG]:"log",[K.VERBOSE]:"log",[K.INFO]:"info",[K.WARN]:"warn",[K.ERROR]:"error"},$w=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Bw[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},sn=class{constructor(e){this.name=e,this._logLevel=Uw,this._logHandler=$w,this._userLogHandler=null,Lw.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in K))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Vw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,K.DEBUG,...e),this._logHandler(this,K.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,K.VERBOSE,...e),this._logHandler(this,K.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,K.INFO,...e),this._logHandler(this,K.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,K.WARN,...e),this._logHandler(this,K.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,K.ERROR,...e),this._logHandler(this,K.ERROR,...e)}};var jw=(n,e)=>e.some(t=>n instanceof t),hg,dg;function zw(){return hg||(hg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qw(){return dg||(dg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var fg=new WeakMap,uc=new WeakMap,pg=new WeakMap,ac=new WeakMap,lc=new WeakMap;function Gw(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(ft(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&fg.set(t,n)}).catch(()=>{}),lc.set(e,n),e}function Hw(n){if(uc.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});uc.set(n,e)}var cc={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return uc.get(n);if(e==="objectStoreNames")return n.objectStoreNames||pg.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ft(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gg(n){cc=n(cc)}function Ww(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(fo(this),e,...t);return pg.set(r,e.sort?e.sort():[e]),ft(r)}:qw().includes(n)?function(...e){return n.apply(fo(this),e),ft(fg.get(this))}:function(...e){return ft(n.apply(fo(this),e))}}function Kw(n){return typeof n=="function"?Ww(n):(n instanceof IDBTransaction&&Hw(n),jw(n,zw())?new Proxy(n,cc):n)}function ft(n){if(n instanceof IDBRequest)return Gw(n);if(ac.has(n))return ac.get(n);let e=Kw(n);return e!==n&&(ac.set(n,e),lc.set(e,n)),e}var fo=n=>lc.get(n);function yg(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=ft(a);return r&&a.addEventListener("upgradeneeded",c=>{r(ft(a.result),c.oldVersion,c.newVersion,ft(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Qw=["get","getKey","getAll","getAllKeys","count"],Yw=["put","add","delete","clear"],hc=new Map;function mg(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hc.get(e))return hc.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Yw.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Qw.includes(t)))return;let s=function(a,...u){return v(this,null,function*(){let c=this.transaction(a,i?"readwrite":"readonly"),d=c.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&c.done]))[0]})};return hc.set(e,s),s}gg(n=>Te(F({},n),{get:(e,t,r)=>mg(e,t)||n.get(e,t,r),has:(e,t)=>!!mg(e,t)||n.has(e,t)}));var fc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Jw(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Jw(n){let e=n.getComponent();return e?.type==="VERSION"}var pc="@firebase/app",_g="0.10.13";var xt=new sn("@firebase/app"),Xw="@firebase/app-compat",Zw="@firebase/analytics-compat",eI="@firebase/analytics",tI="@firebase/app-check-compat",nI="@firebase/app-check",rI="@firebase/auth",iI="@firebase/auth-compat",sI="@firebase/database",oI="@firebase/data-connect",aI="@firebase/database-compat",uI="@firebase/functions",cI="@firebase/functions-compat",lI="@firebase/installations",hI="@firebase/installations-compat",dI="@firebase/messaging",fI="@firebase/messaging-compat",pI="@firebase/performance",gI="@firebase/performance-compat",mI="@firebase/remote-config",yI="@firebase/remote-config-compat",_I="@firebase/storage",vI="@firebase/storage-compat",wI="@firebase/firestore",II="@firebase/vertexai-preview",EI="@firebase/firestore-compat",TI="firebase",AI="10.14.1";var gc="[DEFAULT]",DI={[pc]:"fire-core",[Xw]:"fire-core-compat",[eI]:"fire-analytics",[Zw]:"fire-analytics-compat",[nI]:"fire-app-check",[tI]:"fire-app-check-compat",[rI]:"fire-auth",[iI]:"fire-auth-compat",[sI]:"fire-rtdb",[oI]:"fire-data-connect",[aI]:"fire-rtdb-compat",[uI]:"fire-fn",[cI]:"fire-fn-compat",[lI]:"fire-iid",[hI]:"fire-iid-compat",[dI]:"fire-fcm",[fI]:"fire-fcm-compat",[pI]:"fire-perf",[gI]:"fire-perf-compat",[mI]:"fire-rc",[yI]:"fire-rc-compat",[_I]:"fire-gcs",[vI]:"fire-gcs-compat",[wI]:"fire-fst",[EI]:"fire-fst-compat",[II]:"fire-vertex","fire-js":"fire-js",[TI]:"fire-js-all"};var vi=new Map,SI=new Map,mc=new Map;function vg(n,e){try{n.container.addComponent(e)}catch(t){xt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function an(n){let e=n.name;if(mc.has(e))return xt.debug(`There were multiple attempts to register component ${e}.`),!1;mc.set(e,n);for(let t of vi.values())vg(t,n);for(let t of SI.values())vg(t,n);return!0}function Ii(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function pt(n){return n.settings!==void 0}var bI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},on=new Mt("app","Firebase",bI);var yc=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new nt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw on.create("app-deleted",{appName:this._name})}};var un=AI;function po(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:gc,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw on.create("bad-app-name",{appName:String(i)});if(t||(t=rc()),!t)throw on.create("no-options");let s=vi.get(i);if(s){if(An(t,s.options)&&An(r,s.config))return s;throw on.create("duplicate-app",{appName:i})}let a=new ho(i);for(let c of mc.values())a.addComponent(c);let u=new yc(t,r,a);return vi.set(i,u),u}function or(n=gc){let e=vi.get(n);if(!e&&n===gc&&rc())return po();if(!e)throw on.create("no-app",{appName:n});return e}function go(){return Array.from(vi.values())}function Re(n,e,t){var r;let i=(r=DI[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),xt.warn(u.join(" "));return}an(new nt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var CI="firebase-heartbeat-database",RI=1,wi="firebase-heartbeat-store",dc=null;function Tg(){return dc||(dc=yg(CI,RI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(wi)}catch(t){console.warn(t)}}}}).catch(n=>{throw on.create("idb-open",{originalErrorMessage:n.message})})),dc}function PI(n){return v(this,null,function*(){try{let t=(yield Tg()).transaction(wi),r=yield t.objectStore(wi).get(Ag(n));return yield t.done,r}catch(e){if(e instanceof He)xt.warn(e.message);else{let t=on.create("idb-get",{originalErrorMessage:e?.message});xt.warn(t.message)}}})}function wg(n,e){return v(this,null,function*(){try{let r=(yield Tg()).transaction(wi,"readwrite");yield r.objectStore(wi).put(e,Ag(n)),yield r.done}catch(t){if(t instanceof He)xt.warn(t.message);else{let r=on.create("idb-set",{originalErrorMessage:t?.message});xt.warn(r.message)}}})}function Ag(n){return`${n.name}!${n.options.appId}`}var NI=1024,kI=30*24*60*60*1e3,_c=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new vc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return v(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ig();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=kI}),this._storage.overwrite(this._heartbeatsCache))}catch(r){xt.warn(r)}})}getHeartbeatsHeader(){return v(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Ig(),{heartbeatsToSend:r,unsentEntries:i}=OI(this._heartbeatsCache.heartbeats),s=_i(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return xt.warn(t),""}})}};function Ig(){return new Date().toISOString().substring(0,10)}function OI(n,e=NI){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Eg(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Eg(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var vc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return v(this,null,function*(){return sc()?ug().then(()=>!0).catch(()=>!1):!1})}read(){return v(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield PI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return wg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return wg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Eg(n){return _i(JSON.stringify({version:2,heartbeats:n})).length}function MI(n){an(new nt("platform-logger",e=>new fc(e),"PRIVATE")),an(new nt("heartbeat",e=>new _c(e),"PRIVATE")),Re(pc,_g,n),Re(pc,_g,"esm2017"),Re("fire-js","")}MI("");var xI="firebase",FI="10.14.1";Re(xI,FI,"app");var Ei=new fi("ANGULARFIRE2_VERSION");function Dg(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Ic=(n,e)=>{let t=e?[e]:go(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},mo=class{constructor(){return Ic(LI)}},LI="app-check";function ar(){}var yo=class{zone;delegate;constructor(e,t=np){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},wc=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ar,{},ar,ar)),t.pipe(Ae({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},_o=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new yo(Zone.current)),this.insideAngular=t.run(()=>new yo(Zone.current,tp)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(ie(qe))};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function vo(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function VI(n){return vo().ngZone.runOutsideAngular(()=>n())}function Sn(n){return vo().ngZone.run(()=>n())}function UI(n){return BI(vo())(n)}function BI(n){return function(t){return t=t.lift(new wc(n.ngZone)),t.pipe(Eu(n.outsideAngular),Iu(n.insideAngular))}}var $I=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Sn(()=>n.apply(void 0,r))},wo=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Sn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",ar,{},ar,ar))),r[s]=$I(r[s],t));let i=VI(()=>n.apply(this,r));if(!e)if(i instanceof Xt){let s=vo();return i.pipe(Eu(s.outsideAngular),Iu(s.insideAngular))}else return Sn(()=>i);return i instanceof Xt?i.pipe(UI):i instanceof Promise?Sn(()=>new Promise((s,a)=>i.then(u=>Sn(()=>s(u)),u=>Sn(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Sn(()=>i)};var bn=class{constructor(e){return e}},Ti=class{constructor(){return go()}};function jI(n){return n&&n.length===1?n[0]:new bn(or())}var Ec=new pe("angularfire2._apps"),zI={provide:bn,useFactory:jI,deps:[[new Pt,Ec]]},qI={provide:Ti,deps:[[new Pt,Ec]]};function GI(n){return(e,t)=>{let r=t.get(tn);Re("angularfire",Ei.full,"core"),Re("angularfire",Ei.full,"app"),Re("angular",Ep.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new bn(i)}}function rR(n,...e){return wn([zI,qI,{provide:Ec,useFactory:GI(n),multi:!0,deps:[qe,In,_o,...e]}])}function Bg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var $g=Bg,jg=new Mt("auth","Firebase",Bg());var So=new sn("@firebase/auth");function HI(n,...e){So.logLevel<=K.WARN&&So.warn(`Auth (${un}): ${n}`,...e)}function Eo(n,...e){So.logLevel<=K.ERROR&&So.error(`Auth (${un}): ${n}`,...e)}function mt(n,...e){throw Bc(n,...e)}function ct(n,...e){return Bc(n,...e)}function Uc(n,e,t){let r=Object.assign(Object.assign({},$g()),{[e]:t});return new Mt("auth","Firebase",r).create(e,{appName:n.name})}function Cn(n){return Uc(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function WI(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&mt(n,"argument-error"),Uc(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Bc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return jg.create(n,...e)}function B(n,e,...t){if(!n)throw Bc(e,...t)}function Ft(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Eo(e),new Error(e)}function Vt(n,e){n||Ft(e)}function Dc(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function KI(){return Sg()==="http:"||Sg()==="https:"}function Sg(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function QI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KI()||ig()||"connection"in navigator)?navigator.onLine:!0}function YI(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Rn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Vt(t>e,"Short delay should be less than long delay!"),this.isMobile=ng()||sg()}get(){return QI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function $c(n,e){Vt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var bo=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ft("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ft("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ft("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var JI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var XI=new Rn(3e4,6e4);function jc(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function lr(s,a,u,c){return v(this,arguments,function*(n,e,t,r,i={}){return zg(n,i,()=>v(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let m=sr(Object.assign({key:n.config.apiKey},p)).slice(1),I=yield n._getAdditionalHeaders();I["Content-Type"]="application/json",n.languageCode&&(I["X-Firebase-Locale"]=n.languageCode);let b=Object.assign({method:e,headers:I},d);return rg()||(b.referrerPolicy="no-referrer"),bo.fetch()(qg(n,n.config.apiHost,t,m),b)}))})}function zg(n,e,t){return v(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},JI),e);try{let i=new Sc(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw Io(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[c,d]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Io(n,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Io(n,"email-already-in-use",a);if(c==="USER_DISABLED")throw Io(n,"user-disabled",a);let p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Uc(n,p,d);mt(n,p)}}catch(i){if(i instanceof He)throw i;mt(n,"network-request-failed",{message:String(i)})}})}function ZI(s,a,u,c){return v(this,arguments,function*(n,e,t,r,i={}){let d=yield lr(n,e,t,r,i);return"mfaPendingCredential"in d&&mt(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function qg(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?$c(n.config,i):`${n.config.apiScheme}://${i}`}var Sc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ct(this.auth,"network-request-failed")),XI.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Io(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=ct(n,e,r);return i.customData._tokenResponse=t,i}function eE(n,e){return v(this,null,function*(){return lr(n,"POST","/v1/accounts:delete",e)})}function Gg(n,e){return v(this,null,function*(){return lr(n,"POST","/v1/accounts:lookup",e)})}function Ai(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function zc(n,e=!1){return v(this,null,function*(){let t=Se(n),r=yield t.getIdToken(e),i=qc(r);B(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Ai(Tc(i.auth_time)),issuedAtTime:Ai(Tc(i.iat)),expirationTime:Ai(Tc(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Tc(n){return Number(n)*1e3}function qc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Eo("JWT malformed, contained fewer than 3 sections"),null;try{let i=tc(t);return i?JSON.parse(i):(Eo("Failed to decode base64 JWT payload"),null)}catch(i){return Eo("Caught error parsing JWT payload as JSON",i?.toString()),null}}function bg(n){let e=qc(n);return B(e,"internal-error"),B(typeof e.exp<"u","internal-error"),B(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Si(n,e,t=!1){return v(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof He&&tE(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function tE({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var bc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>v(this,null,function*(){yield this.iteration()}),t)}iteration(){return v(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var bi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ai(this.lastLoginAt),this.creationTime=Ai(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Co(n){return v(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Si(n,Gg(t,{idToken:r}));B(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Hg(s.providerUserInfo):[],u=nE(n.providerData,a),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,p=c?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new bi(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)})}function Gc(n){return v(this,null,function*(){let e=Se(n);yield Co(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function nE(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Hg(n){return n.map(e=>{var{providerId:t}=e,r=Vs(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function rE(n,e){return v(this,null,function*(){let t=yield zg(n,{},()=>v(this,null,function*(){let r=sr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=qg(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",bo.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function iE(n,e){return v(this,null,function*(){return lr(n,"POST","/v2/accounts:revokeToken",jc(n,e))})}var Di=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){B(e.idToken,"internal-error"),B(typeof e.idToken<"u","internal-error"),B(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){B(e.length!==0,"internal-error");let t=bg(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return v(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(B(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return v(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield rE(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(B(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(B(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(B(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ft("not implemented")}};function cn(n,e){B(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var cr=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Vs(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new bi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return v(this,null,function*(){let t=yield Si(this,this.stsTokenManager.getToken(this.auth,e));return B(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return zc(this,e)}reload(){return Gc(this)}_assign(e){this!==e&&(B(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){B(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return v(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Co(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return v(this,null,function*(){if(pt(this.auth.app))return Promise.reject(Cn(this.auth));let e=yield this.getIdToken();return yield Si(this,eE(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,u,c,d,p;let m=(r=t.displayName)!==null&&r!==void 0?r:void 0,I=(i=t.email)!==null&&i!==void 0?i:void 0,b=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,R=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(u=t.tenantId)!==null&&u!==void 0?u:void 0,P=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,z=(d=t.createdAt)!==null&&d!==void 0?d:void 0,W=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:H,emailVerified:le,isAnonymous:Ue,providerData:re,stsTokenManager:E}=t;B(H&&E,e,"internal-error");let g=Di.fromJSON(this.name,E);B(typeof H=="string",e,"internal-error"),cn(m,e.name),cn(I,e.name),B(typeof le=="boolean",e,"internal-error"),B(typeof Ue=="boolean",e,"internal-error"),cn(b,e.name),cn(R,e.name),cn(O,e.name),cn(P,e.name),cn(z,e.name),cn(W,e.name);let _=new n({uid:H,auth:e,email:I,emailVerified:le,displayName:m,isAnonymous:Ue,photoURL:R,phoneNumber:b,tenantId:O,stsTokenManager:g,createdAt:z,lastLoginAt:W});return re&&Array.isArray(re)&&(_.providerData=re.map(w=>Object.assign({},w))),P&&(_._redirectEventId=P),_}static _fromIdTokenResponse(e,t,r=!1){return v(this,null,function*(){let i=new Di;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Co(s),s})}static _fromGetAccountInfoResponse(e,t,r){return v(this,null,function*(){let i=t.users[0];B(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Hg(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new Di;u.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new bi(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,d),c})}};var Cg=new Map;function Lt(n){Vt(n instanceof Function,"Expected a class definition");let e=Cg.get(n);return e?(Vt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Cg.set(n,e),e)}var sE=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return v(this,null,function*(){return!0})}_set(t,r){return v(this,null,function*(){this.storage[t]=r})}_get(t){return v(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return v(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Cc=sE;function To(n,e,t){return`firebase:${n}:${e}:${t}`}var Ro=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=To(this.userKey,i.apiKey,s),this.fullPersistenceKey=To("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return v(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?cr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return v(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return v(this,null,function*(){if(!t.length)return new n(Lt(Cc),e,r);let i=(yield Promise.all(t.map(d=>v(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||Lt(Cc),a=To(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let m=cr._fromJSON(e,p);d!==s&&(u=m),s=d;break}}catch{}let c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>v(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function Rg(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Yg(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Wg(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Xg(e))return"Blackberry";if(Zg(e))return"Webos";if(Kg(e))return"Safari";if((e.includes("chrome/")||Qg(e))&&!e.includes("edge/"))return"Chrome";if(Jg(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Wg(n=De()){return/firefox\//i.test(n)}function Kg(n=De()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Qg(n=De()){return/crios\//i.test(n)}function Yg(n=De()){return/iemobile/i.test(n)}function Jg(n=De()){return/android/i.test(n)}function Xg(n=De()){return/blackberry/i.test(n)}function Zg(n=De()){return/webos/i.test(n)}function Hc(n=De()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function oE(n=De()){var e;return Hc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function aE(){return og()&&document.documentMode===10}function em(n=De()){return Hc(n)||Jg(n)||Zg(n)||Xg(n)||/windows phone/i.test(n)||Yg(n)}function tm(n,e=[]){let t;switch(n){case"Browser":t=Rg(De());break;case"Worker":t=`${Rg(De())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${un}/${r}`}var Rc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let c=e(s);a(c)}catch(c){u(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return v(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function uE(t){return v(this,arguments,function*(n,e={}){return lr(n,"GET","/v2/passwordPolicy",jc(n,e))})}var cE=6,Pc=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:cE,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,u;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(u=c.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Nc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Po(this),this.idTokenSubscription=new Po(this),this.beforeStateQueue=new Rc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jg,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Lt(t)),this._initializationPromise=this.queue(()=>v(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Ro.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return v(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return v(this,null,function*(){try{let t=yield Gg(this,{idToken:e}),r=yield cr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return v(this,null,function*(){var t;if(pt(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!a||a===u)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return B(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return v(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return v(this,null,function*(){try{yield Co(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=YI()}_delete(){return v(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return v(this,null,function*(){if(pt(this.app))return Promise.reject(Cn(this));let t=e?Se(e):null;return t&&B(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return v(this,null,function*(){if(!this._deleted)return e&&B(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>v(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return v(this,null,function*(){return pt(this.app)?Promise.reject(Cn(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return pt(this.app)?Promise.reject(Cn(this)):this.queue(()=>v(this,null,function*(){yield this.assertedPersistence.setPersistence(Lt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return v(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return v(this,null,function*(){let e=yield uE(this),t=new Pc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Mt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return v(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield iE(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return v(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return v(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Lt(e)||this._popupRedirectResolver;B(t,this,"argument-error"),this.redirectPersistenceManager=yield Ro.create(this,[Lt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return v(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>v(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return v(this,null,function*(){if(e===this.currentUser)return this.queue(()=>v(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(B(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{a=!0,c()}}else{let c=e.addObserver(t);return()=>{a=!0,c()}}}directlySetCurrentUser(e){return v(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return B(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return v(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return v(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&HI(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Vo(n){return Se(n)}var Po=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=lg(t=>this.observer=t)}get next(){return B(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Wc={loadJS(){return v(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lE(n){Wc=n}function hE(n){return Wc.loadJS(n)}function dE(){return Wc.gapiScript}function nm(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Kc(n,e){let t=Ii(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(An(s,e??{}))return i;mt(i,"already-initialized")}return t.initialize({options:e})}function fE(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Lt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Qc(n,e,t){let r=Vo(n);B(r._canInitEmulator,r,"emulator-config-failed"),B(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=rm(e),{host:a,port:u}=pE(e),c=u===null?"":`:${u}`;r.config.emulator={url:`${s}//${a}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:u,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||gE()}function rm(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function pE(n){let e=rm(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Pg(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:Pg(a)}}}function Pg(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function gE(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ci=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ft("not implemented")}_getIdTokenResponse(e){return Ft("not implemented")}_linkToIdToken(e,t){return Ft("not implemented")}_getReauthenticationResolver(e){return Ft("not implemented")}};function ur(n,e){return v(this,null,function*(){return ZI(n,"POST","/v1/accounts:signInWithIdp",jc(n,e))})}var mE="http://localhost",No=class n extends Ci{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):mt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Vs(t,["providerId","signInMethod"]);if(!r||!i)return null;let a=new n(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){let t=this.buildRequest();return ur(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,ur(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,ur(e,t)}buildRequest(){let e={requestUri:mE,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=sr(t)}return e}};var Ri=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var ko=class extends Ri{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Uo=(()=>{class n extends ko{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return No._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var Pi=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return v(this,null,function*(){let s=yield cr._fromIdTokenResponse(e,r,i),a=Ng(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return v(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Ng(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Ng(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var kc=class n extends He{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function im(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?kc._fromErrorAndOperation(n,s,e,r):s})}function yE(n,e,t=!1){return v(this,null,function*(){let r=yield Si(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Pi._forOperation(n,"link",r)})}function _E(n,e,t=!1){return v(this,null,function*(){let{auth:r}=n;if(pt(r.app))return Promise.reject(Cn(r));let i="reauthenticate";try{let s=yield Si(n,im(r,i,e,n),t);B(s.idToken,r,"internal-error");let a=qc(s.idToken);B(a,r,"internal-error");let{sub:u}=a;return B(n.uid===u,r,"user-mismatch"),Pi._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&mt(r,"user-mismatch"),s}})}function vE(n,e,t=!1){return v(this,null,function*(){if(pt(n.app))return Promise.reject(Cn(n));let r="signIn",i=yield im(n,r,e),s=yield Pi._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Yc(n,e,t,r){return Se(n).onIdTokenChanged(e,t,r)}function Jc(n,e,t){return Se(n).beforeAuthStateChanged(e,t)}function Bo(n,e,t,r){return Se(n).onAuthStateChanged(e,t,r)}function $o(n){return Se(n).signOut()}var Oo="__sak";var Mo=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Oo,"1"),this.storage.removeItem(Oo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var wE=1e3,IE=10,EE=(()=>{class n extends Mo{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=em(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((u,c,d)=>{this.notifyListeners(u,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let u=this.storage.getItem(i);!r&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);aE()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,IE):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},wE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return v(this,null,function*(){yield Jt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return v(this,null,function*(){let r=yield Jt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return v(this,null,function*(){yield Jt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),sm=EE;var TE=(()=>{class n extends Mo{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Xc=TE;function AE(n){return Promise.all(n.map(e=>v(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var DE=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return v(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,u=this.handlersMap[s];if(!u?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(u).map(p=>v(this,null,function*(){return p(r.origin,a)})),d=yield AE(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Zc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Oc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return v(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((u,c)=>{let d=Zc("",20);i.port1.start();let p=setTimeout(()=>{c(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){let I=m;if(I.data.eventId===d)switch(I.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),u(I.data.response);break;default:clearTimeout(p),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function gt(){return window}function SE(n){gt().location.href=n}function om(){return typeof gt().WorkerGlobalScope<"u"&&typeof gt().importScripts=="function"}function bE(){return v(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function CE(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function RE(){return om()?self:null}var am="firebaseLocalStorageDb",PE=1,xo="firebaseLocalStorage",um="fbase_key",Pn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function jo(n,e){return n.transaction([xo],e?"readwrite":"readonly").objectStore(xo)}function NE(){let n=indexedDB.deleteDatabase(am);return new Pn(n).toPromise()}function Mc(){let n=indexedDB.open(am,PE);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(xo,{keyPath:um})}catch(i){t(i)}}),n.addEventListener("success",()=>v(this,null,function*(){let r=n.result;r.objectStoreNames.contains(xo)?e(r):(r.close(),yield NE(),e(yield Mc()))}))})}function kg(n,e,t){return v(this,null,function*(){let r=jo(n,!0).put({[um]:e,value:t});return new Pn(r).toPromise()})}function kE(n,e){return v(this,null,function*(){let t=jo(n,!1).get(e),r=yield new Pn(t).toPromise();return r===void 0?null:r.value})}function Og(n,e){let t=jo(n,!0).delete(e);return new Pn(t).toPromise()}var OE=800,ME=3,xE=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return v(this,null,function*(){return this.db?this.db:(this.db=yield Mc(),this.db)})}_withRetries(t){return v(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>ME)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return v(this,null,function*(){return om()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return v(this,null,function*(){this.receiver=DE._getInstance(RE()),this.receiver._subscribe("keyChanged",(t,r)=>v(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>v(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return v(this,null,function*(){var t,r;if(this.activeServiceWorker=yield bE(),!this.activeServiceWorker)return;this.sender=new Oc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return v(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||CE()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return v(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Mc();return yield kg(t,Oo,"1"),yield Og(t,Oo),!0}catch{}return!1})}_withPendingWrite(t){return v(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(i=>kg(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return v(this,null,function*(){let r=yield this._withRetries(i=>kE(i,t));return this.localCache[t]=r,r})}_remove(t){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(r=>Og(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return v(this,null,function*(){let t=yield this._withRetries(s=>{let a=jo(s,!1).getAll();return new Pn(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>v(this,null,function*(){return this._poll()}),OE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),cm=xE;var fR=nm("rcb"),pR=new Rn(3e4,6e4);function lm(n,e){return e?Lt(e):(B(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Ni=class extends Ci{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ur(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ur(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ur(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function FE(n){return vE(n.auth,new Ni(n),n.bypassAuthState)}function LE(n){let{auth:e,user:t}=n;return B(t,e,"internal-error"),_E(t,new Ni(n),n.bypassAuthState)}function VE(n){return v(this,null,function*(){let{auth:e,user:t}=n;return B(t,e,"internal-error"),yE(t,new Ni(n),n.bypassAuthState)})}var Fo=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>v(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return v(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:u}=e;if(a){this.reject(a);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(u)(c))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return FE;case"linkViaPopup":case"linkViaRedirect":return VE;case"reauthViaPopup":case"reauthViaRedirect":return LE;default:mt(this.auth,"internal-error")}}resolve(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var UE=new Rn(2e3,1e4);function el(n,e,t){return v(this,null,function*(){if(pt(n.app))return Promise.reject(ct(n,"operation-not-supported-in-this-environment"));let r=Vo(n);WI(n,e,Ri);let i=lm(r,t);return new BE(r,"signInViaPopup",e,i).executeNotNull()})}var BE=(()=>{class n extends Fo{constructor(t,r,i,s,a){super(t,r,s,a),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return v(this,null,function*(){let t=yield this.execute();return B(t,this.auth,"internal-error"),t})}onExecution(){return v(this,null,function*(){Vt(this.filter.length===1,"Popup operations only handle one event");let t=Zc();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(ct(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(ct(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ct(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,UE.get())};t()}}n.currentPopupAction=null;return n})(),$E="pendingRedirect",Ao=new Map,xc=class n extends Fo{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return v(this,null,function*(){let e=Ao.get(this.auth._key());if(!e){try{let r=(yield jE(this.resolver,this.auth))?yield Jt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ao.set(this.auth._key(),e)}return this.bypassAuthState||Ao.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return v(this,null,function*(){if(e.type==="signInViaRedirect")return Jt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Jt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return v(this,null,function*(){})}cleanUp(){}};function jE(n,e){return v(this,null,function*(){let t=GE(e),r=qE(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function zE(n,e){Ao.set(n._key(),e)}function qE(n){return Lt(n._redirectPersistence)}function GE(n){return To($E,n.config.apiKey,n.name)}function HE(n,e,t=!1){return v(this,null,function*(){if(pt(n.app))return Promise.reject(Cn(n));let r=Vo(n),i=lm(r,e),a=yield new xc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var WE=10*60*1e3,Fc=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KE(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!hm(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ct(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WE&&this.cachedEventUids.clear(),this.cachedEventUids.has(Mg(e))}saveEventToCache(e){this.cachedEventUids.add(Mg(e)),this.lastProcessedEventTime=Date.now()}};function Mg(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function hm({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function KE(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hm(n);default:return!1}}function QE(t){return v(this,arguments,function*(n,e={}){return lr(n,"GET","/v1/projects",e)})}var YE=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JE=/^https?/;function XE(n){return v(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield QE(n);for(let t of e)try{if(ZE(t))return}catch{}mt(n,"unauthorized-domain")})}function ZE(n){let e=Dc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!JE.test(t))return!1;if(YE.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var e0=new Rn(3e4,6e4);function xg(){let n=gt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function t0(n){return new Promise((e,t)=>{var r,i,s;function a(){xg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{xg(),t(ct(n,"network-request-failed"))},timeout:e0.get()})}if(!((i=(r=gt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=gt().gapi)===null||s===void 0)&&s.load)a();else{let u=nm("iframefcb");return gt()[u]=()=>{gapi.load?a():t(ct(n,"network-request-failed"))},hE(`${dE()}?onload=${u}`).catch(c=>t(c))}}).catch(e=>{throw Do=null,e})}var Do=null;function n0(n){return Do=Do||t0(n),Do}var r0=new Rn(5e3,15e3),i0="__/auth/iframe",s0="emulator/auth/iframe",o0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},a0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function u0(n){let e=n.config;B(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?$c(e,s0):`https://${n.config.authDomain}/${i0}`,r={apiKey:e.apiKey,appName:n.name,v:un},i=a0.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${sr(r).slice(1)}`}function c0(n){return v(this,null,function*(){let e=yield n0(n),t=gt().gapi;return B(t,n,"internal-error"),e.open({where:document.body,url:u0(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o0,dontclear:!0},r=>new Promise((i,s)=>v(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=ct(n,"network-request-failed"),u=gt().setTimeout(()=>{s(a)},r0.get());function c(){gt().clearTimeout(u),i(r)}r.ping(c).then(c,()=>{s(a)})})))})}var l0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},h0=500,d0=600,f0="_blank",p0="http://localhost",Lo=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function g0(n,e,t,r=h0,i=d0){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",c=Object.assign(Object.assign({},l0),{width:r.toString(),height:i.toString(),top:s,left:a}),d=De().toLowerCase();t&&(u=Qg(d)?f0:t),Wg(d)&&(e=e||p0,c.scrollbars="yes");let p=Object.entries(c).reduce((I,[b,R])=>`${I}${b}=${R},`,"");if(oE(d)&&u!=="_self")return m0(e||"",u),new Lo(null);let m=window.open(e||"",u,p);B(m,n,"popup-blocked");try{m.focus()}catch{}return new Lo(m)}function m0(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var y0="__/auth/handler",_0="emulator/auth/handler",v0=encodeURIComponent("fac");function Fg(n,e,t,r,i,s){return v(this,null,function*(){B(n.config.authDomain,n,"auth-domain-config-required"),B(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:un,eventId:i};if(e instanceof Ri){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",cg(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof ko){let p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let u=a;for(let p of Object.keys(u))u[p]===void 0&&delete u[p];let c=yield n._getAppCheckToken(),d=c?`#${v0}=${encodeURIComponent(c)}`:"";return`${w0(n)}?${sr(u).slice(1)}${d}`})}function w0({config:n}){return n.emulator?$c(n,_0):`https://${n.authDomain}/${y0}`}var Ac="webStorageSupport",Lc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Xc,this._completeRedirectFn=HE,this._overrideRedirectResult=zE}_openPopup(e,t,r,i){return v(this,null,function*(){var s;Vt((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield Fg(e,t,r,Dc(),i);return g0(e,a,Zc())})}_openRedirect(e,t,r,i){return v(this,null,function*(){yield this._originValidation(e);let s=yield Fg(e,t,r,Dc(),i);return SE(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Vt(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return v(this,null,function*(){let t=yield c0(e),r=new Fc(e);return t.register("authEvent",i=>(B(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ac,{type:Ac},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[Ac];a!==void 0&&t(!!a),mt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=XE(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return em()||Kg()||Hc()}},dm=Lc;var Lg="@firebase/auth",Vg="1.7.9";var Vc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return v(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){B(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function I0(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function E0(n){an(new nt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;B(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tm(n)},d=new Nc(r,i,s,c);return fE(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),an(new nt("auth-internal",e=>{let t=Vo(e.getProvider("auth").getImmediate());return(r=>new Vc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Re(Lg,Vg,I0(n)),Re(Lg,Vg,"esm2017")}var T0=5*60,A0=ic("authIdTokenMaxAge")||T0,Ug=null,D0=n=>e=>v(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>A0)return;let i=t?.token;Ug!==i&&(Ug=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function ki(n=or()){let e=Ii(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Kc(n,{popupRedirectResolver:dm,persistence:[cm,sm,Xc]}),r=ic("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=D0(s.toString());Jc(t,a,()=>a(t.currentUser)),Yc(t,u=>a(u))}}let i=nc("auth");return i&&Qc(t,`http://${i}`),t}function S0(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}lE({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=ct("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",S0().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});E0("Browser");var fm="auth",Ut=class{constructor(e){return e}},tl=class{constructor(){return Ic(fm)}};var nl=new pe("angularfire2.auth-instances");function yT(n,e){let t=Dg(fm,n,e);return t&&new Ut(t)}function _T(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ut(r)}}var vT={provide:tl,deps:[[new Pt,nl]]},wT={provide:Ut,useFactory:yT,deps:[[new Pt,nl],bn]};function XR(n,...e){return Re("angularfire",Ei.full,"auth"),wn([wT,vT,{provide:nl,useFactory:_T(n),multi:!0,deps:[qe,In,_o,Ti,[new Pt,mo],...e]}])}var ZR=wo(ki,!0);var pm=wo(el,!0);var gm=class n{provider=new Uo;auth=V(Ut);signIn(){return this.provider.setCustomParameters({prompt:"select_account"}),pm(this.auth,this.provider).then(e=>{let r=Uo.credentialFromResult(e)?.accessToken;return e.user.displayName||null}).catch(e=>{throw console.error("Error during sign-in:",e),e})}checkUserLogin(){return new Xt(e=>{Bo(this.auth,t=>{t?(e.next(t.displayName),e.complete()):(e.next(null),e.complete())})})}signOut(){return new Xt(e=>{let t=ki();$o(t).then(()=>{e.next(null),e.complete()}).catch(r=>{console.log("signedOut error"),e.error()})})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})};var G="primary",Qi=Symbol("RouteTitle"),al=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function mr(n){return new al(n)}function IT(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],u=n[s];if(a[0]===":")i[a.substring(1)]=u;else if(a!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function ET(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!yt(n[t],e[t]))return!1;return!0}function yt(n,e){let t=n?ul(n):void 0,r=e?ul(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Tm(n[i],e[i]))return!1;return!0}function ul(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Tm(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Am(n){return n.length>0?n[n.length-1]:null}function ln(n){return rp(n)?n:Hs(n)?at(Promise.resolve(n)):q(n)}var TT={exact:Sm,subset:bm},Dm={exact:AT,subset:DT,ignored:()=>!0};function mm(n,e,t){return TT[t.paths](n.root,e.root,t.matrixParams)&&Dm[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function AT(n,e){return yt(n,e)}function Sm(n,e,t){if(!kn(n.segments,e.segments)||!Go(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Sm(n.children[r],e.children[r],t))return!1;return!0}function DT(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Tm(n[t],e[t]))}function bm(n,e,t){return Cm(n,e,e.segments,t)}function Cm(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!kn(i,t)||e.hasChildren()||!Go(i,t,r))}else if(n.segments.length===t.length){if(!kn(n.segments,t)||!Go(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!bm(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!kn(n.segments,i)||!Go(n.segments,i,r)||!n.children[G]?!1:Cm(n.children[G],e,s,r)}}function Go(n,e,t){return e.every((r,i)=>Dm[t](n[i].parameters,r.parameters))}var $t=class{constructor(e=new ne([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=mr(this.queryParams),this._queryParamMap}toString(){return CT.serialize(this)}},ne=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ho(this)}},Nn=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=mr(this.parameters),this._parameterMap}toString(){return Pm(this)}};function ST(n,e){return kn(n,e)&&n.every((t,r)=>yt(t.parameters,e[r].parameters))}function kn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function bT(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===G&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==G&&(t=t.concat(e(i,r)))}),t}var Ml=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>new Ui,providedIn:"root"})}}return n})(),Ui=class{parse(e){let t=new ll(e);return new $t(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Oi(e.root,!0)}`,r=NT(e.queryParams),i=typeof e.fragment=="string"?`#${RT(e.fragment)}`:"";return`${t}${r}${i}`}},CT=new Ui;function Ho(n){return n.segments.map(e=>Pm(e)).join("/")}function Oi(n,e){if(!n.hasChildren())return Ho(n);if(e){let t=n.children[G]?Oi(n.children[G],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==G&&r.push(`${i}:${Oi(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=bT(n,(r,i)=>i===G?[Oi(n.children[G],!1)]:[`${i}:${Oi(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[G]!=null?`${Ho(n)}/${t[0]}`:`${Ho(n)}/(${t.join("//")})`}}function Rm(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function zo(n){return Rm(n).replace(/%3B/gi,";")}function RT(n){return encodeURI(n)}function cl(n){return Rm(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wo(n){return decodeURIComponent(n)}function ym(n){return Wo(n.replace(/\+/g,"%20"))}function Pm(n){return`${cl(n.path)}${PT(n.parameters)}`}function PT(n){return Object.entries(n).map(([e,t])=>`;${cl(e)}=${cl(t)}`).join("")}function NT(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${zo(t)}=${zo(i)}`).join("&"):`${zo(t)}=${zo(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var kT=/^[^\/()?;#]+/;function rl(n){let e=n.match(kT);return e?e[0]:""}var OT=/^[^\/()?;=#]+/;function MT(n){let e=n.match(OT);return e?e[0]:""}var xT=/^[^=?&#]+/;function FT(n){let e=n.match(xT);return e?e[0]:""}var LT=/^[^&#]+/;function VT(n){let e=n.match(LT);return e?e[0]:""}var ll=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ne([],{}):new ne([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[G]=new ne(e,t)),r}parseSegment(){let e=rl(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ye(4009,!1);return this.capture(e),new Nn(Wo(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=MT(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=rl(this.remaining);i&&(r=i,this.capture(r))}e[Wo(t)]=Wo(r)}parseQueryParam(e){let t=FT(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=VT(this.remaining);a&&(r=a,this.capture(r))}let i=ym(t),s=ym(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=rl(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ye(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=G);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[G]:new ne([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ye(4011,!1)}};function Nm(n){return n.segments.length>0?new ne([],{[G]:n}):n}function km(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=km(i);if(r===G&&s.segments.length===0&&s.hasChildren())for(let[a,u]of Object.entries(s.children))e[a]=u;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new ne(n.segments,e);return UT(t)}function UT(n){if(n.numberOfChildren===1&&n.children[G]){let e=n.children[G];return new ne(n.segments.concat(e.segments),e.children)}return n}function Bi(n){return n instanceof $t}function BT(n,e,t=null,r=null){let i=Om(n);return Mm(i,e,t,r)}function Om(n){let e;function t(s){let a={};for(let c of s.children){let d=t(c);a[c.outlet]=d}let u=new ne(s.url,a);return s===n&&(e=u),u}let r=t(n.root),i=Nm(r);return e??i}function Mm(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return il(i,i,i,t,r);let s=$T(e);if(s.toRoot())return il(i,i,new ne([],{}),t,r);let a=jT(s,i,n),u=a.processChildren?Fi(a.segmentGroup,a.index,s.commands):Fm(a.segmentGroup,a.index,s.commands);return il(i,a.segmentGroup,u,t,r)}function Ko(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function $i(n){return typeof n=="object"&&n!=null&&n.outlets}function il(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,d])=>{s[c]=Array.isArray(d)?d.map(p=>`${p}`):`${d}`});let a;n===e?a=t:a=xm(n,e,t);let u=Nm(km(a));return new $t(u,s,i)}function xm(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=xm(s,e,t)}),new ne(n.segments,r)}var Qo=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ko(r[0]))throw new ye(4003,!1);let i=r.find($i);if(i&&i!==Am(r))throw new ye(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function $T(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Qo(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([c,d])=>{u[c]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new Qo(t,e,r)}var fr=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function jT(n,e,t){if(n.isAbsolute)return new fr(e,!0,0);if(!t)return new fr(e,!1,NaN);if(t.parent===null)return new fr(t,!0,0);let r=Ko(n.commands[0])?0:1,i=t.segments.length-1+r;return zT(t,i,n.numberOfDoubleDots)}function zT(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ye(4005,!1);i=r.segments.length}return new fr(r,!1,i-s)}function qT(n){return $i(n[0])?n[0].outlets:{[G]:n}}function Fm(n,e,t){if(n??=new ne([],{}),n.segments.length===0&&n.hasChildren())return Fi(n,e,t);let r=GT(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new ne(n.segments.slice(0,r.pathIndex),{});return s.children[G]=new ne(n.segments.slice(r.pathIndex),n.children),Fi(s,0,i)}else return r.match&&i.length===0?new ne(n.segments,{}):r.match&&!n.hasChildren()?hl(n,e,t):r.match?Fi(n,0,i):hl(n,e,t)}function Fi(n,e,t){if(t.length===0)return new ne(n.segments,{});{let r=qT(t),i={};if(Object.keys(r).some(s=>s!==G)&&n.children[G]&&n.numberOfChildren===1&&n.children[G].segments.length===0){let s=Fi(n.children[G],e,t);return new ne(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=Fm(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new ne(n.segments,i)}}function GT(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],u=t[r];if($i(u))break;let c=`${u}`,d=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&d&&typeof d=="object"&&d.outlets===void 0){if(!vm(c,d,a))return s;r+=2}else{if(!vm(c,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function hl(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if($i(s)){let c=HT(s.outlets);return new ne(r,c)}if(i===0&&Ko(t[0])){let c=n.segments[e];r.push(new Nn(c.path,_m(t[0]))),i++;continue}let a=$i(s)?s.outlets[G]:`${s}`,u=i<t.length-1?t[i+1]:null;a&&u&&Ko(u)?(r.push(new Nn(a,_m(u))),i+=2):(r.push(new Nn(a,{})),i++)}return new ne(r,{})}function HT(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=hl(new ne([],{}),0,r))}),e}function _m(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function vm(n,e,t){return n==t.path&&yt(e,t.parameters)}var Li="imperative",Pe=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Pe||{}),rt=class{constructor(e,t){this.id=e,this.url=t}},ji=class extends rt{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Pe.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},On=class extends rt{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Pe.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Ke=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Ke||{}),dl=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(dl||{}),Bt=class extends rt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Pe.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Mn=class extends rt{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Pe.NavigationSkipped}},zi=class extends rt{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Pe.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Yo=class extends rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pe.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fl=class extends rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pe.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},pl=class extends rt{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Pe.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},gl=class extends rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pe.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ml=class extends rt{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Pe.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yl=class{constructor(e){this.route=e,this.type=Pe.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},_l=class{constructor(e){this.route=e,this.type=Pe.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},vl=class{constructor(e){this.snapshot=e,this.type=Pe.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},wl=class{constructor(e){this.snapshot=e,this.type=Pe.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Il=class{constructor(e){this.snapshot=e,this.type=Pe.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},El=class{constructor(e){this.snapshot=e,this.type=Pe.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var qi=class{},yr=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function WT(n,e){return n.providers&&!n._injector&&(n._injector=vp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function lt(n){return n.outlet||G}function KT(n,e){let t=n.filter(r=>lt(r)===e);return t.push(...n.filter(r=>lt(r)!==e)),t}function Yi(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Tl=class{get injector(){return Yi(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new ra(this.rootInjector),this.attachRef=null}},ra=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Tl(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(ie(js))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Jo=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Al(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Al(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Dl(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Dl(e,this._root).map(t=>t.value)}};function Al(n,e){if(n===e.value)return e;for(let t of e.children){let r=Al(n,t);if(r)return r}return null}function Dl(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Dl(n,t);if(r.length)return r.unshift(e),r}return[]}var We=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function dr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Xo=class extends Jo{constructor(e,t){super(e),this.snapshot=t,xl(this,e)}toString(){return this.snapshot.toString()}};function Lm(n){let e=QT(n),t=new Je([new Nn("",{})]),r=new Je({}),i=new Je({}),s=new Je({}),a=new Je(""),u=new _r(t,r,s,a,i,G,n,e.root);return u.snapshot=e.root,new Xo(new We(u,[]),e)}function QT(n){let e={},t={},r={},i="",s=new pr([],e,r,i,t,G,n,null,{});return new ea("",new We(s,[]))}var _r=class{constructor(e,t,r,i,s,a,u,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ue(d=>d[Qi]))??q(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ue(e=>mr(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ue(e=>mr(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Zo(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:F(F({},e.params),n.params),data:F(F({},e.data),n.data),resolve:F(F(F(F({},n.data),e.data),i?.data),n._resolvedData)}:r={params:F({},n.params),data:F({},n.data),resolve:F(F({},n.data),n._resolvedData??{})},i&&Um(i)&&(r.resolve[Qi]=i.title),r}var pr=class{get title(){return this.data?.[Qi]}constructor(e,t,r,i,s,a,u,c,d){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=u,this.routeConfig=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=mr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=mr(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},ea=class extends Jo{constructor(e,t){super(t),this.url=e,xl(this,t)}toString(){return Vm(this._root)}};function xl(n,e){e.value._routerState=n,e.children.forEach(t=>xl(n,t))}function Vm(n){let e=n.children.length>0?` { ${n.children.map(Vm).join(", ")} } `:"";return`${n.value}${e}`}function sl(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,yt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),yt(e.params,t.params)||n.paramsSubject.next(t.params),ET(e.url,t.url)||n.urlSubject.next(t.url),yt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Sl(n,e){let t=yt(n.params,e.params)&&ST(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Sl(n.parent,e.parent))}function Um(n){return typeof n.title=="string"||n.title===null}var YT=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=G,this.activateEvents=new En,this.deactivateEvents=new En,this.attachEvents=new En,this.detachEvents=new En,this.parentContexts=V(ra),this.location=V(Mu),this.changeDetector=V(nr),this.inputBinder=V(Fl,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ye(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ye(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ye(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ye(4013,!1);this._activatedRoute=t;let i=this.location,a=t.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new bl(t,u,i.injector);this.activated=i.createComponent(a,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=er({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ru]})}}return n})(),bl=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===_r?this.route:e===ra?this.childContexts:this.parent.get(e,t)}},Fl=new pe("");function JT(n,e,t){let r=Gi(n,e._root,t?t._root:void 0);return new Xo(r,e)}function Gi(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=XT(n,e,t);return new We(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(u=>Gi(n,u)),a}}let r=ZT(e.value),i=e.children.map(s=>Gi(n,s));return new We(r,i)}}function XT(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Gi(n,r,i);return Gi(n,r)})}function ZT(n){return new _r(new Je(n.url),new Je(n.params),new Je(n.queryParams),new Je(n.fragment),new Je(n.data),n.outlet,n.component,n)}var Hi=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},Bm="ngNavigationCancelingError";function ta(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Bi(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=$m(!1,Ke.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function $m(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Bm]=!0,t.cancellationCode=e,t}function eA(n){return jm(n)&&Bi(n.url)}function jm(n){return!!n&&n[Bm]}var tA=(n,e,t,r)=>ue(i=>(new Cl(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Cl=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),sl(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=dr(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=dr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=dr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=dr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new El(s.value.snapshot))}),e.children.length&&this.forwardEvent(new wl(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(sl(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(u.contexts),a.attachRef=u.componentRef,a.route=u.route.value,a.outlet&&a.outlet.attach(u.componentRef,u.route.value),sl(u.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,r)}},na=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},gr=class{constructor(e,t){this.component=e,this.route=t}};function nA(n,e,t){let r=n._root,i=e?e._root:null;return Mi(r,i,t,[r.value])}function rA(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function wr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!hp(n)?n:e.get(n):r}function Mi(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=dr(e);return n.children.forEach(a=>{iA(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,u])=>Vi(u,t.getContext(a),i)),i}function iA(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let c=sA(a,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new na(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?Mi(n,e,u?u.children:null,r,i):Mi(n,e,t,r,i),c&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new gr(u.outlet.component,a))}else a&&Vi(e,u,i),i.canActivateChecks.push(new na(r)),s.component?Mi(n,null,u?u.children:null,r,i):Mi(n,null,t,r,i);return i}function sA(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!kn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!kn(n.url,e.url)||!yt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Sl(n,e)||!yt(n.queryParams,e.queryParams);case"paramsChange":default:return!Sl(n,e)}}function Vi(n,e,t){let r=dr(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?Vi(a,e.children.getContext(s),t):Vi(a,null,t):Vi(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new gr(e.outlet.component,i)):t.canDeactivateChecks.push(new gr(null,i)):t.canDeactivateChecks.push(new gr(null,i))}function Ji(n){return typeof n=="function"}function oA(n){return typeof n=="boolean"}function aA(n){return n&&Ji(n.canLoad)}function uA(n){return n&&Ji(n.canActivate)}function cA(n){return n&&Ji(n.canActivateChild)}function lA(n){return n&&Ji(n.canDeactivate)}function hA(n){return n&&Ji(n.canMatch)}function zm(n){return n instanceof ip||n?.name==="EmptyError"}var qo=Symbol("INITIAL_VALUE");function vr(){return dt(n=>Tu(n.map(e=>e.pipe(Zn(1),cp(qo)))).pipe(ue(e=>{for(let t of e)if(t!==!0){if(t===qo)return qo;if(t===!1||dA(t))return t}return!0}),Jn(e=>e!==qo),Zn(1)))}function dA(n){return Bi(n)||n instanceof Hi}function fA(n,e){return Xe(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?q(Te(F({},t),{guardsResult:!0})):pA(a,r,i,n).pipe(Xe(u=>u&&oA(u)?gA(r,s,n,e):q(u)),ue(u=>Te(F({},t),{guardsResult:u})))})}function pA(n,e,t,r){return at(n).pipe(Xe(i=>wA(i.component,i.route,t,e,r)),en(i=>i!==!0,!0))}function gA(n,e,t,r){return at(e).pipe(hi(i=>sp(yA(i.route.parent,r),mA(i.route,r),vA(n,i.path,t),_A(n,i.route,t))),en(i=>i!==!0,!0))}function mA(n,e){return n!==null&&e&&e(new Il(n)),q(!0)}function yA(n,e){return n!==null&&e&&e(new vl(n)),q(!0)}function _A(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return q(!0);let i=r.map(s=>Au(()=>{let a=Yi(e)??t,u=wr(s,a),c=uA(u)?u.canActivate(e,n):Nt(a,()=>u(e,n));return ln(c).pipe(en())}));return q(i).pipe(vr())}function vA(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>rA(a)).filter(a=>a!==null).map(a=>Au(()=>{let u=a.guards.map(c=>{let d=Yi(a.node)??t,p=wr(c,d),m=cA(p)?p.canActivateChild(r,n):Nt(d,()=>p(r,n));return ln(m).pipe(en())});return q(u).pipe(vr())}));return q(s).pipe(vr())}function wA(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return q(!0);let a=s.map(u=>{let c=Yi(e)??i,d=wr(u,c),p=lA(d)?d.canDeactivate(n,e,t,r):Nt(c,()=>d(n,e,t,r));return ln(p).pipe(en())});return q(a).pipe(vr())}function IA(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return q(!0);let s=i.map(a=>{let u=wr(a,n),c=aA(u)?u.canLoad(e,t):Nt(n,()=>u(e,t));return ln(c)});return q(s).pipe(vr(),qm(r))}function qm(n){return ep(Ae(e=>{if(typeof e!="boolean")throw ta(n,e)}),ue(e=>e===!0))}function EA(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return q(!0);let s=i.map(a=>{let u=wr(a,n),c=hA(u)?u.canMatch(e,t):Nt(n,()=>u(e,t));return ln(c)});return q(s).pipe(vr(),qm(r))}var Wi=class{constructor(e){this.segmentGroup=e||null}},Ki=class extends Error{constructor(e){super(),this.urlTree=e}};function hr(n){return li(new Wi(n))}function TA(n){return li(new ye(4e3,!1))}function AA(n){return li($m(!1,Ke.GuardRejected))}var Rl=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return q(r);if(i.numberOfChildren>1||!i.children[G])return TA(`${e.redirectTo}`);i=i.children[G]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let u=t,{queryParams:c,fragment:d,routeConfig:p,url:m,outlet:I,params:b,data:R,title:O}=i,P=Nt(s,()=>u({params:b,data:R,queryParams:c,fragment:d,routeConfig:p,url:m,outlet:I,title:O}));if(P instanceof $t)throw new Ki(P);t=P}let a=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Ki(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new $t(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let u=s.substring(1);r[i]=t[u]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([u,c])=>{a[u]=this.createSegmentGroup(e,c,r,i)}),new ne(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ye(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Pl={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function DA(n,e,t,r,i){let s=Gm(n,e,t);return s.matched?(r=WT(e,r),EA(r,e,t,i).pipe(ue(a=>a===!0?s:F({},Pl)))):q(s)}function Gm(n,e,t){if(e.path==="**")return SA(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?F({},Pl):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||IT)(t,n,e);if(!i)return F({},Pl);let s={};Object.entries(i.posParams??{}).forEach(([u,c])=>{s[u]=c.path});let a=i.consumed.length>0?F(F({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function SA(n){return{matched:!0,parameters:n.length>0?Am(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function wm(n,e,t,r){return t.length>0&&RA(n,t,r)?{segmentGroup:new ne(e,CA(r,new ne(t,n.children))),slicedSegments:[]}:t.length===0&&PA(n,t,r)?{segmentGroup:new ne(n.segments,bA(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ne(n.segments,n.children),slicedSegments:t}}function bA(n,e,t,r){let i={};for(let s of t)if(ia(n,e,s)&&!r[lt(s)]){let a=new ne([],{});i[lt(s)]=a}return F(F({},r),i)}function CA(n,e){let t={};t[G]=e;for(let r of n)if(r.path===""&&lt(r)!==G){let i=new ne([],{});t[lt(r)]=i}return t}function RA(n,e,t){return t.some(r=>ia(n,e,r)&&lt(r)!==G)}function PA(n,e,t){return t.some(r=>ia(n,e,r))}function ia(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function NA(n,e,t){return e.length===0&&!n.children[t]}var Nl=class{};function kA(n,e,t,r,i,s,a="emptyOnly"){return new kl(n,e,t,r,i,a,s).recognize()}var OA=31,kl=class{constructor(e,t,r,i,s,a,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=u,this.applyRedirects=new Rl(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new ye(4002,`'${e.segmentGroup}'`)}recognize(){let e=wm(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ue(({children:t,rootSnapshot:r})=>{let i=new We(r,t),s=new ea("",i),a=BT(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),{state:s,tree:a}}))}match(e){let t=new pr([],Object.freeze({}),Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),G,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,G,t).pipe(ue(r=>({children:r,rootSnapshot:t})),Xn(r=>{if(r instanceof Ki)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Wi?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(ue(a=>a instanceof We?[a]:[]))}processChildren(e,t,r,i){let s=[];for(let a of Object.keys(r.children))a==="primary"?s.unshift(a):s.push(a);return at(s).pipe(hi(a=>{let u=r.children[a],c=KT(t,a);return this.processSegmentGroup(e,c,u,a,i)}),up((a,u)=>(a.push(...u),a)),Du(null),ap(),Xe(a=>{if(a===null)return hr(r);let u=Hm(a);return MA(u),q(u)}))}processSegment(e,t,r,i,s,a,u){return at(t).pipe(hi(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,a,u).pipe(Xn(d=>{if(d instanceof Wi)return q(null);throw d}))),en(c=>!!c),Xn(c=>{if(zm(c))return NA(r,i,s)?q(new Nl):hr(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,a,u,c){return lt(r)!==a&&(a===G||!ia(i,s,r))?hr(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a,c):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a,c):hr(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a,u){let{matched:c,parameters:d,consumedSegments:p,positionalParamSegments:m,remainingSegments:I}=Gm(t,i,s);if(!c)return hr(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>OA&&(this.allowRedirects=!1));let b=new pr(s,d,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Im(i),lt(i),i.component??i._loadedComponent??null,i,Em(i)),R=Zo(b,u,this.paramsInheritanceStrategy);b.params=Object.freeze(R.params),b.data=Object.freeze(R.data);let O=this.applyRedirects.applyRedirectCommands(p,i.redirectTo,m,b,e);return this.applyRedirects.lineralizeSegments(i,O).pipe(Xe(P=>this.processSegment(e,r,t,P.concat(I),a,!1,u)))}matchSegmentAgainstRoute(e,t,r,i,s,a){let u=DA(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),u.pipe(dt(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(dt(({routes:d})=>{let p=r._loadedInjector??e,{parameters:m,consumedSegments:I,remainingSegments:b}=c,R=new pr(I,m,Object.freeze(F({},this.urlTree.queryParams)),this.urlTree.fragment,Im(r),lt(r),r.component??r._loadedComponent??null,r,Em(r)),O=Zo(R,a,this.paramsInheritanceStrategy);R.params=Object.freeze(O.params),R.data=Object.freeze(O.data);let{segmentGroup:P,slicedSegments:z}=wm(t,I,b,d);if(z.length===0&&P.hasChildren())return this.processChildren(p,d,P,R).pipe(ue(H=>new We(R,H)));if(d.length===0&&z.length===0)return q(new We(R,[]));let W=lt(r)===s;return this.processSegment(p,d,P,z,W?G:s,!0,R).pipe(ue(H=>new We(R,H instanceof We?[H]:[])))}))):hr(t)))}getChildConfig(e,t,r){return t.children?q({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?q({routes:t._loadedRoutes,injector:t._loadedInjector}):IA(e,t,r,this.urlSerializer).pipe(Xe(i=>i?this.configLoader.loadChildren(e,t).pipe(Ae(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):AA(t))):q({routes:[],injector:e})}};function MA(n){n.sort((e,t)=>e.value.outlet===G?-1:t.value.outlet===G?1:e.value.outlet.localeCompare(t.value.outlet))}function xA(n){let e=n.value.routeConfig;return e&&e.path===""}function Hm(n){let e=[],t=new Set;for(let r of n){if(!xA(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Hm(r.children);e.push(new We(r.value,i))}return e.filter(r=>!t.has(r))}function Im(n){return n.data||{}}function Em(n){return n.resolve||{}}function FA(n,e,t,r,i,s){return Xe(a=>kA(n,e,t,r,a.extractedUrl,i,s).pipe(ue(({state:u,tree:c})=>Te(F({},a),{targetSnapshot:u,urlAfterRedirects:c}))))}function LA(n,e){return Xe(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return q(t);let s=new Set(i.map(c=>c.route)),a=new Set;for(let c of s)if(!a.has(c))for(let d of Wm(c))a.add(d);let u=0;return at(a).pipe(hi(c=>s.has(c)?VA(c,r,n,e):(c.data=Zo(c,c.parent,n).resolve,q(void 0))),Ae(()=>u++),Su(1),Xe(c=>u===a.size?q(t):Zt))})}function Wm(n){let e=n.children.map(t=>Wm(t)).flat();return[n,...e]}function VA(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Um(i)&&(s[Qi]=i.title),UA(s,n,e,r).pipe(ue(a=>(n._resolvedData=a,n.data=Zo(n,n.parent,t).resolve,null)))}function UA(n,e,t,r){let i=ul(n);if(i.length===0)return q({});let s={};return at(i).pipe(Xe(a=>BA(n[a],e,t,r).pipe(en(),Ae(u=>{if(u instanceof Hi)throw ta(new Ui,u);s[a]=u}))),Su(1),op(s),Xn(a=>zm(a)?Zt:li(a)))}function BA(n,e,t,r){let i=Yi(e)??r,s=wr(n,i),a=s.resolve?s.resolve(e,t):Nt(i,()=>s(e,t));return ln(a)}function ol(n){return dt(e=>{let t=n(e);return t?at(t).pipe(ue(()=>e)):q(e)})}var Km=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===G);return r}getResolvedTitleForRoute(t){return t.data[Qi]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>V($A),providedIn:"root"})}}return n})(),$A=(()=>{class n extends Km{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(ie(Yp))}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ll=new pe("",{providedIn:"root",factory:()=>({})}),jA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=dp({type:n,selectors:[["ng-component"]],standalone:!0,features:[Ip],decls:1,vars:0,template:function(r,i){r&1&&wp(0,"router-outlet")},dependencies:[YT],encapsulation:2})}}return n})();function Vl(n){let e=n.children&&n.children.map(Vl),t=e?Te(F({},n),{children:e}):F({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==G&&(t.component=jA),t}var Ul=new pe(""),zA=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=V(Fu)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return q(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=ln(t.loadComponent()).pipe(ue(Qm),Ae(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Us(()=>{this.componentLoaders.delete(t)})),i=new wu(r,()=>new Rt).pipe(vu());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return q({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=qA(r,this.compiler,t,this.onLoadEndListener).pipe(Us(()=>{this.childrenLoaders.delete(r)})),a=new wu(s,()=>new Rt).pipe(vu());return this.childrenLoaders.set(r,a),a}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function qA(n,e,t,r){return ln(n.loadChildren()).pipe(ue(Qm),Xe(i=>i instanceof _p||Array.isArray(i)?q(i):at(e.compileModuleAsync(i))),ue(i=>{r&&r(n);let s,a,u=!1;return Array.isArray(i)?(a=i,u=!0):(s=i.create(t).injector,a=s.get(Ul,[],{optional:!0,self:!0}).flat()),{routes:a.map(Vl),injector:s}}))}function GA(n){return n&&typeof n=="object"&&"default"in n}function Qm(n){return GA(n)?n.default:n}var Bl=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>V(HA),providedIn:"root"})}}return n})(),HA=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),WA=new pe("");var KA=new pe(""),QA=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Rt,this.transitionAbortSubject=new Rt,this.configLoader=V(zA),this.environmentInjector=V(js),this.urlSerializer=V(Ml),this.rootContexts=V(ra),this.location=V(pi),this.inputBindingEnabled=V(Fl,{optional:!0})!==null,this.titleStrategy=V(Km),this.options=V(Ll,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=V(Bl),this.createViewTransition=V(WA,{optional:!0}),this.navigationErrorHandler=V(KA,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>q(void 0),this.rootComponentType=null;let t=i=>this.events.next(new yl(i)),r=i=>this.events.next(new _l(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Te(F(F({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Je({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Li,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Jn(s=>s.id!==0),ue(s=>Te(F({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),dt(s=>{let a=!1,u=!1;return q(s).pipe(dt(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Ke.SupersededByNewNavigation),Zt;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Te(F({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!d&&p!=="reload"){let m="";return this.events.next(new Mn(c.id,this.urlSerializer.serialize(c.rawUrl),m,dl.IgnoredSameUrlNavigation)),c.resolve(!1),Zt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return q(c).pipe(dt(m=>{let I=this.transitions?.getValue();return this.events.next(new ji(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),I!==this.transitions?.getValue()?Zt:Promise.resolve(m)}),FA(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Ae(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=Te(F({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let I=new Yo(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(I)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:m,extractedUrl:I,source:b,restoredState:R,extras:O}=c,P=new ji(m,this.urlSerializer.serialize(I),b,R);this.events.next(P);let z=Lm(this.rootComponentType).snapshot;return this.currentTransition=s=Te(F({},c),{targetSnapshot:z,urlAfterRedirects:I,extras:Te(F({},O),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=I,q(s)}else{let m="";return this.events.next(new Mn(c.id,this.urlSerializer.serialize(c.extractedUrl),m,dl.IgnoredByUrlHandlingStrategy)),c.resolve(!1),Zt}}),Ae(c=>{let d=new fl(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),ue(c=>(this.currentTransition=s=Te(F({},c),{guards:nA(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),fA(this.environmentInjector,c=>this.events.next(c)),Ae(c=>{if(s.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw ta(this.urlSerializer,c.guardsResult);let d=new pl(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(d)}),Jn(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Ke.GuardRejected),!1)),ol(c=>{if(c.guards.canActivateChecks.length)return q(c).pipe(Ae(d=>{let p=new gl(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}),dt(d=>{let p=!1;return q(d).pipe(LA(this.paramsInheritanceStrategy,this.environmentInjector),Ae({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(d,"",Ke.NoDataFromResolver)}}))}),Ae(d=>{let p=new ml(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}))}),ol(c=>{let d=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(Ae(I=>{p.component=I}),ue(()=>{})));for(let I of p.children)m.push(...d(I));return m};return Tu(d(c.targetSnapshot.root)).pipe(Du(null),Zn(1))}),ol(()=>this.afterPreactivation()),dt(()=>{let{currentSnapshot:c,targetSnapshot:d}=s,p=this.createViewTransition?.(this.environmentInjector,c.root,d.root);return p?at(p).pipe(ue(()=>s)):q(s)}),ue(c=>{let d=JT(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=Te(F({},c),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,s}),Ae(()=>{this.events.next(new qi)}),tA(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Zn(1),Ae({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new On(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),lp(this.transitionAbortSubject.pipe(Ae(c=>{throw c}))),Us(()=>{!a&&!u&&this.cancelNavigationTransition(s,"",Ke.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),Xn(c=>{if(u=!0,jm(c))this.events.next(new Bt(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),eA(c)?this.events.next(new yr(c.url,c.navigationBehaviorOptions)):s.resolve(!1);else{let d=new zi(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0);try{let p=Nt(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(p instanceof Hi){let{message:m,cancellationCode:I}=ta(this.urlSerializer,p);this.events.next(new Bt(s.id,this.urlSerializer.serialize(s.extractedUrl),m,I)),this.events.next(new yr(p.redirectTo,p.navigationBehaviorOptions))}else{this.events.next(d);let m=t.errorHandler(c);s.resolve(!!m)}}catch(p){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(p)}}return Zt}))}))}cancelNavigationTransition(t,r,i){let s=new Bt(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function YA(n){return n!==Li}var JA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>V(XA),providedIn:"root"})}}return n})(),Ol=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},XA=(()=>{class n extends Ol{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Pu(n)))(i||n)}})()}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Ym=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:()=>V(ZA),providedIn:"root"})}}return n})(),ZA=(()=>{class n extends Ym{constructor(){super(...arguments),this.location=V(pi),this.urlSerializer=V(Ml),this.options=V(Ll,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=V(Bl),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new $t,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Lm(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof ji)this.stateMemento=this.createStateMemento();else if(t instanceof Mn)this.rawUrlTree=r.initialUrl;else if(t instanceof Yo){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof qi?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Bt&&(t.code===Ke.GuardRejected||t.code===Ke.NoDataFromResolver)?this.restoreHistory(r):t instanceof zi?this.restoreHistory(r,!0):t instanceof On&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof $t?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,a=F(F({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",a)}else{let s=F(F({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Pu(n)))(i||n)}})()}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),xi=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(xi||{});function eD(n,e){n.events.pipe(Jn(t=>t instanceof On||t instanceof Bt||t instanceof zi||t instanceof Mn),ue(t=>t instanceof On||t instanceof Mn?xi.COMPLETE:(t instanceof Bt?t.code===Ke.Redirect||t.code===Ke.SupersededByNewNavigation:!1)?xi.REDIRECTING:xi.FAILED),Jn(t=>t!==xi.REDIRECTING),Zn(1)).subscribe(()=>{e()})}function tD(n){throw n}var nD={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},rD={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Jm=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=V(Gs),this.stateManager=V(Ym),this.options=V(Ll,{optional:!0})||{},this.pendingTasks=V(pp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=V(QA),this.urlSerializer=V(Ml),this.location=V(pi),this.urlHandlingStrategy=V(Bl),this._events=new Rt,this.errorHandler=this.options.errorHandler||tD,this.navigated=!1,this.routeReuseStrategy=V(JA),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=V(Ul,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!V(Fl,{optional:!0}),this.eventsSubscription=new Zf,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Bt&&r.code!==Ke.Redirect&&r.code!==Ke.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof On)this.navigated=!0;else if(r instanceof yr){let a=r.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=F({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||YA(i.source)},a);this.scheduleNavigation(u,Li,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}sD(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Li,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},a=i?.navigationId?i:null;if(i){let c=F({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let u=this.parseUrl(t);this.scheduleNavigation(u,r,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Vl),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:a,queryParamsHandling:u,preserveFragment:c}=r,d=c?this.currentUrlTree.fragment:a,p=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":p=F(F({},this.currentUrlTree.queryParams),s);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let I=i?i.snapshot:this.routerState.snapshot.root;m=Om(I)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return Mm(m,t,p,d??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Bi(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Li,null,r)}navigate(t,r={skipLocationChange:!1}){return iD(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=F({},nD):r===!1?i=F({},rD):i=r,Bi(t))return mm(this.currentUrlTree,t,i);let s=this.parseUrl(t);return mm(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,a){if(this.disposed)return Promise.resolve(!1);let u,c,d;a?(u=a.resolve,c=a.reject,d=a.promise):d=new Promise((m,I)=>{u=m,c=I});let p=this.pendingTasks.add();return eD(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:u,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(m=>Promise.reject(m))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function iD(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ye(4008,!1)}function sD(n){return!(n instanceof qi)&&!(n instanceof yr)}var oD=new pe("");function BP(n,...e){return wn([{provide:Ul,multi:!0,useValue:n},[],{provide:_r,useFactory:aD,deps:[Jm]},{provide:Ap,multi:!0,useFactory:uD},e.map(t=>t.\u0275providers)])}function aD(n){return n.routerState.root}function uD(){let n=V(In);return e=>{let t=n.get(xu);if(e!==t.components[0])return;let r=n.get(Jm),i=n.get(cD);n.get(lD)===1&&r.initialNavigation(),n.get(hD,null,bu.Optional)?.setUpPreloading(),n.get(oD,null,bu.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var cD=new pe("",{factory:()=>new Rt}),lD=new pe("",{providedIn:"root",factory:()=>1});var hD=new pe("");var Xm={apiKey:"AIzaSyAtvWNL0SosEH5IfXqCTjrmC_iwx_v600s",authDomain:"todo-13c71.firebaseapp.com",projectId:"todo-13c71",storageBucket:"todo-13c71.firebasestorage.app",messagingSenderId:"196363664197",appId:"1:196363664197:web:50e211c42bdfca6ea21c2c",measurementId:"G-WZB3CC6QKC"};var Zm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ey={};var hn,$l;(function(){var n;function e(E,g){function _(){}_.prototype=g.prototype,E.D=g.prototype,E.prototype=new _,E.prototype.constructor=E,E.C=function(w,T,D){for(var y=Array(arguments.length-2),St=2;St<arguments.length;St++)y[St-2]=arguments[St];return g.prototype[T].apply(w,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,g,_){_||(_=0);var w=Array(16);if(typeof g=="string")for(var T=0;16>T;++T)w[T]=g.charCodeAt(_++)|g.charCodeAt(_++)<<8|g.charCodeAt(_++)<<16|g.charCodeAt(_++)<<24;else for(T=0;16>T;++T)w[T]=g[_++]|g[_++]<<8|g[_++]<<16|g[_++]<<24;g=E.g[0],_=E.g[1],T=E.g[2];var D=E.g[3],y=g+(D^_&(T^D))+w[0]+3614090360&4294967295;g=_+(y<<7&4294967295|y>>>25),y=D+(T^g&(_^T))+w[1]+3905402710&4294967295,D=g+(y<<12&4294967295|y>>>20),y=T+(_^D&(g^_))+w[2]+606105819&4294967295,T=D+(y<<17&4294967295|y>>>15),y=_+(g^T&(D^g))+w[3]+3250441966&4294967295,_=T+(y<<22&4294967295|y>>>10),y=g+(D^_&(T^D))+w[4]+4118548399&4294967295,g=_+(y<<7&4294967295|y>>>25),y=D+(T^g&(_^T))+w[5]+1200080426&4294967295,D=g+(y<<12&4294967295|y>>>20),y=T+(_^D&(g^_))+w[6]+2821735955&4294967295,T=D+(y<<17&4294967295|y>>>15),y=_+(g^T&(D^g))+w[7]+4249261313&4294967295,_=T+(y<<22&4294967295|y>>>10),y=g+(D^_&(T^D))+w[8]+1770035416&4294967295,g=_+(y<<7&4294967295|y>>>25),y=D+(T^g&(_^T))+w[9]+2336552879&4294967295,D=g+(y<<12&4294967295|y>>>20),y=T+(_^D&(g^_))+w[10]+4294925233&4294967295,T=D+(y<<17&4294967295|y>>>15),y=_+(g^T&(D^g))+w[11]+2304563134&4294967295,_=T+(y<<22&4294967295|y>>>10),y=g+(D^_&(T^D))+w[12]+1804603682&4294967295,g=_+(y<<7&4294967295|y>>>25),y=D+(T^g&(_^T))+w[13]+4254626195&4294967295,D=g+(y<<12&4294967295|y>>>20),y=T+(_^D&(g^_))+w[14]+2792965006&4294967295,T=D+(y<<17&4294967295|y>>>15),y=_+(g^T&(D^g))+w[15]+1236535329&4294967295,_=T+(y<<22&4294967295|y>>>10),y=g+(T^D&(_^T))+w[1]+4129170786&4294967295,g=_+(y<<5&4294967295|y>>>27),y=D+(_^T&(g^_))+w[6]+3225465664&4294967295,D=g+(y<<9&4294967295|y>>>23),y=T+(g^_&(D^g))+w[11]+643717713&4294967295,T=D+(y<<14&4294967295|y>>>18),y=_+(D^g&(T^D))+w[0]+3921069994&4294967295,_=T+(y<<20&4294967295|y>>>12),y=g+(T^D&(_^T))+w[5]+3593408605&4294967295,g=_+(y<<5&4294967295|y>>>27),y=D+(_^T&(g^_))+w[10]+38016083&4294967295,D=g+(y<<9&4294967295|y>>>23),y=T+(g^_&(D^g))+w[15]+3634488961&4294967295,T=D+(y<<14&4294967295|y>>>18),y=_+(D^g&(T^D))+w[4]+3889429448&4294967295,_=T+(y<<20&4294967295|y>>>12),y=g+(T^D&(_^T))+w[9]+568446438&4294967295,g=_+(y<<5&4294967295|y>>>27),y=D+(_^T&(g^_))+w[14]+3275163606&4294967295,D=g+(y<<9&4294967295|y>>>23),y=T+(g^_&(D^g))+w[3]+4107603335&4294967295,T=D+(y<<14&4294967295|y>>>18),y=_+(D^g&(T^D))+w[8]+1163531501&4294967295,_=T+(y<<20&4294967295|y>>>12),y=g+(T^D&(_^T))+w[13]+2850285829&4294967295,g=_+(y<<5&4294967295|y>>>27),y=D+(_^T&(g^_))+w[2]+4243563512&4294967295,D=g+(y<<9&4294967295|y>>>23),y=T+(g^_&(D^g))+w[7]+1735328473&4294967295,T=D+(y<<14&4294967295|y>>>18),y=_+(D^g&(T^D))+w[12]+2368359562&4294967295,_=T+(y<<20&4294967295|y>>>12),y=g+(_^T^D)+w[5]+4294588738&4294967295,g=_+(y<<4&4294967295|y>>>28),y=D+(g^_^T)+w[8]+2272392833&4294967295,D=g+(y<<11&4294967295|y>>>21),y=T+(D^g^_)+w[11]+1839030562&4294967295,T=D+(y<<16&4294967295|y>>>16),y=_+(T^D^g)+w[14]+4259657740&4294967295,_=T+(y<<23&4294967295|y>>>9),y=g+(_^T^D)+w[1]+2763975236&4294967295,g=_+(y<<4&4294967295|y>>>28),y=D+(g^_^T)+w[4]+1272893353&4294967295,D=g+(y<<11&4294967295|y>>>21),y=T+(D^g^_)+w[7]+4139469664&4294967295,T=D+(y<<16&4294967295|y>>>16),y=_+(T^D^g)+w[10]+3200236656&4294967295,_=T+(y<<23&4294967295|y>>>9),y=g+(_^T^D)+w[13]+681279174&4294967295,g=_+(y<<4&4294967295|y>>>28),y=D+(g^_^T)+w[0]+3936430074&4294967295,D=g+(y<<11&4294967295|y>>>21),y=T+(D^g^_)+w[3]+3572445317&4294967295,T=D+(y<<16&4294967295|y>>>16),y=_+(T^D^g)+w[6]+76029189&4294967295,_=T+(y<<23&4294967295|y>>>9),y=g+(_^T^D)+w[9]+3654602809&4294967295,g=_+(y<<4&4294967295|y>>>28),y=D+(g^_^T)+w[12]+3873151461&4294967295,D=g+(y<<11&4294967295|y>>>21),y=T+(D^g^_)+w[15]+530742520&4294967295,T=D+(y<<16&4294967295|y>>>16),y=_+(T^D^g)+w[2]+3299628645&4294967295,_=T+(y<<23&4294967295|y>>>9),y=g+(T^(_|~D))+w[0]+4096336452&4294967295,g=_+(y<<6&4294967295|y>>>26),y=D+(_^(g|~T))+w[7]+1126891415&4294967295,D=g+(y<<10&4294967295|y>>>22),y=T+(g^(D|~_))+w[14]+2878612391&4294967295,T=D+(y<<15&4294967295|y>>>17),y=_+(D^(T|~g))+w[5]+4237533241&4294967295,_=T+(y<<21&4294967295|y>>>11),y=g+(T^(_|~D))+w[12]+1700485571&4294967295,g=_+(y<<6&4294967295|y>>>26),y=D+(_^(g|~T))+w[3]+2399980690&4294967295,D=g+(y<<10&4294967295|y>>>22),y=T+(g^(D|~_))+w[10]+4293915773&4294967295,T=D+(y<<15&4294967295|y>>>17),y=_+(D^(T|~g))+w[1]+2240044497&4294967295,_=T+(y<<21&4294967295|y>>>11),y=g+(T^(_|~D))+w[8]+1873313359&4294967295,g=_+(y<<6&4294967295|y>>>26),y=D+(_^(g|~T))+w[15]+4264355552&4294967295,D=g+(y<<10&4294967295|y>>>22),y=T+(g^(D|~_))+w[6]+2734768916&4294967295,T=D+(y<<15&4294967295|y>>>17),y=_+(D^(T|~g))+w[13]+1309151649&4294967295,_=T+(y<<21&4294967295|y>>>11),y=g+(T^(_|~D))+w[4]+4149444226&4294967295,g=_+(y<<6&4294967295|y>>>26),y=D+(_^(g|~T))+w[11]+3174756917&4294967295,D=g+(y<<10&4294967295|y>>>22),y=T+(g^(D|~_))+w[2]+718787259&4294967295,T=D+(y<<15&4294967295|y>>>17),y=_+(D^(T|~g))+w[9]+3951481745&4294967295,E.g[0]=E.g[0]+g&4294967295,E.g[1]=E.g[1]+(T+(y<<21&4294967295|y>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+D&4294967295}r.prototype.u=function(E,g){g===void 0&&(g=E.length);for(var _=g-this.blockSize,w=this.B,T=this.h,D=0;D<g;){if(T==0)for(;D<=_;)i(this,E,D),D+=this.blockSize;if(typeof E=="string"){for(;D<g;)if(w[T++]=E.charCodeAt(D++),T==this.blockSize){i(this,w),T=0;break}}else for(;D<g;)if(w[T++]=E[D++],T==this.blockSize){i(this,w),T=0;break}}this.h=T,this.o+=g},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var g=1;g<E.length-8;++g)E[g]=0;var _=8*this.o;for(g=E.length-8;g<E.length;++g)E[g]=_&255,_/=256;for(this.u(E),E=Array(16),g=_=0;4>g;++g)for(var w=0;32>w;w+=8)E[_++]=this.g[g]>>>w&255;return E};function s(E,g){var _=u;return Object.prototype.hasOwnProperty.call(_,E)?_[E]:_[E]=g(E)}function a(E,g){this.h=g;for(var _=[],w=!0,T=E.length-1;0<=T;T--){var D=E[T]|0;w&&D==g||(_[T]=D,w=!1)}this.g=_}var u={};function c(E){return-128<=E&&128>E?s(E,function(g){return new a([g|0],0>g?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return P(d(-E));for(var g=[],_=1,w=0;E>=_;w++)g[w]=E/_|0,_*=4294967296;return new a(g,0)}function p(E,g){if(E.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(E.charAt(0)=="-")return P(p(E.substring(1),g));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(g,8)),w=m,T=0;T<E.length;T+=8){var D=Math.min(8,E.length-T),y=parseInt(E.substring(T,T+D),g);8>D?(D=d(Math.pow(g,D)),w=w.j(D).add(d(y))):(w=w.j(_),w=w.add(d(y)))}return w}var m=c(0),I=c(1),b=c(16777216);n=a.prototype,n.m=function(){if(O(this))return-P(this).m();for(var E=0,g=1,_=0;_<this.g.length;_++){var w=this.i(_);E+=(0<=w?w:4294967296+w)*g,g*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(R(this))return"0";if(O(this))return"-"+P(this).toString(E);for(var g=d(Math.pow(E,6)),_=this,w="";;){var T=le(_,g).g;_=z(_,T.j(g));var D=((0<_.g.length?_.g[0]:_.h)>>>0).toString(E);if(_=T,R(_))return D+w;for(;6>D.length;)D="0"+D;w=D+w}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function R(E){if(E.h!=0)return!1;for(var g=0;g<E.g.length;g++)if(E.g[g]!=0)return!1;return!0}function O(E){return E.h==-1}n.l=function(E){return E=z(this,E),O(E)?-1:R(E)?0:1};function P(E){for(var g=E.g.length,_=[],w=0;w<g;w++)_[w]=~E.g[w];return new a(_,~E.h).add(I)}n.abs=function(){return O(this)?P(this):this},n.add=function(E){for(var g=Math.max(this.g.length,E.g.length),_=[],w=0,T=0;T<=g;T++){var D=w+(this.i(T)&65535)+(E.i(T)&65535),y=(D>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);w=y>>>16,D&=65535,y&=65535,_[T]=y<<16|D}return new a(_,_[_.length-1]&-2147483648?-1:0)};function z(E,g){return E.add(P(g))}n.j=function(E){if(R(this)||R(E))return m;if(O(this))return O(E)?P(this).j(P(E)):P(P(this).j(E));if(O(E))return P(this.j(P(E)));if(0>this.l(b)&&0>E.l(b))return d(this.m()*E.m());for(var g=this.g.length+E.g.length,_=[],w=0;w<2*g;w++)_[w]=0;for(w=0;w<this.g.length;w++)for(var T=0;T<E.g.length;T++){var D=this.i(w)>>>16,y=this.i(w)&65535,St=E.i(T)>>>16,Gr=E.i(T)&65535;_[2*w+2*T]+=y*Gr,W(_,2*w+2*T),_[2*w+2*T+1]+=D*Gr,W(_,2*w+2*T+1),_[2*w+2*T+1]+=y*St,W(_,2*w+2*T+1),_[2*w+2*T+2]+=D*St,W(_,2*w+2*T+2)}for(w=0;w<g;w++)_[w]=_[2*w+1]<<16|_[2*w];for(w=g;w<2*g;w++)_[w]=0;return new a(_,0)};function W(E,g){for(;(E[g]&65535)!=E[g];)E[g+1]+=E[g]>>>16,E[g]&=65535,g++}function H(E,g){this.g=E,this.h=g}function le(E,g){if(R(g))throw Error("division by zero");if(R(E))return new H(m,m);if(O(E))return g=le(P(E),g),new H(P(g.g),P(g.h));if(O(g))return g=le(E,P(g)),new H(P(g.g),g.h);if(30<E.g.length){if(O(E)||O(g))throw Error("slowDivide_ only works with positive integers.");for(var _=I,w=g;0>=w.l(E);)_=Ue(_),w=Ue(w);var T=re(_,1),D=re(w,1);for(w=re(w,2),_=re(_,2);!R(w);){var y=D.add(w);0>=y.l(E)&&(T=T.add(_),D=y),w=re(w,1),_=re(_,1)}return g=z(E,T.j(g)),new H(T,g)}for(T=m;0<=E.l(g);){for(_=Math.max(1,Math.floor(E.m()/g.m())),w=Math.ceil(Math.log(_)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),D=d(_),y=D.j(g);O(y)||0<y.l(E);)_-=w,D=d(_),y=D.j(g);R(D)&&(D=I),T=T.add(D),E=z(E,y)}return new H(T,E)}n.A=function(E){return le(this,E).h},n.and=function(E){for(var g=Math.max(this.g.length,E.g.length),_=[],w=0;w<g;w++)_[w]=this.i(w)&E.i(w);return new a(_,this.h&E.h)},n.or=function(E){for(var g=Math.max(this.g.length,E.g.length),_=[],w=0;w<g;w++)_[w]=this.i(w)|E.i(w);return new a(_,this.h|E.h)},n.xor=function(E){for(var g=Math.max(this.g.length,E.g.length),_=[],w=0;w<g;w++)_[w]=this.i(w)^E.i(w);return new a(_,this.h^E.h)};function Ue(E){for(var g=E.g.length+1,_=[],w=0;w<g;w++)_[w]=E.i(w)<<1|E.i(w-1)>>>31;return new a(_,E.h)}function re(E,g){var _=g>>5;g%=32;for(var w=E.g.length-_,T=[],D=0;D<w;D++)T[D]=0<g?E.i(D+_)>>>g|E.i(D+_+1)<<32-g:E.i(D+_);return new a(T,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,$l=ey.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,hn=ey.Integer=a}).apply(typeof Zm<"u"?Zm:typeof self<"u"?self:typeof window<"u"?window:{});var sa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jt={};var jl,dD,Ir,zl,Xi,oa,ql,Gl,Hl;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,l,h){return o==Array.prototype||o==Object.prototype||(o[l]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof sa=="object"&&sa];for(var l=0;l<o.length;++l){var h=o[l];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,l){if(l)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var A=o[f];if(!(A in h))break e;h=h[A]}o=o[o.length-1],f=h[o],l=l(f),l!=f&&l!=null&&e(h,o,{configurable:!0,writable:!0,value:l})}}function s(o,l){o instanceof String&&(o+="");var h=0,f=!1,A={next:function(){if(!f&&h<o.length){var S=h++;return{value:l(S,o[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(o){return o||function(){return s(this,function(l,h){return h})}});var a=a||{},u=this||self;function c(o){var l=typeof o;return l=l!="object"?l:o?Array.isArray(o)?"array":l:"null",l=="array"||l=="object"&&typeof o.length=="number"}function d(o){var l=typeof o;return l=="object"&&o!=null||l=="function"}function p(o,l,h){return o.call.apply(o.bind,arguments)}function m(o,l,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,f),o.apply(l,A)}}return function(){return o.apply(l,arguments)}}function I(o,l,h){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,I.apply(null,arguments)}function b(o,l){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function R(o,l){function h(){}h.prototype=l.prototype,o.aa=l.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,A,S){for(var k=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)k[oe-2]=arguments[oe];return l.prototype[A].apply(f,k)}}function O(o){let l=o.length;if(0<l){let h=Array(l);for(let f=0;f<l;f++)h[f]=o[f];return h}return[]}function P(o,l){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(c(f)){let A=o.length||0,S=f.length||0;o.length=A+S;for(let k=0;k<S;k++)o[A+k]=f[k]}else o.push(f)}}class z{constructor(l,h){this.i=l,this.j=h,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function W(o){return/^[\s\xa0]*$/.test(o)}function H(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function le(o){return le[" "](o),o}le[" "]=function(){};var Ue=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function re(o,l,h){for(let f in o)l.call(h,o[f],f,o)}function E(o,l){for(let h in o)l.call(void 0,o[h],h,o)}function g(o){let l={};for(let h in o)l[h]=o[h];return l}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(o,l){let h,f;for(let A=1;A<arguments.length;A++){f=arguments[A];for(h in f)o[h]=f[h];for(let S=0;S<_.length;S++)h=_[S],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function T(o){var l=1;o=o.split(":");let h=[];for(;0<l&&o.length;)h.push(o.shift()),l--;return o.length&&h.push(o.join(":")),h}function D(o){u.setTimeout(()=>{throw o},0)}function y(){var o=Ka;let l=null;return o.g&&(l=o.g,o.g=o.g.next,o.g||(o.h=null),l.next=null),l}class St{constructor(){this.h=this.g=null}add(l,h){let f=Gr.get();f.set(l,h),this.h?this.h.next=f:this.g=f,this.h=f}}var Gr=new z(()=>new B_,o=>o.reset());class B_{constructor(){this.next=this.g=this.h=null}set(l,h){this.h=l,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let Hr,Wr=!1,Ka=new St,Jd=()=>{let o=u.Promise.resolve(void 0);Hr=()=>{o.then($_)}};var $_=()=>{for(var o;o=y();){try{o.h.call(o.g)}catch(h){D(h)}var l=Gr;l.j(o),100>l.h&&(l.h++,o.next=l.g,l.g=o)}Wr=!1};function Wt(){this.s=this.s,this.C=this.C}Wt.prototype.s=!1,Wt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Wt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ke(o,l){this.type=o,this.g=this.target=l,this.defaultPrevented=!1}ke.prototype.h=function(){this.defaultPrevented=!0};var j_=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,l=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};u.addEventListener("test",h,l),u.removeEventListener("test",h,l)}catch{}return o}();function Kr(o,l){if(ke.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=l,l=o.relatedTarget){if(Ue){e:{try{le(l.nodeName);var A=!0;break e}catch{}A=!1}A||(l=null)}}else h=="mouseover"?l=o.fromElement:h=="mouseout"&&(l=o.toElement);this.relatedTarget=l,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:z_[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Kr.aa.h.call(this)}}R(Kr,ke);var z_={2:"touch",3:"pen",4:"mouse"};Kr.prototype.h=function(){Kr.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Qr="closure_listenable_"+(1e6*Math.random()|0),q_=0;function G_(o,l,h,f,A){this.listener=o,this.proxy=null,this.src=l,this.type=h,this.capture=!!f,this.ha=A,this.key=++q_,this.da=this.fa=!1}function Is(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Es(o){this.src=o,this.g={},this.h=0}Es.prototype.add=function(o,l,h,f,A){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var k=Ya(o,l,f,A);return-1<k?(l=o[k],h||(l.fa=!1)):(l=new G_(l,this.src,S,!!f,A),l.fa=h,o.push(l)),l};function Qa(o,l){var h=l.type;if(h in o.g){var f=o.g[h],A=Array.prototype.indexOf.call(f,l,void 0),S;(S=0<=A)&&Array.prototype.splice.call(f,A,1),S&&(Is(l),o.g[h].length==0&&(delete o.g[h],o.h--))}}function Ya(o,l,h,f){for(var A=0;A<o.length;++A){var S=o[A];if(!S.da&&S.listener==l&&S.capture==!!h&&S.ha==f)return A}return-1}var Ja="closure_lm_"+(1e6*Math.random()|0),Xa={};function Xd(o,l,h,f,A){if(f&&f.once)return ef(o,l,h,f,A);if(Array.isArray(l)){for(var S=0;S<l.length;S++)Xd(o,l[S],h,f,A);return null}return h=nu(h),o&&o[Qr]?o.K(l,h,d(f)?!!f.capture:!!f,A):Zd(o,l,h,!1,f,A)}function Zd(o,l,h,f,A,S){if(!l)throw Error("Invalid event type");var k=d(A)?!!A.capture:!!A,oe=eu(o);if(oe||(o[Ja]=oe=new Es(o)),h=oe.add(l,h,f,k,S),h.proxy)return h;if(f=H_(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)j_||(A=k),A===void 0&&(A=!1),o.addEventListener(l.toString(),f,A);else if(o.attachEvent)o.attachEvent(nf(l.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function H_(){function o(h){return l.call(o.src,o.listener,h)}let l=W_;return o}function ef(o,l,h,f,A){if(Array.isArray(l)){for(var S=0;S<l.length;S++)ef(o,l[S],h,f,A);return null}return h=nu(h),o&&o[Qr]?o.L(l,h,d(f)?!!f.capture:!!f,A):Zd(o,l,h,!0,f,A)}function tf(o,l,h,f,A){if(Array.isArray(l))for(var S=0;S<l.length;S++)tf(o,l[S],h,f,A);else f=d(f)?!!f.capture:!!f,h=nu(h),o&&o[Qr]?(o=o.i,l=String(l).toString(),l in o.g&&(S=o.g[l],h=Ya(S,h,f,A),-1<h&&(Is(S[h]),Array.prototype.splice.call(S,h,1),S.length==0&&(delete o.g[l],o.h--)))):o&&(o=eu(o))&&(l=o.g[l.toString()],o=-1,l&&(o=Ya(l,h,f,A)),(h=-1<o?l[o]:null)&&Za(h))}function Za(o){if(typeof o!="number"&&o&&!o.da){var l=o.src;if(l&&l[Qr])Qa(l.i,o);else{var h=o.type,f=o.proxy;l.removeEventListener?l.removeEventListener(h,f,o.capture):l.detachEvent?l.detachEvent(nf(h),f):l.addListener&&l.removeListener&&l.removeListener(f),(h=eu(l))?(Qa(h,o),h.h==0&&(h.src=null,l[Ja]=null)):Is(o)}}}function nf(o){return o in Xa?Xa[o]:Xa[o]="on"+o}function W_(o,l){if(o.da)o=!0;else{l=new Kr(l,this);var h=o.listener,f=o.ha||o.src;o.fa&&Za(o),o=h.call(f,l)}return o}function eu(o){return o=o[Ja],o instanceof Es?o:null}var tu="__closure_events_fn_"+(1e9*Math.random()>>>0);function nu(o){return typeof o=="function"?o:(o[tu]||(o[tu]=function(l){return o.handleEvent(l)}),o[tu])}function Oe(){Wt.call(this),this.i=new Es(this),this.M=this,this.F=null}R(Oe,Wt),Oe.prototype[Qr]=!0,Oe.prototype.removeEventListener=function(o,l,h,f){tf(this,o,l,h,f)};function Be(o,l){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=l.type||l,typeof l=="string")l=new ke(l,o);else if(l instanceof ke)l.target=l.target||o;else{var A=l;l=new ke(f,o),w(l,A)}if(A=!0,h)for(var S=h.length-1;0<=S;S--){var k=l.g=h[S];A=Ts(k,f,!0,l)&&A}if(k=l.g=o,A=Ts(k,f,!0,l)&&A,A=Ts(k,f,!1,l)&&A,h)for(S=0;S<h.length;S++)k=l.g=h[S],A=Ts(k,f,!1,l)&&A}Oe.prototype.N=function(){if(Oe.aa.N.call(this),this.i){var o=this.i,l;for(l in o.g){for(var h=o.g[l],f=0;f<h.length;f++)Is(h[f]);delete o.g[l],o.h--}}this.F=null},Oe.prototype.K=function(o,l,h,f){return this.i.add(String(o),l,!1,h,f)},Oe.prototype.L=function(o,l,h,f){return this.i.add(String(o),l,!0,h,f)};function Ts(o,l,h,f){if(l=o.i.g[String(l)],!l)return!0;l=l.concat();for(var A=!0,S=0;S<l.length;++S){var k=l[S];if(k&&!k.da&&k.capture==h){var oe=k.listener,Ce=k.ha||k.src;k.fa&&Qa(o.i,k),A=oe.call(Ce,f)!==!1&&A}}return A&&!f.defaultPrevented}function rf(o,l,h){if(typeof o=="function")h&&(o=I(o,h));else if(o&&typeof o.handleEvent=="function")o=I(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:u.setTimeout(o,l||0)}function sf(o){o.g=rf(()=>{o.g=null,o.i&&(o.i=!1,sf(o))},o.l);let l=o.h;o.h=null,o.m.apply(null,l)}class K_ extends Wt{constructor(l,h){super(),this.m=l,this.l=h,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:sf(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yr(o){Wt.call(this),this.h=o,this.g={}}R(Yr,Wt);var of=[];function af(o){re(o.g,function(l,h){this.g.hasOwnProperty(h)&&Za(l)},o),o.g={}}Yr.prototype.N=function(){Yr.aa.N.call(this),af(this)},Yr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ru=u.JSON.stringify,Q_=u.JSON.parse,Y_=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function iu(){}iu.prototype.h=null;function uf(o){return o.h||(o.h=o.i())}function cf(){}var Jr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function su(){ke.call(this,"d")}R(su,ke);function ou(){ke.call(this,"c")}R(ou,ke);var mn={},lf=null;function As(){return lf=lf||new Oe}mn.La="serverreachability";function hf(o){ke.call(this,mn.La,o)}R(hf,ke);function Xr(o){let l=As();Be(l,new hf(l))}mn.STAT_EVENT="statevent";function df(o,l){ke.call(this,mn.STAT_EVENT,o),this.stat=l}R(df,ke);function $e(o){let l=As();Be(l,new df(l,o))}mn.Ma="timingevent";function ff(o,l){ke.call(this,mn.Ma,o),this.size=l}R(ff,ke);function Zr(o,l){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},l)}function ei(){this.g=!0}ei.prototype.xa=function(){this.g=!1};function J_(o,l,h,f,A,S){o.info(function(){if(o.g)if(S)for(var k="",oe=S.split("&"),Ce=0;Ce<oe.length;Ce++){var X=oe[Ce].split("=");if(1<X.length){var Me=X[0];X=X[1];var xe=Me.split("_");k=2<=xe.length&&xe[1]=="type"?k+(Me+"="+X+"&"):k+(Me+"=redacted&")}}else k=null;else k=S;return"XMLHTTP REQ ("+f+") [attempt "+A+"]: "+l+`
`+h+`
`+k})}function X_(o,l,h,f,A,S,k){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+A+"]: "+l+`
`+h+`
`+S+" "+k})}function Wn(o,l,h,f){o.info(function(){return"XMLHTTP TEXT ("+l+"): "+ev(o,h)+(f?" "+f:"")})}function Z_(o,l){o.info(function(){return"TIMEOUT: "+l})}ei.prototype.info=function(){};function ev(o,l){if(!o.g)return l;if(!l)return null;try{var h=JSON.parse(l);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var A=f[1];if(Array.isArray(A)&&!(1>A.length)){var S=A[0];if(S!="noop"&&S!="stop"&&S!="close")for(var k=1;k<A.length;k++)A[k]=""}}}}return ru(h)}catch{return l}}var Ds={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},pf={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},au;function Ss(){}R(Ss,iu),Ss.prototype.g=function(){return new XMLHttpRequest},Ss.prototype.i=function(){return{}},au=new Ss;function Kt(o,l,h,f){this.j=o,this.i=l,this.l=h,this.R=f||1,this.U=new Yr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new gf}function gf(){this.i=null,this.g="",this.h=!1}var mf={},uu={};function cu(o,l,h){o.L=1,o.v=Ps(bt(l)),o.m=h,o.P=!0,yf(o,null)}function yf(o,l){o.F=Date.now(),bs(o),o.A=bt(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),Nf(h.i,"t",f),o.C=0,h=o.j.J,o.h=new gf,o.g=Qf(o.j,h?l:null,!o.m),0<o.O&&(o.M=new K_(I(o.Y,o,o.g),o.O)),l=o.U,h=o.g,f=o.ca;var A="readystatechange";Array.isArray(A)||(A&&(of[0]=A.toString()),A=of);for(var S=0;S<A.length;S++){var k=Xd(h,A[S],f||l.handleEvent,!1,l.h||l);if(!k)break;l.g[k.key]=k}l=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,l)):(o.u="GET",o.g.ea(o.A,o.u,null,l)),Xr(),J_(o.i,o.u,o.A,o.l,o.R,o.m)}Kt.prototype.ca=function(o){o=o.target;let l=this.M;l&&Ct(o)==3?l.j():this.Y(o)},Kt.prototype.Y=function(o){try{if(o==this.g)e:{let xe=Ct(this.g);var l=this.g.Ba();let Yn=this.g.Z();if(!(3>xe)&&(xe!=3||this.g&&(this.h.h||this.g.oa()||Vf(this.g)))){this.J||xe!=4||l==7||(l==8||0>=Yn?Xr(3):Xr(2)),lu(this);var h=this.g.Z();this.X=h;t:if(_f(this)){var f=Vf(this.g);o="";var A=f.length,S=Ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yn(this),ti(this);var k="";break t}this.h.i=new u.TextDecoder}for(l=0;l<A;l++)this.h.h=!0,o+=this.h.i.decode(f[l],{stream:!(S&&l==A-1)});f.length=0,this.h.g+=o,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=h==200,X_(this.i,this.u,this.A,this.l,this.R,xe,h),this.o){if(this.T&&!this.K){t:{if(this.g){var oe,Ce=this.g;if((oe=Ce.g?Ce.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(oe)){var X=oe;break t}}X=null}if(h=X)Wn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,hu(this,h);else{this.o=!1,this.s=3,$e(12),yn(this),ti(this);break e}}if(this.P){h=!0;let ot;for(;!this.J&&this.C<k.length;)if(ot=tv(this,k),ot==uu){xe==4&&(this.s=4,$e(14),h=!1),Wn(this.i,this.l,null,"[Incomplete Response]");break}else if(ot==mf){this.s=4,$e(15),Wn(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else Wn(this.i,this.l,ot,null),hu(this,ot);if(_f(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xe!=4||k.length!=0||this.h.h||(this.s=1,$e(16),h=!1),this.o=this.o&&h,!h)Wn(this.i,this.l,k,"[Invalid Chunked Response]"),yn(this),ti(this);else if(0<k.length&&!this.W){this.W=!0;var Me=this.j;Me.g==this&&Me.ba&&!Me.M&&(Me.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),yu(Me),Me.M=!0,$e(11))}}else Wn(this.i,this.l,k,null),hu(this,k);xe==4&&yn(this),this.o&&!this.J&&(xe==4?Gf(this.j,this):(this.o=!1,bs(this)))}else _v(this.g),h==400&&0<k.indexOf("Unknown SID")?(this.s=3,$e(12)):(this.s=0,$e(13)),yn(this),ti(this)}}}catch{}finally{}};function _f(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function tv(o,l){var h=o.C,f=l.indexOf(`
`,h);return f==-1?uu:(h=Number(l.substring(h,f)),isNaN(h)?mf:(f+=1,f+h>l.length?uu:(l=l.slice(f,f+h),o.C=f+h,l)))}Kt.prototype.cancel=function(){this.J=!0,yn(this)};function bs(o){o.S=Date.now()+o.I,vf(o,o.I)}function vf(o,l){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Zr(I(o.ba,o),l)}function lu(o){o.B&&(u.clearTimeout(o.B),o.B=null)}Kt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(Z_(this.i,this.A),this.L!=2&&(Xr(),$e(17)),yn(this),this.s=2,ti(this)):vf(this,this.S-o)};function ti(o){o.j.G==0||o.J||Gf(o.j,o)}function yn(o){lu(o);var l=o.M;l&&typeof l.ma=="function"&&l.ma(),o.M=null,af(o.U),o.g&&(l=o.g,o.g=null,l.abort(),l.ma())}function hu(o,l){try{var h=o.j;if(h.G!=0&&(h.g==o||du(h.h,o))){if(!o.K&&du(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(l)}catch{f=null}if(Array.isArray(f)&&f.length==3){var A=f;if(A[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)xs(h),Os(h);else break e;mu(h),$e(18)}}else h.za=A[1],0<h.za-h.T&&37500>A[2]&&h.F&&h.v==0&&!h.C&&(h.C=Zr(I(h.Za,h),6e3));if(1>=Ef(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else vn(h,11)}else if((o.K||h.g==o)&&xs(h),!W(l))for(A=h.Da.g.parse(l),l=0;l<A.length;l++){let X=A[l];if(h.T=X[0],X=X[1],h.G==2)if(X[0]=="c"){h.K=X[1],h.ia=X[2];let Me=X[3];Me!=null&&(h.la=Me,h.j.info("VER="+h.la));let xe=X[4];xe!=null&&(h.Aa=xe,h.j.info("SVER="+h.Aa));let Yn=X[5];Yn!=null&&typeof Yn=="number"&&0<Yn&&(f=1.5*Yn,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let ot=o.g;if(ot){let Ls=ot.g?ot.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ls){var S=f.h;S.g||Ls.indexOf("spdy")==-1&&Ls.indexOf("quic")==-1&&Ls.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(fu(S,S.h),S.h=null))}if(f.D){let _u=ot.g?ot.g.getResponseHeader("X-HTTP-Session-Id"):null;_u&&(f.ya=_u,he(f.I,f.D,_u))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var k=o;if(f.qa=Kf(f,f.J?f.ia:null,f.W),k.K){Tf(f.h,k);var oe=k,Ce=f.L;Ce&&(oe.I=Ce),oe.B&&(lu(oe),bs(oe)),f.g=k}else zf(f);0<h.i.length&&Ms(h)}else X[0]!="stop"&&X[0]!="close"||vn(h,7);else h.G==3&&(X[0]=="stop"||X[0]=="close"?X[0]=="stop"?vn(h,7):gu(h):X[0]!="noop"&&h.l&&h.l.ta(X),h.v=0)}}Xr(4)}catch{}}var nv=class{constructor(o,l){this.g=o,this.map=l}};function wf(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function If(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ef(o){return o.h?1:o.g?o.g.size:0}function du(o,l){return o.h?o.h==l:o.g?o.g.has(l):!1}function fu(o,l){o.g?o.g.add(l):o.h=l}function Tf(o,l){o.h&&o.h==l?o.h=null:o.g&&o.g.has(l)&&o.g.delete(l)}wf.prototype.cancel=function(){if(this.i=Af(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Af(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let l=o.i;for(let h of o.g.values())l=l.concat(h.D);return l}return O(o.i)}function rv(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(c(o)){for(var l=[],h=o.length,f=0;f<h;f++)l.push(o[f]);return l}l=[],h=0;for(f in o)l[h++]=o[f];return l}function iv(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(c(o)||typeof o=="string"){var l=[];o=o.length;for(var h=0;h<o;h++)l.push(h);return l}l=[],h=0;for(let f in o)l[h++]=f;return l}}}function Df(o,l){if(o.forEach&&typeof o.forEach=="function")o.forEach(l,void 0);else if(c(o)||typeof o=="string")Array.prototype.forEach.call(o,l,void 0);else for(var h=iv(o),f=rv(o),A=f.length,S=0;S<A;S++)l.call(void 0,f[S],h&&h[S],o)}var Sf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sv(o,l){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),A=null;if(0<=f){var S=o[h].substring(0,f);A=o[h].substring(f+1)}else S=o[h];l(S,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function _n(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof _n){this.h=o.h,Cs(this,o.j),this.o=o.o,this.g=o.g,Rs(this,o.s),this.l=o.l;var l=o.i,h=new ii;h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),bf(this,h),this.m=o.m}else o&&(l=String(o).match(Sf))?(this.h=!1,Cs(this,l[1]||"",!0),this.o=ni(l[2]||""),this.g=ni(l[3]||"",!0),Rs(this,l[4]),this.l=ni(l[5]||"",!0),bf(this,l[6]||"",!0),this.m=ni(l[7]||"")):(this.h=!1,this.i=new ii(null,this.h))}_n.prototype.toString=function(){var o=[],l=this.j;l&&o.push(ri(l,Cf,!0),":");var h=this.g;return(h||l=="file")&&(o.push("//"),(l=this.o)&&o.push(ri(l,Cf,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(ri(h,h.charAt(0)=="/"?uv:av,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",ri(h,lv)),o.join("")};function bt(o){return new _n(o)}function Cs(o,l,h){o.j=h?ni(l,!0):l,o.j&&(o.j=o.j.replace(/:$/,""))}function Rs(o,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);o.s=l}else o.s=null}function bf(o,l,h){l instanceof ii?(o.i=l,hv(o.i,o.h)):(h||(l=ri(l,cv)),o.i=new ii(l,o.h))}function he(o,l,h){o.i.set(l,h)}function Ps(o){return he(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function ni(o,l){return o?l?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function ri(o,l,h){return typeof o=="string"?(o=encodeURI(o).replace(l,ov),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function ov(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Cf=/[#\/\?@]/g,av=/[#\?:]/g,uv=/[#\?]/g,cv=/[#\?@]/g,lv=/#/g;function ii(o,l){this.h=this.g=null,this.i=o||null,this.j=!!l}function Qt(o){o.g||(o.g=new Map,o.h=0,o.i&&sv(o.i,function(l,h){o.add(decodeURIComponent(l.replace(/\+/g," ")),h)}))}n=ii.prototype,n.add=function(o,l){Qt(this),this.i=null,o=Kn(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(l),this.h+=1,this};function Rf(o,l){Qt(o),l=Kn(o,l),o.g.has(l)&&(o.i=null,o.h-=o.g.get(l).length,o.g.delete(l))}function Pf(o,l){return Qt(o),l=Kn(o,l),o.g.has(l)}n.forEach=function(o,l){Qt(this),this.g.forEach(function(h,f){h.forEach(function(A){o.call(l,A,f,this)},this)},this)},n.na=function(){Qt(this);let o=Array.from(this.g.values()),l=Array.from(this.g.keys()),h=[];for(let f=0;f<l.length;f++){let A=o[f];for(let S=0;S<A.length;S++)h.push(l[f])}return h},n.V=function(o){Qt(this);let l=[];if(typeof o=="string")Pf(this,o)&&(l=l.concat(this.g.get(Kn(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)l=l.concat(o[h])}return l},n.set=function(o,l){return Qt(this),this.i=null,o=Kn(this,o),Pf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[l]),this.h+=1,this},n.get=function(o,l){return o?(o=this.V(o),0<o.length?String(o[0]):l):l};function Nf(o,l,h){Rf(o,l),0<h.length&&(o.i=null,o.g.set(Kn(o,l),O(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],l=Array.from(this.g.keys());for(var h=0;h<l.length;h++){var f=l[h];let S=encodeURIComponent(String(f)),k=this.V(f);for(f=0;f<k.length;f++){var A=S;k[f]!==""&&(A+="="+encodeURIComponent(String(k[f]))),o.push(A)}}return this.i=o.join("&")};function Kn(o,l){return l=String(l),o.j&&(l=l.toLowerCase()),l}function hv(o,l){l&&!o.j&&(Qt(o),o.i=null,o.g.forEach(function(h,f){var A=f.toLowerCase();f!=A&&(Rf(this,f),Nf(this,A,h))},o)),o.j=l}function dv(o,l){let h=new ei;if(u.Image){let f=new Image;f.onload=b(Yt,h,"TestLoadImage: loaded",!0,l,f),f.onerror=b(Yt,h,"TestLoadImage: error",!1,l,f),f.onabort=b(Yt,h,"TestLoadImage: abort",!1,l,f),f.ontimeout=b(Yt,h,"TestLoadImage: timeout",!1,l,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else l(!1)}function fv(o,l){let h=new ei,f=new AbortController,A=setTimeout(()=>{f.abort(),Yt(h,"TestPingServer: timeout",!1,l)},1e4);fetch(o,{signal:f.signal}).then(S=>{clearTimeout(A),S.ok?Yt(h,"TestPingServer: ok",!0,l):Yt(h,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(A),Yt(h,"TestPingServer: error",!1,l)})}function Yt(o,l,h,f,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),f(h)}catch{}}function pv(){this.g=new Y_}function gv(o,l,h){let f=h||"";try{Df(o,function(A,S){let k=A;d(A)&&(k=ru(A)),l.push(f+S+"="+encodeURIComponent(k))})}catch(A){throw l.push(f+"type="+encodeURIComponent("_badmap")),A}}function si(o){this.l=o.Ub||null,this.j=o.eb||!1}R(si,iu),si.prototype.g=function(){return new Ns(this.l,this.j)},si.prototype.i=function(o){return function(){return o}}({});function Ns(o,l){Oe.call(this),this.D=o,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(Ns,Oe),n=Ns.prototype,n.open=function(o,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=l,this.readyState=1,ai(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(l.body=o),(this.D||u).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,oi(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,ai(this)),this.g&&(this.readyState=3,ai(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;kf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function kf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var l=o.value?o.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!o.done}))&&(this.response=this.responseText+=l)}o.done?oi(this):ai(this),this.readyState==3&&kf(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,oi(this))},n.Qa=function(o){this.g&&(this.response=o,oi(this))},n.ga=function(){this.g&&oi(this)};function oi(o){o.readyState=4,o.l=null,o.j=null,o.v=null,ai(o)}n.setRequestHeader=function(o,l){this.u.append(o,l)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],l=this.h.entries();for(var h=l.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=l.next();return o.join(`\r
`)};function ai(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Ns.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Of(o){let l="";return re(o,function(h,f){l+=f,l+=":",l+=h,l+=`\r
`}),l}function pu(o,l,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=Of(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):he(o,l,h))}function fe(o){Oe.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(fe,Oe);var mv=/^https?$/i,yv=["POST","PUT"];n=fe.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,l,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);l=l?l.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():au.g(),this.v=this.o?uf(this.o):uf(au),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(l,String(o),!0),this.B=!1}catch(S){Mf(this,S);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var A in f)h.set(A,f[A]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())h.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(S=>S.toLowerCase()=="content-type"),A=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(yv,l,void 0))||f||A||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,k]of h)this.g.setRequestHeader(S,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Lf(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){Mf(this,S)}};function Mf(o,l){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=l,o.m=5,xf(o),ks(o)}function xf(o){o.A||(o.A=!0,Be(o,"complete"),Be(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Be(this,"complete"),Be(this,"abort"),ks(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ks(this,!0)),fe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ff(this):this.bb())},n.bb=function(){Ff(this)};function Ff(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Ct(o)!=4||o.Z()!=2)){if(o.u&&Ct(o)==4)rf(o.Ea,0,o);else if(Be(o,"readystatechange"),Ct(o)==4){o.h=!1;try{let k=o.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var h;if(!(h=l)){var f;if(f=k===0){var A=String(o.D).match(Sf)[1]||null;!A&&u.self&&u.self.location&&(A=u.self.location.protocol.slice(0,-1)),f=!mv.test(A?A.toLowerCase():"")}h=f}if(h)Be(o,"complete"),Be(o,"success");else{o.m=6;try{var S=2<Ct(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",xf(o)}}finally{ks(o)}}}}function ks(o,l){if(o.g){Lf(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,l||Be(o,"ready");try{h.onreadystatechange=f}catch{}}}function Lf(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function Ct(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<Ct(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var l=this.g.responseText;return o&&l.indexOf(o)==0&&(l=l.substring(o.length)),Q_(l)}};function Vf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function _v(o){let l={};o=(o.g&&2<=Ct(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(W(o[f]))continue;var h=T(o[f]);let A=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let S=l[A]||[];l[A]=S,S.push(h)}E(l,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ui(o,l,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||l}function Uf(o){this.Aa=0,this.i=[],this.j=new ei,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ui("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ui("baseRetryDelayMs",5e3,o),this.cb=ui("retryDelaySeedMs",1e4,o),this.Wa=ui("forwardChannelMaxRetries",2,o),this.wa=ui("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new wf(o&&o.concurrentRequestLimit),this.Da=new pv,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Uf.prototype,n.la=8,n.G=1,n.connect=function(o,l,h,f){$e(0),this.W=o,this.H=l||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=Kf(this,null,this.W),Ms(this)};function gu(o){if(Bf(o),o.G==3){var l=o.U++,h=bt(o.I);if(he(h,"SID",o.K),he(h,"RID",l),he(h,"TYPE","terminate"),ci(o,h),l=new Kt(o,o.j,l),l.L=2,l.v=Ps(bt(h)),h=!1,u.navigator&&u.navigator.sendBeacon)try{h=u.navigator.sendBeacon(l.v.toString(),"")}catch{}!h&&u.Image&&(new Image().src=l.v,h=!0),h||(l.g=Qf(l.j,null),l.g.ea(l.v)),l.F=Date.now(),bs(l)}Wf(o)}function Os(o){o.g&&(yu(o),o.g.cancel(),o.g=null)}function Bf(o){Os(o),o.u&&(u.clearTimeout(o.u),o.u=null),xs(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function Ms(o){if(!If(o.h)&&!o.s){o.s=!0;var l=o.Ga;Hr||Jd(),Wr||(Hr(),Wr=!0),Ka.add(l,o),o.B=0}}function vv(o,l){return Ef(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=l.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Zr(I(o.Ga,o,l),Hf(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let A=new Kt(this,this.j,o),S=this.o;if(this.S&&(S?(S=g(S),w(S,this.S)):S=this.S),this.m!==null||this.O||(A.H=S,S=null),this.P)e:{for(var l=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(l+=f,4096<l){l=h;break e}if(l===4096||h===this.i.length-1){l=h+1;break e}}l=1e3}else l=1e3;l=jf(this,A,l),h=bt(this.I),he(h,"RID",o),he(h,"CVER",22),this.D&&he(h,"X-HTTP-Session-Id",this.D),ci(this,h),S&&(this.O?l="headers="+encodeURIComponent(String(Of(S)))+"&"+l:this.m&&pu(h,this.m,S)),fu(this.h,A),this.Ua&&he(h,"TYPE","init"),this.P?(he(h,"$req",l),he(h,"SID","null"),A.T=!0,cu(A,h,null)):cu(A,h,l),this.G=2}}else this.G==3&&(o?$f(this,o):this.i.length==0||If(this.h)||$f(this))};function $f(o,l){var h;l?h=l.l:h=o.U++;let f=bt(o.I);he(f,"SID",o.K),he(f,"RID",h),he(f,"AID",o.T),ci(o,f),o.m&&o.o&&pu(f,o.m,o.o),h=new Kt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),l&&(o.i=l.D.concat(o.i)),l=jf(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),fu(o.h,h),cu(h,f,l)}function ci(o,l){o.H&&re(o.H,function(h,f){he(l,f,h)}),o.l&&Df({},function(h,f){he(l,f,h)})}function jf(o,l,h){h=Math.min(o.i.length,h);var f=o.l?I(o.l.Na,o.l,o):null;e:{var A=o.i;let S=-1;for(;;){let k=["count="+h];S==-1?0<h?(S=A[0].g,k.push("ofs="+S)):S=0:k.push("ofs="+S);let oe=!0;for(let Ce=0;Ce<h;Ce++){let X=A[Ce].g,Me=A[Ce].map;if(X-=S,0>X)S=Math.max(0,A[Ce].g-100),oe=!1;else try{gv(Me,k,"req"+X+"_")}catch{f&&f(Me)}}if(oe){f=k.join("&");break e}}}return o=o.i.splice(0,h),l.D=o,f}function zf(o){if(!o.g&&!o.u){o.Y=1;var l=o.Fa;Hr||Jd(),Wr||(Hr(),Wr=!0),Ka.add(l,o),o.v=0}}function mu(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Zr(I(o.Fa,o),Hf(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,qf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Zr(I(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$e(10),Os(this),qf(this))};function yu(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function qf(o){o.g=new Kt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var l=bt(o.qa);he(l,"RID","rpc"),he(l,"SID",o.K),he(l,"AID",o.T),he(l,"CI",o.F?"0":"1"),!o.F&&o.ja&&he(l,"TO",o.ja),he(l,"TYPE","xmlhttp"),ci(o,l),o.m&&o.o&&pu(l,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=Ps(bt(l)),h.m=null,h.P=!0,yf(h,o)}n.Za=function(){this.C!=null&&(this.C=null,Os(this),mu(this),$e(19))};function xs(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function Gf(o,l){var h=null;if(o.g==l){xs(o),yu(o),o.g=null;var f=2}else if(du(o.h,l))h=l.D,Tf(o.h,l),f=1;else return;if(o.G!=0){if(l.o)if(f==1){h=l.m?l.m.length:0,l=Date.now()-l.F;var A=o.B;f=As(),Be(f,new ff(f,h)),Ms(o)}else zf(o);else if(A=l.s,A==3||A==0&&0<l.X||!(f==1&&vv(o,l)||f==2&&mu(o)))switch(h&&0<h.length&&(l=o.h,l.i=l.i.concat(h)),A){case 1:vn(o,5);break;case 4:vn(o,10);break;case 3:vn(o,6);break;default:vn(o,2)}}}function Hf(o,l){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*l}function vn(o,l){if(o.j.info("Error code "+l),l==2){var h=I(o.fb,o),f=o.Xa;let A=!f;f=new _n(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Cs(f,"https"),Ps(f),A?dv(f.toString(),h):fv(f.toString(),h)}else $e(2);o.G=0,o.l&&o.l.sa(l),Wf(o),Bf(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),$e(2)):(this.j.info("Failed to ping google.com"),$e(1))};function Wf(o){if(o.G=0,o.ka=[],o.l){let l=Af(o.h);(l.length!=0||o.i.length!=0)&&(P(o.ka,l),P(o.ka,o.i),o.h.i.length=0,O(o.i),o.i.length=0),o.l.ra()}}function Kf(o,l,h){var f=h instanceof _n?bt(h):new _n(h);if(f.g!="")l&&(f.g=l+"."+f.g),Rs(f,f.s);else{var A=u.location;f=A.protocol,l=l?l+"."+A.hostname:A.hostname,A=+A.port;var S=new _n(null);f&&Cs(S,f),l&&(S.g=l),A&&Rs(S,A),h&&(S.l=h),f=S}return h=o.D,l=o.ya,h&&l&&he(f,h,l),he(f,"VER",o.la),ci(o,f),f}function Qf(o,l,h){if(l&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=o.Ca&&!o.pa?new fe(new si({eb:h})):new fe(o.pa),l.Ha(o.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yf(){}n=Yf.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Fs(){}Fs.prototype.g=function(o,l){return new ze(o,l)};function ze(o,l){Oe.call(this),this.g=new Uf(l),this.l=o,this.h=l&&l.messageUrlParams||null,o=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(o?o["X-WebChannel-Content-Type"]=l.messageContentType:o={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(o?o["X-WebChannel-Client-Profile"]=l.va:o={"X-WebChannel-Client-Profile":l.va}),this.g.S=o,(o=l&&l.Sb)&&!W(o)&&(this.g.m=o),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!W(l)&&(this.g.D=l,o=this.h,o!==null&&l in o&&(o=this.h,l in o&&delete o[l])),this.j=new Qn(this)}R(ze,Oe),ze.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ze.prototype.close=function(){gu(this.g)},ze.prototype.o=function(o){var l=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=ru(o),o=h);l.i.push(new nv(l.Ya++,o)),l.G==3&&Ms(l)},ze.prototype.N=function(){this.g.l=null,delete this.j,gu(this.g),delete this.g,ze.aa.N.call(this)};function Jf(o){su.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var l=o.__sm__;if(l){e:{for(let h in l){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,l=l!==null&&o in l?l[o]:void 0),this.data=l}else this.data=o}R(Jf,su);function Xf(){ou.call(this),this.status=1}R(Xf,ou);function Qn(o){this.g=o}R(Qn,Yf),Qn.prototype.ua=function(){Be(this.g,"a")},Qn.prototype.ta=function(o){Be(this.g,new Jf(o))},Qn.prototype.sa=function(o){Be(this.g,new Xf)},Qn.prototype.ra=function(){Be(this.g,"b")},Fs.prototype.createWebChannel=Fs.prototype.g,ze.prototype.send=ze.prototype.o,ze.prototype.open=ze.prototype.m,ze.prototype.close=ze.prototype.close,Hl=jt.createWebChannelTransport=function(){return new Fs},Gl=jt.getStatEventTarget=function(){return As()},ql=jt.Event=mn,oa=jt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ds.NO_ERROR=0,Ds.TIMEOUT=8,Ds.HTTP_ERROR=6,Xi=jt.ErrorCode=Ds,pf.COMPLETE="complete",zl=jt.EventType=pf,cf.EventType=Jr,Jr.OPEN="a",Jr.CLOSE="b",Jr.ERROR="c",Jr.MESSAGE="d",Oe.prototype.listen=Oe.prototype.K,Ir=jt.WebChannel=cf,dD=jt.FetchXmlHttpFactory=si,fe.prototype.listenOnce=fe.prototype.L,fe.prototype.getLastError=fe.prototype.Ka,fe.prototype.getLastErrorCode=fe.prototype.Ba,fe.prototype.getStatus=fe.prototype.Z,fe.prototype.getResponseJson=fe.prototype.Oa,fe.prototype.getResponseText=fe.prototype.oa,fe.prototype.send=fe.prototype.ea,fe.prototype.setWithCredentials=fe.prototype.Ha,jl=jt.XhrIo=fe}).apply(typeof sa<"u"?sa:typeof self<"u"?self:typeof window<"u"?window:{});var ty="@firebase/firestore";var be=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};be.UNAUTHENTICATED=new be(null),be.GOOGLE_CREDENTIALS=new be("google-credentials-uid"),be.FIRST_PARTY=new be("first-party-uid"),be.MOCK_USER=new be("mock-user");var zr="10.14.0";var Ln=new sn("@firebase/firestore");function Zi(){return Ln.logLevel}function M(n,...e){if(Ln.logLevel<=K.DEBUG){let t=e.map(Pd);Ln.debug(`Firestore (${zr}): ${n}`,...t)}}function qt(n,...e){if(Ln.logLevel<=K.ERROR){let t=e.map(Pd);Ln.error(`Firestore (${zr}): ${n}`,...t)}}function Rr(n,...e){if(Ln.logLevel<=K.WARN){let t=e.map(Pd);Ln.warn(`Firestore (${zr}): ${n}`,...t)}}function Pd(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function U(n="Unexpected state"){let e=`FIRESTORE (${zr}) INTERNAL ASSERTION FAILED: `+n;throw qt(e),new Error(e)}function se(n,e){n||U()}function $(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends He{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var vt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ha=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Jl=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(be.UNAUTHENTICATED))}shutdown(){}},Xl=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Zl=class{constructor(e){this.t=e,this.currentUser=be.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){se(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new vt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new vt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let c=s;e.enqueueRetryable(()=>v(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},u=c=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?u(c):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new vt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(se(typeof r.accessToken=="string"),new ha(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return se(e===null||typeof e=="string"),new be(e)}},eh=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=be.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},th=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new eh(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(be.FIRST_PARTY))}shutdown(){}invalidateToken(){}},nh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},rh=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){se(this.o===void 0);let r=s=>{s.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,M("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(se(typeof t.token=="string"),this.R=t.token,new nh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function fD(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var da=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=fD(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function Z(n,e){return n<e?-1:n>e?1:0}function Pr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Ne=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var j=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ne(0,0))}static max(){return new n(new Ne(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var fa=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&U(),r===void 0?r=e.length-t:r>e.length-t&&U(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ge=class n extends fa{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},pD=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Ye=class n extends fa{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return pD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new x(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new x(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new x(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new x(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(ge.fromString(e))}static fromName(e){return new n(ge.fromString(e).popFirst(5))}static empty(){return new n(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ge.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ge(e.slice()))}};var ih=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};ih.UNKNOWN_ID=-1;function gD(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=j.fromTimestamp(r===1e9?new Ne(t+1,0):new Ne(t,r));return new Vn(i,L.empty(),e)}function mD(n){return new Vn(n.readTime,n.key,-1)}var Vn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(j.min(),L.empty(),-1)}static max(){return new n(j.max(),L.empty(),-1)}};function yD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:Z(n.largestBatchId,e.largestBatchId))}var _D="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",sh=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ys(n){return v(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==_D)throw n;M("LocalStore","Unexpectedly lost primary lease")})}var N=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&U(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},c=>r(c))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let c=0;c<s;c++){let d=c;t(e[d]).next(p=>{a[d]=p,++u,u===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function vD(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function _s(n){return n.name==="IndexedDbTransactionError"}var ky=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ba(n){return n==null}function ss(n){return n===0&&1/n==-1/0}function wD(n){return typeof n=="number"&&Number.isInteger(n)&&!ss(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var ID=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],tN=[...ID,"documentOverlays"],ED=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],TD=ED,AD=[...TD,"indexConfiguration","indexState","indexEntries"];var nN=[...AD,"globals"];function ny(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Oy(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var me=class n{constructor(e,t){this.comparator=e,this.root=t||wt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Dr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Dr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Dr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Dr(this.root,e,this.comparator,!0)}},Dr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},wt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw U();let e=this.left.check();if(e!==this.right.check())throw U();return e+(this.isRed()?0:1)}};wt.EMPTY=null,wt.RED=!0,wt.BLACK=!1;wt.EMPTY=new class{constructor(){this.size=0}get key(){throw U()}get value(){throw U()}get color(){throw U()}get left(){throw U()}get right(){throw U()}copy(e,t,r,i,s){return this}insert(e,t,r){return new wt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Le=class n{constructor(e){this.comparator=e,this.data=new me(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new pa(this.data.getIterator())}getIteratorFrom(e){return new pa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},pa=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var it=class n{constructor(e){this.fields=e,e.sort(Ye.comparator)}static empty(){return new n([])}unionWith(e){let t=new Le(Ye.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Pr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var ga=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Ve=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ga("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ve.EMPTY_BYTE_STRING=new Ve("");var DD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Gt(n){if(se(!!n),typeof n=="string"){let e=0,t=DD.exec(n);if(se(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:de(n.seconds),nanos:de(n.nanos)}}function de(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function fn(n){return typeof n=="string"?Ve.fromBase64String(n):Ve.fromUint8Array(n)}function Nd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function kd(n){let e=n.mapValue.fields.__previous_value__;return Nd(e)?kd(e):e}function os(n){let e=Gt(n.mapValue.fields.__local_write_time__.timestampValue);return new Ne(e.seconds,e.nanos)}var oh=class{constructor(e,t,r,i,s,a,u,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d}},ma=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var aa={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Un(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Nd(n)?4:xy(n)?9007199254740991:My(n)?10:11:U()}function Tt(n,e){if(n===e)return!0;let t=Un(n);if(t!==Un(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return os(n).isEqual(os(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Gt(i.timestampValue),u=Gt(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return fn(i.bytesValue).isEqual(fn(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return de(i.geoPointValue.latitude)===de(s.geoPointValue.latitude)&&de(i.geoPointValue.longitude)===de(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return de(i.integerValue)===de(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=de(i.doubleValue),u=de(s.doubleValue);return a===u?ss(a)===ss(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return Pr(n.arrayValue.values||[],e.arrayValue.values||[],Tt);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(ny(a)!==ny(u))return!1;for(let c in a)if(a.hasOwnProperty(c)&&(u[c]===void 0||!Tt(a[c],u[c])))return!1;return!0}(n,e);default:return U()}}function as(n,e){return(n.values||[]).find(t=>Tt(t,e))!==void 0}function Nr(n,e){if(n===e)return 0;let t=Un(n),r=Un(e);if(t!==r)return Z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Z(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=de(s.integerValue||s.doubleValue),c=de(a.integerValue||a.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(n,e);case 3:return ry(n.timestampValue,e.timestampValue);case 4:return ry(os(n),os(e));case 5:return Z(n.stringValue,e.stringValue);case 6:return function(s,a){let u=fn(s),c=fn(a);return u.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),c=a.split("/");for(let d=0;d<u.length&&d<c.length;d++){let p=Z(u[d],c[d]);if(p!==0)return p}return Z(u.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=Z(de(s.latitude),de(a.latitude));return u!==0?u:Z(de(s.longitude),de(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return iy(n.arrayValue,e.arrayValue);case 10:return function(s,a){var u,c,d,p;let m=s.fields||{},I=a.fields||{},b=(u=m.value)===null||u===void 0?void 0:u.arrayValue,R=(c=I.value)===null||c===void 0?void 0:c.arrayValue,O=Z(((d=b?.values)===null||d===void 0?void 0:d.length)||0,((p=R?.values)===null||p===void 0?void 0:p.length)||0);return O!==0?O:iy(b,R)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===aa.mapValue&&a===aa.mapValue)return 0;if(s===aa.mapValue)return 1;if(a===aa.mapValue)return-1;let u=s.fields||{},c=Object.keys(u),d=a.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){let I=Z(c[m],p[m]);if(I!==0)return I;let b=Nr(u[c[m]],d[p[m]]);if(b!==0)return b}return Z(c.length,p.length)}(n.mapValue,e.mapValue);default:throw U()}}function ry(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Z(n,e);let t=Gt(n),r=Gt(e),i=Z(t.seconds,r.seconds);return i!==0?i:Z(t.nanos,r.nanos)}function iy(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Nr(t[i],r[i]);if(s)return s}return Z(t.length,r.length)}function kr(n){return ah(n)}function ah(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Gt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return fn(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=ah(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${ah(t.fields[a])}`;return i+"}"}(n.mapValue):U()}function uh(n){return!!n&&"integerValue"in n}function Od(n){return!!n&&"arrayValue"in n}function sy(n){return!!n&&"nullValue"in n}function oy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ca(n){return!!n&&"mapValue"in n}function My(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ts(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Gn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ts(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ts(n.arrayValue.values[t]);return e}return Object.assign({},n)}function xy(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Qe=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ca(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ts(t)}setAll(e){let t=Ye.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=ts(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());ca(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ca(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Gn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(ts(this.value))}};function Fy(n){let e=[];return Gn(n.fields,(t,r)=>{let i=new Ye([t]);if(ca(r)){let s=Fy(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new it(e)}var ht=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,j.min(),j.min(),j.min(),Qe.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,j.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,j.min(),j.min(),Qe.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,j.min(),j.min(),Qe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Or=class{constructor(e,t){this.position=e,this.inclusive=t}};function ay(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=Nr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function uy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tt(n.position[t],e.position[t]))return!1;return!0}var Mr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function SD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ya=class{},Ee=class n extends ya{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new lh(e,t,r):t==="array-contains"?new fh(e,r):t==="in"?new ph(e,r):t==="not-in"?new gh(e,r):t==="array-contains-any"?new mh(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new hh(e,r):new dh(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Nr(t,this.value)):t!==null&&Un(this.value)===Un(t)&&this.matchesComparison(Nr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return U()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},At=class n extends ya{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Ly(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Ly(n){return n.op==="and"}function Vy(n){return bD(n)&&Ly(n)}function bD(n){for(let e of n.filters)if(e instanceof At)return!1;return!0}function ch(n){if(n instanceof Ee)return n.field.canonicalString()+n.op.toString()+kr(n.value);if(Vy(n))return n.filters.map(e=>ch(e)).join(",");{let e=n.filters.map(t=>ch(t)).join(",");return`${n.op}(${e})`}}function Uy(n,e){return n instanceof Ee?function(r,i){return i instanceof Ee&&r.op===i.op&&r.field.isEqual(i.field)&&Tt(r.value,i.value)}(n,e):n instanceof At?function(r,i){return i instanceof At&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&Uy(a,i.filters[u]),!0):!1}(n,e):void U()}function By(n){return n instanceof Ee?function(t){return`${t.field.canonicalString()} ${t.op} ${kr(t.value)}`}(n):n instanceof At?function(t){return t.op.toString()+" {"+t.getFilters().map(By).join(" ,")+"}"}(n):"Filter"}var lh=class extends Ee{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},hh=class extends Ee{constructor(e,t){super(e,"in",t),this.keys=$y("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},dh=class extends Ee{constructor(e,t){super(e,"not-in",t),this.keys=$y("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function $y(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var fh=class extends Ee{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Od(t)&&as(t.arrayValue,this.value)}},ph=class extends Ee{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&as(this.value.arrayValue,t)}},gh=class extends Ee{constructor(e,t){super(e,"not-in",t)}matches(e){if(as(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!as(this.value.arrayValue,t)}},mh=class extends Ee{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Od(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>as(this.value.arrayValue,r))}};var yh=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.ue=null}};function cy(n,e=null,t=[],r=[],i=null,s=null,a=null){return new yh(n,e,t,r,i,s,a)}function Md(n){let e=$(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ch(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ba(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>kr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>kr(r)).join(",")),e.ue=t}return e.ue}function xd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!SD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Uy(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!uy(n.startAt,e.startAt)&&uy(n.endAt,e.endAt)}function _h(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var xr=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function CD(n,e,t,r,i,s,a,u){return new xr(n,e,t,r,i,s,a,u)}function jy(n){return new xr(n)}function ly(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function RD(n){return n.collectionGroup!==null}function ns(n){let e=$(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Le(Ye.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Mr(s,r))}),t.has(Ye.keyField().canonicalString())||e.ce.push(new Mr(Ye.keyField(),r))}return e.ce}function It(n){let e=$(n);return e.le||(e.le=PD(e,ns(n))),e.le}function PD(n,e){if(n.limitType==="F")return cy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Mr(i.field,s)});let t=n.endAt?new Or(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Or(n.startAt.position,n.startAt.inclusive):null;return cy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function vh(n,e,t){return new xr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function $a(n,e){return xd(It(n),It(e))&&n.limitType===e.limitType}function zy(n){return`${Md(It(n))}|lt:${n.limitType}`}function Er(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>By(i)).join(", ")}]`),Ba(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>kr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>kr(i)).join(",")),`Target(${r})`}(It(n))}; limitType=${n.limitType})`}function ja(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):L.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of ns(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,c){let d=ay(a,u,c);return a.inclusive?d<=0:d<0}(r.startAt,ns(r),i)||r.endAt&&!function(a,u,c){let d=ay(a,u,c);return a.inclusive?d>=0:d>0}(r.endAt,ns(r),i))}(n,e)}function ND(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function qy(n){return(e,t)=>{let r=!1;for(let i of ns(n)){let s=kD(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function kD(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(s,a,u){let c=a.data.field(s),d=u.data.field(s);return c!==null&&d!==null?Nr(c,d):U()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return U()}}var pn=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Gn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Oy(this.inner)}size(){return this.innerSize}};var OD=new me(L.comparator);function Ht(){return OD}var Gy=new me(L.comparator);function es(...n){let e=Gy;for(let t of n)e=e.insert(t.key,t);return e}function Hy(n){let e=Gy;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function xn(){return rs()}function Wy(){return rs()}function rs(){return new pn(n=>n.toString(),(n,e)=>n.isEqual(e))}var MD=new me(L.comparator),xD=new Le(L.comparator);function Q(...n){let e=xD;for(let t of n)e=e.add(t);return e}var FD=new Le(Z);function LD(){return FD}function Fd(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ss(e)?"-0":e}}function Ky(n){return{integerValue:""+n}}function VD(n,e){return wD(e)?Ky(e):Fd(n,e)}var Fr=class{constructor(){this._=void 0}};function UD(n,e,t){return n instanceof Lr?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Nd(s)&&(s=kd(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Bn?Yy(n,e):n instanceof $n?Jy(n,e):function(i,s){let a=Qy(i,s),u=hy(a)+hy(i.Pe);return uh(a)&&uh(i.Pe)?Ky(u):Fd(i.serializer,u)}(n,e)}function BD(n,e,t){return n instanceof Bn?Yy(n,e):n instanceof $n?Jy(n,e):t}function Qy(n,e){return n instanceof Vr?function(r){return uh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Lr=class extends Fr{},Bn=class extends Fr{constructor(e){super(),this.elements=e}};function Yy(n,e){let t=Xy(e);for(let r of n.elements)t.some(i=>Tt(i,r))||t.push(r);return{arrayValue:{values:t}}}var $n=class extends Fr{constructor(e){super(),this.elements=e}};function Jy(n,e){let t=Xy(e);for(let r of n.elements)t=t.filter(i=>!Tt(i,r));return{arrayValue:{values:t}}}var Vr=class extends Fr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function hy(n){return de(n.integerValue||n.doubleValue)}function Xy(n){return Od(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function $D(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Bn&&i instanceof Bn||r instanceof $n&&i instanceof $n?Pr(r.elements,i.elements,Tt):r instanceof Vr&&i instanceof Vr?Tt(r.Pe,i.Pe):r instanceof Lr&&i instanceof Lr}(n.transform,e.transform)}var wh=class{constructor(e,t){this.version=e,this.transformResults=t}},zt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function la(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Ur=class{};function Zy(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new us(n.key,zt.none()):new jn(n.key,n.data,zt.none());{let t=n.data,r=Qe.empty(),i=new Le(Ye.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Dt(n.key,r,new it(i.toArray()),zt.none())}}function jD(n,e,t){n instanceof jn?function(i,s,a){let u=i.value.clone(),c=fy(i.fieldTransforms,s,a.transformResults);u.setAll(c),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof Dt?function(i,s,a){if(!la(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=fy(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(e_(i)),c.setAll(u),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function is(n,e,t,r){return n instanceof jn?function(s,a,u,c){if(!la(s.precondition,a))return u;let d=s.value.clone(),p=py(s.fieldTransforms,c,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Dt?function(s,a,u,c){if(!la(s.precondition,a))return u;let d=py(s.fieldTransforms,c,a),p=a.data;return p.setAll(e_(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,u){return la(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function zD(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Qy(r.transform,i||null);s!=null&&(t===null&&(t=Qe.empty()),t.set(r.field,s))}return t||null}function dy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Pr(r,i,(s,a)=>$D(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var jn=class extends Ur{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Dt=class extends Ur{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function e_(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function fy(n,e,t){let r=new Map;se(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,BD(a,u,t[i]))}return r}function py(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,UD(s,a,e))}return r}var us=class extends Ur{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ih=class extends Ur{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Eh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&jD(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=is(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=is(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Wy();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let c=Zy(a,u);c!==null&&r.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(j.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Q())}isEqual(e){return this.batchId===e.batchId&&Pr(this.mutations,e.mutations,(t,r)=>dy(t,r))&&Pr(this.baseMutations,e.baseMutations,(t,r)=>dy(t,r))}},Th=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){se(e.mutations.length===r.length);let i=function(){return MD}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var Ah=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Dh=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var we,J;function qD(n){switch(n){default:return U();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function t_(n){if(n===void 0)return qt("GRPC error has no .code"),C.UNKNOWN;switch(n){case we.OK:return C.OK;case we.CANCELLED:return C.CANCELLED;case we.UNKNOWN:return C.UNKNOWN;case we.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case we.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case we.INTERNAL:return C.INTERNAL;case we.UNAVAILABLE:return C.UNAVAILABLE;case we.UNAUTHENTICATED:return C.UNAUTHENTICATED;case we.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case we.NOT_FOUND:return C.NOT_FOUND;case we.ALREADY_EXISTS:return C.ALREADY_EXISTS;case we.PERMISSION_DENIED:return C.PERMISSION_DENIED;case we.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case we.ABORTED:return C.ABORTED;case we.OUT_OF_RANGE:return C.OUT_OF_RANGE;case we.UNIMPLEMENTED:return C.UNIMPLEMENTED;case we.DATA_LOSS:return C.DATA_LOSS;default:return U()}}(J=we||(we={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var gy=null;function GD(){return new TextEncoder}var HD=new hn([4294967295,4294967295],0);function my(n){let e=GD().encode(n),t=new $l;return t.update(e),new Uint8Array(t.digest())}function yy(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new hn([t,r],0),new hn([i,s],0)]}var Sh=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Fn(`Invalid padding: ${t}`);if(r<0)throw new Fn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Fn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=hn.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(hn.fromNumber(r)));return i.compare(HD)===1&&(i=new hn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=my(e),[r,i]=yy(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=my(e),[r,i]=yy(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Fn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var _a=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,cs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(j.min(),i,new me(Z),Ht(),Q())}},cs=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Q(),Q(),Q())}};var br=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},va=class{constructor(e,t){this.targetId=e,this.me=t}},wa=class{constructor(e,t,r=Ve.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ia=class{constructor(){this.fe=0,this.ge=vy(),this.pe=Ve.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Q(),t=Q(),r=Q();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:U()}}),new cs(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=vy()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,se(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},bh=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ht(),this.qe=_y(),this.Qe=new me(Z)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:U()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(_h(s))if(r===0){let a=new L(s.path);this.Ue(t,a,ht.newNoDocument(a,j.min()))}else se(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),c=u?this.Xe(u,e,a):1;if(c!==0){this.je(t);let d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}gy?.et(function(p,m,I,b,R){var O,P,z,W,H,le;let Ue={localCacheCount:p,existenceFilterCount:m.count,databaseId:I.database,projectId:I.projectId},re=m.unchangedNames;return re&&(Ue.bloomFilter={applied:R===0,hashCount:(O=re?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(W=(z=(P=re?.bits)===null||P===void 0?void 0:P.bitmap)===null||z===void 0?void 0:z.length)!==null&&W!==void 0?W:0,padding:(le=(H=re?.bits)===null||H===void 0?void 0:H.padding)!==null&&le!==void 0?le:0,mightContain:E=>{var g;return(g=b?.mightContain(E))!==null&&g!==void 0&&g}}),Ue}(a,e.me,this.Le.tt(),u,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,u;try{a=fn(r).toUint8Array()}catch(c){if(c instanceof ga)return Rr("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new Sh(a,i,s)}catch(c){return Rr(c instanceof Fn?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let u=this.Je(a);if(u){if(s.current&&_h(u.target)){let c=new L(u.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,ht.newNoDocument(c,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let r=Q();this.qe.forEach((s,a)=>{let u=!0;a.forEachWhile(c=>{let d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new _a(e,t,this.Qe,this.ke,r);return this.ke=Ht(),this.qe=_y(),this.Qe=new me(Z),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ia,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Le(Z),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||M("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ia),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function _y(){return new me(L.comparator)}function vy(){return new me(L.comparator)}var WD={asc:"ASCENDING",desc:"DESCENDING"},KD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},QD={and:"AND",or:"OR"},Ch=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Rh(n,e){return n.useProto3Json||Ba(e)?e:{value:e}}function Ea(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function n_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function YD(n,e){return Ea(n,e.toTimestamp())}function Et(n){return se(!!n),j.fromTimestamp(function(t){let r=Gt(t);return new Ne(r.seconds,r.nanos)}(n))}function Ld(n,e){return Ph(n,e).canonicalString()}function Ph(n,e){let t=function(i){return new ge(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function r_(n){let e=ge.fromString(n);return se(u_(e)),e}function Nh(n,e){return Ld(n.databaseId,e.path)}function Wl(n,e){let t=r_(e);if(t.get(1)!==n.databaseId.projectId)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(s_(t))}function i_(n,e){return Ld(n.databaseId,e)}function JD(n){let e=r_(n);return e.length===4?ge.emptyPath():s_(e)}function kh(n){return new ge(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function s_(n){return se(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function wy(n,e,t){return{name:Nh(n,e),fields:t.value.mapValue.fields}}function XD(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:U()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(se(p===void 0||typeof p=="string"),Ve.fromBase64String(p||"")):(se(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Ve.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?C.UNKNOWN:t_(d.code);return new x(p,d.message||"")}(a);t=new wa(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Wl(n,r.document.name),s=Et(r.document.updateTime),a=r.document.createTime?Et(r.document.createTime):j.min(),u=new Qe({mapValue:{fields:r.document.fields}}),c=ht.newFoundDocument(i,s,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new br(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Wl(n,r.document),s=r.readTime?Et(r.readTime):j.min(),a=ht.newNoDocument(i,s),u=r.removedTargetIds||[];t=new br([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Wl(n,r.document),s=r.removedTargetIds||[];t=new br([],s,i,null)}else{if(!("filter"in e))return U();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Dh(i,s),u=r.targetId;t=new va(u,a)}}return t}function ZD(n,e){let t;if(e instanceof jn)t={update:wy(n,e.key,e.value)};else if(e instanceof us)t={delete:Nh(n,e.key)};else if(e instanceof Dt)t={update:wy(n,e.key,e.data),updateMask:uS(e.fieldMask)};else{if(!(e instanceof Ih))return U();t={verify:Nh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let u=a.transform;if(u instanceof Lr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Bn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof $n)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Vr)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw U()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:YD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:U()}(n,e.precondition)),t}function eS(n,e){return n&&n.length>0?(se(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?Et(i.updateTime):Et(s);return a.isEqual(j.min())&&(a=Et(s)),new wh(a,i.transformResults||[])}(t,e))):[]}function tS(n,e){return{documents:[i_(n,e.path)]}}function nS(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=i_(n,i);let s=function(d){if(d.length!==0)return a_(At.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(I){return{field:Tr(I.field),direction:sS(I.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=Rh(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function rS(n){let e=JD(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){se(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){let I=o_(m);return I instanceof At&&Vy(I)?I.getFilters():[I]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(I=>function(R){return new Mr(Ar(R.field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(I))}(t.orderBy));let u=null;t.limit&&(u=function(m){let I;return I=typeof m=="object"?m.value:m,Ba(I)?null:I}(t.limit));let c=null;t.startAt&&(c=function(m){let I=!!m.before,b=m.values||[];return new Or(b,I)}(t.startAt));let d=null;return t.endAt&&(d=function(m){let I=!m.before,b=m.values||[];return new Or(b,I)}(t.endAt)),CD(e,i,a,s,u,"F",c,d)}function iS(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return U()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function o_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Ar(t.unaryFilter.field);return Ee.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ar(t.unaryFilter.field);return Ee.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ar(t.unaryFilter.field);return Ee.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Ar(t.unaryFilter.field);return Ee.create(a,"!=",{nullValue:"NULL_VALUE"});default:return U()}}(n):n.fieldFilter!==void 0?function(t){return Ee.create(Ar(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return U()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return At.create(t.compositeFilter.filters.map(r=>o_(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return U()}}(t.compositeFilter.op))}(n):U()}function sS(n){return WD[n]}function oS(n){return KD[n]}function aS(n){return QD[n]}function Tr(n){return{fieldPath:n.canonicalString()}}function Ar(n){return Ye.fromServerFormat(n.fieldPath)}function a_(n){return n instanceof Ee?function(t){if(t.op==="=="){if(oy(t.value))return{unaryFilter:{field:Tr(t.field),op:"IS_NAN"}};if(sy(t.value))return{unaryFilter:{field:Tr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(oy(t.value))return{unaryFilter:{field:Tr(t.field),op:"IS_NOT_NAN"}};if(sy(t.value))return{unaryFilter:{field:Tr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Tr(t.field),op:oS(t.op),value:t.value}}}(n):n instanceof At?function(t){let r=t.getFilters().map(i=>a_(i));return r.length===1?r[0]:{compositeFilter:{op:aS(t.op),filters:r}}}(n):U()}function uS(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function u_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var ls=class n{constructor(e,t,r,i,s=j.min(),a=j.min(),u=Ve.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Oh=class{constructor(e){this.ct=e}};function cS(n){let e=rS({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?vh(e,e.limit,"L"):e}var Ta=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(de(e.integerValue));else if("doubleValue"in e){let r=de(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),ss(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Gt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(fn(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?xy(e)?this.dt(t,Number.MAX_SAFE_INTEGER):My(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):U()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(de(u)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),L.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Ta.vt=new Ta;var Mh=class{constructor(){this.un=new xh}addToCollectionParentIndex(e,t){return this.un.add(t),N.resolve()}getCollectionParents(e,t){return N.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return N.resolve()}deleteFieldIndex(e,t){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,t){return N.resolve()}getDocumentsMatchingTarget(e,t){return N.resolve(null)}getIndexType(e,t){return N.resolve(0)}getFieldIndexes(e,t){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,t){return N.resolve(Vn.min())}getMinOffsetFromCollectionGroup(e,t){return N.resolve(Vn.min())}updateCollectionGroup(e,t,r){return N.resolve()}updateIndexEntries(e,t){return N.resolve()}},xh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Le(ge.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Le(ge.comparator)).toArray()}};var iN=new Uint8Array(0);var _t=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};_t.DEFAULT_COLLECTION_PERCENTILE=10,_t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_t.DEFAULT=new _t(41943040,_t.DEFAULT_COLLECTION_PERCENTILE,_t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_t.DISABLED=new _t(-1,0,0);var hs=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Fh=class{constructor(){this.changes=new pn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?N.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Lh=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Vh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&is(r.mutation,i,it.empty(),Ne.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Q()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Q()){let i=xn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=es();return s.forEach((u,c)=>{a=a.insert(u,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=xn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Q()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=Ht(),a=rs(),u=function(){return rs()}();return t.forEach((c,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Dt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),is(p.mutation,d,p.mutation.getFieldMask(),Ne.now())):a.set(d.key,it.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var m;return u.set(d,new Lh(p,(m=a.get(d))!==null&&m!==void 0?m:null))}),u))}recalculateAndSaveOverlays(e,t){let r=rs(),i=new me((a,u)=>a-u),s=Q();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(c=>{let d=t.get(c);if(d===null)return;let p=r.get(c)||it.empty();p=u.applyToLocalView(d,p),r.set(c,p);let m=(i.get(u.batchId)||Q()).add(c);i=i.insert(u.batchId,m)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let c=u.getNext(),d=c.key,p=c.value,m=Wy();p.forEach(I=>{if(!s.has(I)){let b=Zy(t.get(I),r.get(I));b!==null&&m.set(I,b),s=s.add(I)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return N.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):RD(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):N.resolve(xn()),u=-1,c=s;return a.next(d=>N.forEach(d,(p,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),s.get(p)?N.resolve():this.remoteDocumentCache.getEntry(e,p).next(I=>{c=c.insert(p,I)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,Q())).next(p=>({batchId:u,changes:Hy(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=es();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=es();return this.indexManager.getCollectionParents(e,s).next(u=>N.forEach(u,c=>{let d=function(m,I){return new xr(I,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((m,I)=>{a=a.insert(m,I)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((c,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,ht.newInvalidDocument(p)))});let u=es();return a.forEach((c,d)=>{let p=s.get(c);p!==void 0&&is(p.mutation,d,it.empty(),Ne.now()),ja(t,d)&&(u=u.insert(c,d))}),u})}};var Uh=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return N.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Et(i.createTime)}}(t)),N.resolve()}getNamedQuery(e,t){return N.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:cS(i.bundledQuery),readTime:Et(i.readTime)}}(t)),N.resolve()}};var Bh=class{constructor(){this.overlays=new me(L.comparator),this.Ir=new Map}getOverlay(e,t){return N.resolve(this.overlays.get(t))}getOverlays(e,t){let r=xn();return N.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),N.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),N.resolve()}getOverlaysForCollection(e,t,r){let i=xn(),s=t.length+1,a=new L(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let c=u.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return N.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new me((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=xn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=xn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return N.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Ah(t,r));let s=this.Ir.get(t);s===void 0&&(s=Q(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var $h=class{constructor(){this.sessionToken=Ve.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,N.resolve()}};var ds=class{constructor(){this.Tr=new Le(Ie.Er),this.dr=new Le(Ie.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new Ie(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Ie(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new L(new ge([])),r=new Ie(t,e),i=new Ie(t,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new L(new ge([])),r=new Ie(t,e),i=new Ie(t,e+1),s=Q();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new Ie(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ie=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return L.comparator(e.key,t.key)||Z(e.wr,t.wr)}static Ar(e,t){return Z(e.wr,t.wr)||L.comparator(e.key,t.key)}};var jh=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Le(Ie.Er)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Eh(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new Ie(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return N.resolve(a)}lookupMutationBatch(e,t){return N.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ie(t,0),i=new Ie(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);s.push(u)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Le(Z);return t.forEach(i=>{let s=new Ie(i,0),a=new Ie(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],u=>{r=r.add(u.wr)})}),N.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;L.isDocumentKey(s)||(s=s.child(""));let a=new Ie(new L(s),0),u=new Le(Z);return this.br.forEachWhile(c=>{let d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.wr)),!0)},a),N.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){se(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return N.forEach(t.mutations,i=>{let s=new Ie(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new Ie(t,0),i=this.br.firstAfterOrEqual(r);return N.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var zh=class{constructor(e){this.Mr=e,this.docs=function(){return new me(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return N.resolve(r?r.document.mutableCopy():ht.newInvalidDocument(t))}getEntries(e,t){let r=Ht();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ht.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ht(),a=t.path,u=new L(a.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){let{key:d,value:{document:p}}=c.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||yD(mD(p),r)<=0||(i.has(p.key)||ja(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,t,r,i){U()}Or(e,t){return N.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new qh(this)}getSize(e){return N.resolve(this.size)}},qh=class extends Fh{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),N.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Gh=class{constructor(e){this.persistence=e,this.Nr=new pn(t=>Md(t),xd),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ds,this.targetCount=0,this.kr=hs.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),N.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new hs(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,N.resolve()}updateTargetData(e,t){return this.Kn(t),N.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return N.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),N.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),N.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return N.resolve(r)}containsKey(e,t){return N.resolve(this.Br.containsKey(t))}};var Hh=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new ky(0),this.Kr=!1,this.Kr=!0,this.$r=new $h,this.referenceDelegate=e(this),this.Ur=new Gh(this),this.indexManager=new Mh,this.remoteDocumentCache=function(i){return new zh(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Oh(t),this.Gr=new Uh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Bh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new jh(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){M("MemoryPersistence","Starting transaction:",e);let i=new Wh(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return N.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Wh=class extends sh{constructor(e){super(),this.currentSequenceNumber=e}},Kh=class n{constructor(e){this.persistence=e,this.Jr=new ds,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw U()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),N.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),N.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Xr,r=>{let i=L.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,j.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return N.or([()=>N.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Qh=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Q(),i=Q();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Yh=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Jh=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return ag()?8:vD(De())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Yh;return this.Xi(e,t,a).next(u=>{if(s.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Zi()<=K.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",Er(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),N.resolve()):(Zi()<=K.DEBUG&&M("QueryEngine","Query:",Er(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Zi()<=K.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",Er(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,It(t))):N.resolve())}Yi(e,t){if(ly(t))return N.resolve(null);let r=It(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=vh(t,null,"F"),r=It(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=Q(...s);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{let d=this.ts(t,u);return this.ns(t,d,a,c.readTime)?this.Yi(e,vh(t,null,"F")):this.rs(e,d,t,c)}))})))}Zi(e,t,r,i){return ly(t)||i.isEqual(j.min())?N.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let a=this.ts(t,s);return this.ns(t,a,r,i)?N.resolve(null):(Zi()<=K.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Er(t)),this.rs(e,a,t,gD(i,-1)).next(u=>u))})}ts(e,t){let r=new Le(qy(e));return t.forEach((i,s)=>{ja(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Zi()<=K.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",Er(t)),this.Ji.getDocumentsMatchingQuery(e,t,Vn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Xh=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new me(Z),this._s=new pn(s=>Md(s),xd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vh(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function lS(n,e,t,r){return new Xh(n,e,t,r)}function c_(n,e){return v(this,null,function*(){let t=$(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],c=Q();for(let d of i){a.push(d.batchId);for(let p of d.mutations)c=c.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function hS(n,e){let t=$(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,d,p){let m=d.batch,I=m.keys(),b=N.resolve();return I.forEach(R=>{b=b.next(()=>p.getEntry(c,R)).next(O=>{let P=d.docVersions.get(R);se(P!==null),O.version.compareTo(P)<0&&(m.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))})}),b.next(()=>u.mutationQueue.removeMutationBatch(c,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=Q();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function l_(n){let e=$(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function dS(n,e){let t=$(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,m)=>{let I=i.get(m);if(!I)return;u.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,m)));let b=I.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?b=b.withResumeToken(Ve.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,r)),i=i.insert(m,b),function(O,P,z){return O.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(I,b,p)&&u.push(t.Ur.updateTargetData(s,b))});let c=Ht(),d=Q();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(fS(s,a,e.documentUpdates).next(p=>{c=p.Ps,d=p.Is})),!r.isEqual(j.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(m=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return N.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.os=i,s))}function fS(n,e,t){let r=Q(),i=Q();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Ht();return t.forEach((u,c)=>{let d=s.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(j.min())?(e.removeEntry(u,c.readTime),a=a.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),a=a.insert(u,c)):M("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ps:a,Is:i}})}function pS(n,e){let t=$(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gS(n,e){let t=$(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new ls(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Zh(n,e,t){return v(this,null,function*(){let r=$(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!_s(a))throw a;M("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Iy(n,e,t){let r=$(n),i=j.min(),s=Q();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,d,p){let m=$(c),I=m._s.get(p);return I!==void 0?N.resolve(m.os.get(I)):m.Ur.getTargetData(d,p)}(r,a,It(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:j.min(),t?s:Q())).next(u=>(mS(r,ND(e),u),{documents:u,Ts:s})))}function mS(n,e,t){let r=n.us.get(e)||j.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var Aa=class{constructor(){this.activeTargetIds=LD()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ed=class{constructor(){this.so=new Aa,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Aa,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var td=class{_o(e){}shutdown(){}};var Da=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var ua=null;function Kl(){return ua===null?ua=function(){return 268435456+Math.round(2147483648*Math.random())}():ua++,"0x"+ua.toString(16)}var yS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var nd=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Fe="WebChannelConnection",rd=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,a){let u=Kl(),c=this.xo(t,r.toUriEncodedString());M("RestConnection",`Sending RPC '${t}' ${u}:`,c,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,c,d,i).then(p=>(M("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw Rr("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(t,r,i,s,a,u){return this.Mo(t,r,i,s,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+zr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,r){let i=yS[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=Kl();return new Promise((a,u)=>{let c=new jl;c.setWithCredentials(!0),c.listenOnce(zl.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Xi.NO_ERROR:let p=c.getResponseJson();M(Fe,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case Xi.TIMEOUT:M(Fe,`RPC '${e}' ${s} timed out`),u(new x(C.DEADLINE_EXCEEDED,"Request time out"));break;case Xi.HTTP_ERROR:let m=c.getStatus();if(M(Fe,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let I=c.getResponseJson();Array.isArray(I)&&(I=I[0]);let b=I?.error;if(b&&b.status&&b.message){let R=function(P){let z=P.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(z)>=0?z:C.UNKNOWN}(b.status);u(new x(R,b.message))}else u(new x(C.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new x(C.UNAVAILABLE,"Connection failed."));break;default:U()}}finally{M(Fe,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);M(Fe,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=Kl(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Hl(),u=Gl(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let p=s.join("");M(Fe,`Creating RPC '${e}' stream ${i}: ${p}`,c);let m=a.createWebChannel(p,c),I=!1,b=!1,R=new nd({Io:P=>{b?M(Fe,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(I||(M(Fe,`Opening RPC '${e}' stream ${i} transport.`),m.open(),I=!0),M(Fe,`RPC '${e}' stream ${i} sending:`,P),m.send(P))},To:()=>m.close()}),O=(P,z,W)=>{P.listen(z,H=>{try{W(H)}catch(le){setTimeout(()=>{throw le},0)}})};return O(m,Ir.EventType.OPEN,()=>{b||(M(Fe,`RPC '${e}' stream ${i} transport opened.`),R.yo())}),O(m,Ir.EventType.CLOSE,()=>{b||(b=!0,M(Fe,`RPC '${e}' stream ${i} transport closed`),R.So())}),O(m,Ir.EventType.ERROR,P=>{b||(b=!0,Rr(Fe,`RPC '${e}' stream ${i} transport errored:`,P),R.So(new x(C.UNAVAILABLE,"The operation could not be completed")))}),O(m,Ir.EventType.MESSAGE,P=>{var z;if(!b){let W=P.data[0];se(!!W);let H=W,le=H.error||((z=H[0])===null||z===void 0?void 0:z.error);if(le){M(Fe,`RPC '${e}' stream ${i} received error:`,le);let Ue=le.status,re=function(_){let w=we[_];if(w!==void 0)return t_(w)}(Ue),E=le.message;re===void 0&&(re=C.INTERNAL,E="Unknown error status: "+Ue+" with message "+le.message),b=!0,R.So(new x(re,E)),m.close()}else M(Fe,`RPC '${e}' stream ${i} received:`,W),R.bo(W)}}),O(u,ql.STAT_EVENT,P=>{P.stat===oa.PROXY?M(Fe,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===oa.NOPROXY&&M(Fe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}};function Ql(){return typeof document<"u"?document:null}function za(n){return new Ch(n,!0)}var Sa=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&M("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var ba=class{constructor(e,t,r,i,s,a,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Sa(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return v(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return v(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return v(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(qt(t.toString()),qt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new x(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>v(this,null,function*(){this.state=0,this.start()}))}I_(e){return M("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},id=class extends ba{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=XD(this.serializer,e),r=function(s){if(!("targetChange"in s))return j.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?Et(a.readTime):j.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=kh(this.serializer),t.addTarget=function(s,a){let u,c=a.target;if(u=_h(c)?{documents:tS(s,c)}:{query:nS(s,c)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=n_(s,a.resumeToken);let d=Rh(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(j.min())>0){u.readTime=Ea(s,a.snapshotVersion.toTimestamp());let d=Rh(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=iS(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=kh(this.serializer),t.removeTarget=e,this.a_(t)}},sd=class extends ba{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return se(!!e.streamToken),this.lastStreamToken=e.streamToken,se(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=eS(e.writeResults,e.commitTime),r=Et(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=kh(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>ZD(this.serializer,r))};this.a_(t)}};var od=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Ph(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(C.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,Ph(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(C.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},ad=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(qt(t),this.D_=!1):M("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var ud=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(()=>v(this,null,function*(){Hn(this)&&(M("RemoteStore","Restarting streams for network reachability change."),yield function(c){return v(this,null,function*(){let d=$(c);d.L_.add(4),yield vs(d),d.q_.set("Unknown"),d.L_.delete(4),yield qa(d)})}(this))}))}),this.q_=new ad(r,i)}};function qa(n){return v(this,null,function*(){if(Hn(n))for(let e of n.B_)yield e(!0)})}function vs(n){return v(this,null,function*(){for(let e of n.B_)yield e(!1)})}function h_(n,e){let t=$(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),$d(t)?Bd(t):qr(t).r_()&&Ud(t,e))}function Vd(n,e){let t=$(n),r=qr(t);t.N_.delete(e),r.r_()&&d_(t,e),t.N_.size===0&&(r.r_()?r.o_():Hn(t)&&t.q_.set("Unknown"))}function Ud(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}qr(n).A_(e)}function d_(n,e){n.Q_.xe(e),qr(n).R_(e)}function Bd(n){n.Q_=new bh({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),qr(n).start(),n.q_.v_()}function $d(n){return Hn(n)&&!qr(n).n_()&&n.N_.size>0}function Hn(n){return $(n).L_.size===0}function f_(n){n.Q_=void 0}function _S(n){return v(this,null,function*(){n.q_.set("Online")})}function vS(n){return v(this,null,function*(){n.N_.forEach((e,t)=>{Ud(n,e)})})}function wS(n,e){return v(this,null,function*(){f_(n),$d(n)?(n.q_.M_(e),Bd(n)):n.q_.set("Unknown")})}function IS(n,e,t){return v(this,null,function*(){if(n.q_.set("Online"),e instanceof wa&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let a=s.cause;for(let u of s.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){M("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ca(n,r)}else if(e instanceof br?n.Q_.Ke(e):e instanceof va?n.Q_.He(e):n.Q_.We(e),!t.isEqual(j.min()))try{let r=yield l_(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let u=s.Q_.rt(a);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(c.resumeToken,a))}}),u.targetMismatches.forEach((c,d)=>{let p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Ve.EMPTY_BYTE_STRING,p.snapshotVersion)),d_(s,c);let m=new ls(p.target,c,d,p.sequenceNumber);Ud(s,m)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){M("RemoteStore","Failed to raise snapshot:",r),yield Ca(n,r)}})}function Ca(n,e,t){return v(this,null,function*(){if(!_s(e))throw e;n.L_.add(1),yield vs(n),n.q_.set("Offline"),t||(t=()=>l_(n.localStore)),n.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){M("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield qa(n)}))})}function p_(n,e){return e().catch(t=>Ca(n,t,e))}function Ga(n){return v(this,null,function*(){let e=$(n),t=gn(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;ES(e);)try{let i=yield pS(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,TS(e,i)}catch(i){yield Ca(e,i)}g_(e)&&m_(e)})}function ES(n){return Hn(n)&&n.O_.length<10}function TS(n,e){n.O_.push(e);let t=gn(n);t.r_()&&t.V_&&t.m_(e.mutations)}function g_(n){return Hn(n)&&!gn(n).n_()&&n.O_.length>0}function m_(n){gn(n).start()}function AS(n){return v(this,null,function*(){gn(n).p_()})}function DS(n){return v(this,null,function*(){let e=gn(n);for(let t of n.O_)e.m_(t.mutations)})}function SS(n,e,t){return v(this,null,function*(){let r=n.O_.shift(),i=Th.from(r,e,t);yield p_(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Ga(n)})}function bS(n,e){return v(this,null,function*(){e&&gn(n).V_&&(yield function(r,i){return v(this,null,function*(){if(function(a){return qD(a)&&a!==C.ABORTED}(i.code)){let s=r.O_.shift();gn(r).s_(),yield p_(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Ga(r)}})}(n,e)),g_(n)&&m_(n)})}function Ey(n,e){return v(this,null,function*(){let t=$(n);t.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");let r=Hn(t);t.L_.add(3),yield vs(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield qa(t)})}function CS(n,e){return v(this,null,function*(){let t=$(n);e?(t.L_.delete(2),yield qa(t)):e||(t.L_.add(2),yield vs(t),t.q_.set("Unknown"))})}function qr(n){return n.K_||(n.K_=function(t,r,i){let s=$(t);return s.w_(),new id(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:_S.bind(null,n),Ro:vS.bind(null,n),mo:wS.bind(null,n),d_:IS.bind(null,n)}),n.B_.push(e=>v(this,null,function*(){e?(n.K_.s_(),$d(n)?Bd(n):n.q_.set("Unknown")):(yield n.K_.stop(),f_(n))}))),n.K_}function gn(n){return n.U_||(n.U_=function(t,r,i){let s=$(t);return s.w_(),new sd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:AS.bind(null,n),mo:bS.bind(null,n),f_:DS.bind(null,n),g_:SS.bind(null,n)}),n.B_.push(e=>v(this,null,function*(){e?(n.U_.s_(),yield Ga(n)):(yield n.U_.stop(),n.O_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var cd=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new vt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function jd(n,e){if(qt("AsyncQueue",`${e}: ${n}`),_s(n))return new x(C.UNAVAILABLE,`${e}: ${n}`);throw n}var Ra=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=es(),this.sortedSet=new me(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Pa=class{constructor(){this.W_=new me(L.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):U():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Br=class n{constructor(e,t,r,i,s,a,u,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,Ra.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$a(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ld=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},hd=class{constructor(){this.queries=Ty(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=$(t),s=i.queries;i.queries=Ty(),s.forEach((a,u)=>{for(let c of u.j_)c.onError(r)})})(this,new x(C.ABORTED,"Firestore shutting down"))}};function Ty(){return new pn(n=>zy(n),$a)}function RS(n,e){return v(this,null,function*(){let t=$(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new ld,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=jd(a,`Initialization of query '${Er(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&zd(t)})}function PS(n,e){return v(this,null,function*(){let t=$(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function NS(n,e){let t=$(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&zd(t)}function kS(n,e,t){let r=$(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function zd(n){n.Y_.forEach(e=>{e.next()})}var dd,Ay;(Ay=dd||(dd={})).ea="default",Ay.Cache="cache";var fd=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Br(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Br.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==dd.Cache}};var Na=class{constructor(e){this.key=e}},ka=class{constructor(e){this.key=e}},pd=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Q(),this.mutatedKeys=Q(),this.Aa=qy(e),this.Ra=new Ra(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Pa,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{let I=i.get(p),b=ja(this.query,m)?m:null,R=!!I&&this.mutatedKeys.has(I.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations),P=!1;I&&b?I.data.isEqual(b.data)?R!==O&&(r.track({type:3,doc:b}),P=!0):this.ga(I,b)||(r.track({type:2,doc:b}),P=!0,(c&&this.Aa(b,c)>0||d&&this.Aa(b,d)<0)&&(u=!0)):!I&&b?(r.track({type:0,doc:b}),P=!0):I&&!b&&(r.track({type:1,doc:I}),P=!0,(c||d)&&(u=!0)),P&&(b?(a=a.add(b),s=O?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,m)=>function(b,R){let O=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return U()}};return O(b)-O(R)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,a.length!==0||d?{snapshot:new Br(this.query,e.Ra,s,a,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Pa,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=Q(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new ka(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Na(r))}),t}ba(e){this.Ta=e.Ts,this.da=Q();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Br.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},gd=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},md=class{constructor(e){this.key=e,this.va=!1}},yd=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new pn(u=>zy(u),$a),this.Ma=new Map,this.xa=new Set,this.Oa=new me(L.comparator),this.Na=new Map,this.La=new ds,this.Ba={},this.ka=new Map,this.qa=hs.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function OS(n,e,t=!0){return v(this,null,function*(){let r=E_(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield y_(r,e,t,!0),i})}function MS(n,e){return v(this,null,function*(){let t=E_(n);yield y_(t,e,!0,!1)})}function y_(n,e,t,r){return v(this,null,function*(){let i=yield gS(n.localStore,It(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=yield xS(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&h_(n.remoteStore,i),u})}function xS(n,e,t,r,i){return v(this,null,function*(){n.Ka=(m,I,b)=>function(O,P,z,W){return v(this,null,function*(){let H=P.view.ma(z);H.ns&&(H=yield Iy(O.localStore,P.query,!1).then(({documents:E})=>P.view.ma(E,H)));let le=W&&W.targetChanges.get(P.targetId),Ue=W&&W.targetMismatches.get(P.targetId)!=null,re=P.view.applyChanges(H,O.isPrimaryClient,le,Ue);return Sy(O,P.targetId,re.wa),re.snapshot})}(n,m,I,b);let s=yield Iy(n.localStore,e,!0),a=new pd(e,s.Ts),u=a.ma(s.documents),c=cs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,c);Sy(n,t,d.wa);let p=new gd(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function FS(n,e,t){return v(this,null,function*(){let r=$(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!$a(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Zh(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Vd(r.remoteStore,i.targetId),_d(r,i.targetId)}).catch(ys))):(_d(r,i.targetId),yield Zh(r.localStore,i.targetId,!0))})}function LS(n,e){return v(this,null,function*(){let t=$(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Vd(t.remoteStore,r.targetId))})}function VS(n,e,t){return v(this,null,function*(){let r=GS(n);try{let i=yield function(a,u){let c=$(a),d=Ne.now(),p=u.reduce((b,R)=>b.add(R.key),Q()),m,I;return c.persistence.runTransaction("Locally write mutations","readwrite",b=>{let R=Ht(),O=Q();return c.cs.getEntries(b,p).next(P=>{R=P,R.forEach((z,W)=>{W.isValidDocument()||(O=O.add(z))})}).next(()=>c.localDocuments.getOverlayedDocuments(b,R)).next(P=>{m=P;let z=[];for(let W of u){let H=zD(W,m.get(W.key).overlayedDocument);H!=null&&z.push(new Dt(W.key,H,Fy(H.value.mapValue),zt.exists(!0)))}return c.mutationQueue.addMutationBatch(b,d,z,u)}).next(P=>{I=P;let z=P.applyToLocalDocumentSet(m,O);return c.documentOverlayCache.saveOverlays(b,P.batchId,z)})}).then(()=>({batchId:I.batchId,changes:Hy(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,c){let d=a.Ba[a.currentUser.toKey()];d||(d=new me(Z)),d=d.insert(u,c),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield ws(r,i.changes),yield Ga(r.remoteStore)}catch(i){let s=jd(i,"Failed to persist write");t.reject(s)}})}function __(n,e){return v(this,null,function*(){let t=$(n);try{let r=yield dS(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Na.get(s);a&&(se(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?se(a.va):i.removedDocuments.size>0&&(se(a.va),a.va=!1))}),yield ws(t,r,e)}catch(r){yield ys(r)}})}function Dy(n,e,t){let r=$(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let c=$(a);c.onlineState=u;let d=!1;c.queries.forEach((p,m)=>{for(let I of m.j_)I.Z_(u)&&(d=!0)}),d&&zd(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function US(n,e,t){return v(this,null,function*(){let r=$(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let a=new me(L.comparator);a=a.insert(s,ht.newNoDocument(s,j.min()));let u=Q().add(s),c=new _a(j.min(),new Map,new me(Z),a,u);yield __(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),qd(r)}else yield Zh(r.localStore,e,!1).then(()=>_d(r,e,t)).catch(ys)})}function BS(n,e){return v(this,null,function*(){let t=$(n),r=e.batch.batchId;try{let i=yield hS(t.localStore,e);w_(t,r,null),v_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield ws(t,i)}catch(i){yield ys(i)}})}function $S(n,e,t){return v(this,null,function*(){let r=$(n);try{let i=yield function(a,u){let c=$(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return c.mutationQueue.lookupMutationBatch(d,u).next(m=>(se(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>c.localDocuments.getDocuments(d,p))})}(r.localStore,e);w_(r,e,t),v_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield ws(r,i)}catch(i){yield ys(i)}})}function v_(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function w_(n,e,t){let r=$(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function _d(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||I_(n,r)})}function I_(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Vd(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),qd(n))}function Sy(n,e,t){for(let r of t)r instanceof Na?(n.La.addReference(r.key,e),jS(n,r)):r instanceof ka?(M("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||I_(n,r.key)):U()}function jS(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(M("SyncEngine","New document in limbo: "+t),n.xa.add(r),qd(n))}function qd(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new L(ge.fromString(e)),r=n.qa.next();n.Na.set(r,new md(t)),n.Oa=n.Oa.insert(t,r),h_(n.remoteStore,new ls(It(jy(t.path)),r,"TargetPurposeLimboResolution",ky.oe))}}function ws(n,e,t){return v(this,null,function*(){let r=$(n),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{a.push(r.Ka(c,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let m=d?!d.fromCache:(p=t?.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){i.push(d);let m=Qh.Wi(c.targetId,d);s.push(m)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(c,d){return v(this,null,function*(){let p=$(c);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>N.forEach(d,I=>N.forEach(I.$i,b=>p.persistence.referenceDelegate.addReference(m,I.targetId,b)).next(()=>N.forEach(I.Ui,b=>p.persistence.referenceDelegate.removeReference(m,I.targetId,b)))))}catch(m){if(!_s(m))throw m;M("LocalStore","Failed to update sequence numbers: "+m)}for(let m of d){let I=m.targetId;if(!m.fromCache){let b=p.os.get(I),R=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(R);p.os=p.os.insert(I,O)}}})}(r.localStore,s))})}function zS(n,e){return v(this,null,function*(){let t=$(n);if(!t.currentUser.isEqual(e)){M("SyncEngine","User change. New user:",e.toKey());let r=yield c_(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(u=>{u.forEach(c=>{c.reject(new x(C.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ws(t,r.hs)}})}function qS(n,e){let t=$(n),r=t.Na.get(e);if(r&&r.va)return Q().add(r.key);{let i=Q(),s=t.Ma.get(e);if(!s)return i;for(let a of s){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function E_(n){let e=$(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=__.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qS.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=US.bind(null,e),e.Ca.d_=NS.bind(null,e.eventManager),e.Ca.$a=kS.bind(null,e.eventManager),e}function GS(n){let e=$(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=BS.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$S.bind(null,e),e}var by=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return v(this,null,function*(){this.serializer=za(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return lS(this.persistence,new Jh,t.initialUser,this.serializer)}Ga(t){return new Hh(Kh.Zr,this.serializer)}Wa(t){return new ed}terminate(){return v(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var HS=(()=>{class n{initialize(t,r){return v(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Dy(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=zS.bind(null,this.syncEngine),yield CS(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new hd}()}createDatastore(t){let r=za(t.databaseInfo.databaseId),i=function(a){return new rd(a)}(t.databaseInfo);return function(a,u,c,d){return new od(a,u,c,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,u,c){return new ud(i,s,a,u,c)}(this.localStore,this.datastore,t.asyncQueue,r=>Dy(this.syncEngine,r,0),function(){return Da.D()?new Da:new td}())}createSyncEngine(t,r){return function(s,a,u,c,d,p,m){let I=new yd(s,a,u,c,d,p);return m&&(I.Qa=!0),I}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return v(this,null,function*(){var t,r;yield function(s){return v(this,null,function*(){let a=$(s);M("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield vs(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var vd=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):qt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var wd=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=be.UNAUTHENTICATED,this.clientId=da.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>v(this,null,function*(){M("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(M("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new vt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=jd(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Yl(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield c_(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Cy(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield WS(n);M("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Ey(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Ey(e.remoteStore,i)),n._onlineComponents=e})}function WS(n){return v(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Yl(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===C.FAILED_PRECONDITION||i.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Rr("Error using user provided cache. Falling back to memory cache: "+t),yield Yl(n,new by)}}else M("FirestoreClient","Using default OfflineComponentProvider"),yield Yl(n,new by);return n._offlineComponents})}function T_(n){return v(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),yield Cy(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),yield Cy(n,new HS))),n._onlineComponents})}function KS(n){return T_(n).then(e=>e.syncEngine)}function QS(n){return v(this,null,function*(){let e=yield T_(n),t=e.eventManager;return t.onListen=OS.bind(null,e.syncEngine),t.onUnlisten=FS.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=MS.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=LS.bind(null,e.syncEngine),t})}function YS(n,e,t={}){let r=new vt;return n.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,a,u,c,d){let p=new vd({next:I=>{p.Za(),a.enqueueAndForget(()=>PS(s,m)),I.fromCache&&c.source==="server"?d.reject(new x(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(I)},error:I=>d.reject(I)}),m=new fd(u,p,{includeMetadataChanges:!0,_a:!0});return RS(s,m)}(yield QS(n),n.asyncQueue,e,t,r)})),r.promise}function A_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Ry=new Map;function D_(n,e,t){if(!t)throw new x(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function JS(n,e,t,r){if(e===!0&&r===!0)throw new x(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Py(n){if(!L.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ny(n){if(L.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Gd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":U()}function zn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Gd(n);throw new x(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Oa=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new x(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=A_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},$r=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Oa({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Oa(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Jl;switch(r.type){case"firstParty":return new th(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return v(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Ry.get(t);r&&(M("ComponentProvider","Removing Datastore"),Ry.delete(t),r.terminate())}(this),Promise.resolve()}};function XS(n,e,t,r={}){var i;let s=(n=zn(n,$r))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Rr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=be.MOCK_USER;else{u=tg(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new x(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new be(d)}n._authCredentials=new Xl(new ha(u,c))}}var Ma=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},st=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},dn=class n extends Ma{constructor(e,t,r){super(e,t,jy(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new st(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Hd(n,e,...t){if(n=Se(n),D_("collection","path",e),n instanceof $r){let r=ge.fromString(e,...t);return Ny(r),new dn(n,null,r)}{if(!(n instanceof st||n instanceof dn))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ge.fromString(e,...t));return Ny(r),new dn(n.firestore,null,r)}}function Ha(n,e,...t){if(n=Se(n),arguments.length===1&&(e=da.newId()),D_("doc","path",e),n instanceof $r){let r=ge.fromString(e,...t);return Py(r),new st(n,null,new L(r))}{if(!(n instanceof st||n instanceof dn))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ge.fromString(e,...t));return Py(r),new st(n.firestore,n instanceof dn?n.converter:null,new L(r))}}var xa=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Sa(this,"async_queue_retry"),this.Vu=()=>{let r=Ql();r&&M("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=Ql();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Ql();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new vt;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return v(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!_s(e))throw e;M("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw qt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=cd.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&U()}verifyOperationInProgress(){}wu(){return v(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};var qn=class extends $r{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new xa,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return v(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new xa(e),this._firestoreClient=void 0,yield e}})}};function S_(n,e){let t=typeof n=="object"?n:or(),r=typeof n=="string"?n:e||"(default)",i=Ii(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=eg("firestore");s&&XS(i,...s)}return i}function b_(n){if(n._terminated)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ZS(n),n._firestoreClient}function ZS(n){var e,t,r;let i=n._freezeSettings(),s=function(u,c,d,p){return new oh(u,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,A_(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new wd(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){let c=u?._online.build();return{_offline:u?._offline.build(c),_online:c}}(n._componentsProvider))}var fs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Ve.fromBase64String(e))}catch(t){throw new x(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Ve.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var jr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ye(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ps=class{constructor(e){this._methodName=e}};var gs=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}};var ms=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var eb=/^__.*__$/,Id=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Dt(e,this.data,this.fieldMask,t,this.fieldTransforms):new jn(e,this.data,t,this.fieldTransforms)}},Fa=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Dt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function C_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw U()}}var Ed=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Va(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(C_(this.Cu)&&eb.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Td=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||za(e)}Qu(e,t,r,i=!1){return new Ed({Cu:e,methodName:t,qu:r,path:Ye.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function R_(n){let e=n._freezeSettings(),t=za(n._databaseId);return new Td(n._databaseId,!!e.ignoreUndefinedProperties,t)}function tb(n,e,t,r,i,s={}){let a=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);Wd("Data must be an object, but it was:",a,r);let u=P_(r,a),c,d;if(s.merge)c=new it(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let m of s.mergeFields){let I=Ad(e,m,t);if(!a.contains(I))throw new x(C.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);k_(p,I)||p.push(I)}c=new it(p),d=a.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=a.fieldTransforms;return new Id(new Qe(u),c,d)}var La=class n extends ps{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function nb(n,e,t,r){let i=n.Qu(1,e,t);Wd("Data must be an object, but it was:",i,r);let s=[],a=Qe.empty();Gn(r,(c,d)=>{let p=Kd(e,c,t);d=Se(d);let m=i.Nu(p);if(d instanceof La)s.push(p);else{let I=Wa(d,m);I!=null&&(s.push(p),a.set(p,I))}});let u=new it(s);return new Fa(a,u,i.fieldTransforms)}function rb(n,e,t,r,i,s){let a=n.Qu(1,e,t),u=[Ad(e,r,t)],c=[i];if(s.length%2!=0)throw new x(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<s.length;I+=2)u.push(Ad(e,s[I])),c.push(s[I+1]);let d=[],p=Qe.empty();for(let I=u.length-1;I>=0;--I)if(!k_(d,u[I])){let b=u[I],R=c[I];R=Se(R);let O=a.Nu(b);if(R instanceof La)d.push(b);else{let P=Wa(R,O);P!=null&&(d.push(b),p.set(b,P))}}let m=new it(d);return new Fa(p,m,a.fieldTransforms)}function Wa(n,e){if(N_(n=Se(n)))return Wd("Unsupported field value:",e,n),P_(n,e);if(n instanceof ps)return function(r,i){if(!C_(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let u of r){let c=Wa(u,i.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Se(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VD(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ne.fromDate(r);return{timestampValue:Ea(i.serializer,s)}}if(r instanceof Ne){let s=new Ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ea(i.serializer,s)}}if(r instanceof gs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof fs)return{bytesValue:n_(i.serializer,r._byteString)};if(r instanceof st){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ld(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ms)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return Fd(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Gd(r)}`)}(n,e)}function P_(n,e){let t={};return Oy(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gn(n,(r,i)=>{let s=Wa(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function N_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ne||n instanceof gs||n instanceof fs||n instanceof st||n instanceof ps||n instanceof ms)}function Wd(n,e,t){if(!N_(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Gd(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Ad(n,e,t){if((e=Se(e))instanceof jr)return e._internalPath;if(typeof e=="string")return Kd(n,e);throw Va("Field path arguments must be of type string or ",n,!1,void 0,t)}var ib=new RegExp("[~\\*/\\[\\]]");function Kd(n,e,t){if(e.search(ib)>=0)throw Va(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new jr(...e.split("."))._internalPath}catch{throw Va(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Va(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${r}`),a&&(c+=` in document ${i}`),c+=")"),new x(C.INVALID_ARGUMENT,u+n+c)}function k_(n,e){return n.some(t=>t.isEqual(e))}var Ua=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new st(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Dd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(O_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Dd=class extends Ua{data(){return super.data()}};function O_(n,e){return typeof e=="string"?Kd(n,e):e instanceof jr?e._internalPath:e._delegate._internalPath}function sb(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Sd=class{convertValue(e,t="none"){switch(Un(e)){case 0:return null;case 1:return e.booleanValue;case 2:return de(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw U()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Gn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>de(a.doubleValue));return new ms(s)}convertGeoPoint(e){return new gs(de(e.latitude),de(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=kd(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(os(e));default:return null}}convertTimestamp(e){let t=Gt(e);return new Ne(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ge.fromString(e);se(u_(r));let i=new ma(r.get(1),r.get(3)),s=new L(r.popFirst(5));return i.isEqual(t)||qt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function ob(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Sr=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},bd=class extends Ua{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Cr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(O_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Cr=class extends bd{data(e={}){return super.data(e)}},Cd=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Sr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Cr(this._firestore,this._userDataWriter,r.key,r,new Sr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let c=new Cr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Sr(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let c=new Cr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Sr(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:ab(u.type),doc:c,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function ab(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return U()}}var Rd=class extends Sd{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new st(this.firestore,null,t)}};function M_(n){n=zn(n,Ma);let e=zn(n.firestore,qn),t=b_(e),r=new Rd(e);return sb(n._query),YS(t,n._query).then(i=>new Cd(e,r,n,i))}function x_(n,e,t,...r){n=zn(n,st);let i=zn(n.firestore,qn),s=R_(i),a;return a=typeof(e=Se(e))=="string"||e instanceof jr?rb(s,"updateDoc",n._key,e,t,r):nb(s,"updateDoc",n._key,e),Qd(i,[a.toMutation(n._key,zt.exists(!0))])}function F_(n){return Qd(zn(n.firestore,qn),[new us(n._key,zt.none())])}function L_(n,e){let t=zn(n.firestore,qn),r=Ha(n),i=ob(n.converter,e);return Qd(t,[tb(R_(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,zt.exists(!1))]).then(()=>r)}function Qd(n,e){return function(r,i){let s=new vt;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return VS(yield KS(r),i,s)})),s.promise}(b_(n),e)}(function(e,t=!0){(function(i){zr=i})(un),an(new nt("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new qn(new Zl(r.getProvider("auth-internal")),new rh(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new x(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ma(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),Re(ty,"4.7.3",e),Re(ty,"4.7.3","esm2017")})();var V_=class n{app=po(Xm);db=S_(this.app);auth=V(Ut);constructor(){}addTask(e){return v(this,null,function*(){let t=this.auth.currentUser;if(t){let r=Hd(this.db,`users/${t.uid}/checklists`);yield L_(r,F({},e))}else console.log("not login")})}getTasks(){let e=this.auth.currentUser?.uid;return new Xt(t=>{if(!e){t.error("User Not Ligged In");return}let r=Hd(this.db,`users/${e}/checklists`);M_(r).then(i=>{let s=i.docs.map(a=>{let u=a.data();return{id:a.id,date:u.date.toDate(),title:u.title,tasks:u.tasks}});t.next(s),t.complete()}).catch(i=>{t.error(i)})})}deleteTask(e){F_(Ha(this.db,`users/${this.auth.currentUser?.uid}/checklists/${e}`))}updateTask(e,t){let r=Ha(this.db,`users/${this.auth.currentUser?.uid}/checklists/${e}`);x_(r,F({},t))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Y({token:n,factory:n.\u0275fac,providedIn:"root"})};var Yd=bp("notes"),TN=Ws(Yd,n=>n.userName),AN=Ws(Yd,n=>n.tasks),DN=Ws(Yd,n=>n.curentTask);var U_=class n{destroy$=new Rt;ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}static \u0275fac=function(t){return new(t||n)};static \u0275dir=er({type:n,selectors:[["","appClearObservable",""]],standalone:!0})};export{rr as a,xb as b,Fb as c,Lb as d,tw as e,gC as f,YT as g,Jm as h,BP as i,po as j,Xm as k,rR as l,XR as m,ZR as n,V_ as o,TN as p,AN as q,DN as r,U_ as s,gm as t};
