import{n as yi,o as gh}from"./chunk-GBOIA3S4.js";import{Cb as ko,Db as dh,Fa as fr,Fb as fh,Gb as ph,Ia as hh,Ja as jt,La as Co,Lb as mh,Nb as No,Pa as Ro,Qb as Oo,Ua as Gt,Wa as Po,a as _n,b as Ao,ba as ah,c as Dt,d as y,da as uh,fa as ke,g as bt,ga as ch,ia as ot,j as ih,ka as St,la as at,lb as Le,m as sh,mb as ue,n as oh,na as zt,p as mi,q as Do,r as bo,ra as lh,sa as gi,ta as So,ua as _i}from"./chunk-CWLYJARK.js";var yh=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},vm=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],a=n[t++],c=n[t++],h=((i&7)<<18|(o&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{let o=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|a&63)}}return e.join("")},vh={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],a=i+1<n.length,c=a?n[i+1]:0,h=i+2<n.length,d=h?n[i+2]:0,p=o>>2,T=(o&3)<<4|c>>4,D=(c&15)<<2|d>>6,S=d&63;h||(S=64,a||(D=64)),r.push(t[p],t[T],t[D],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(yh(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):vm(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let T=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||c==null||d==null||T==null)throw new xo;let D=o<<2|c>>4;if(r.push(D),d!==64){let S=c<<4&240|d>>2;if(r.push(S),T!==64){let N=d<<6&192|T;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},xo=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},Im=function(n){let e=yh(n);return vh.encodeByteArray(e,!0)},pr=function(n){return Im(n).replace(/\./g,"")},Vo=function(n){try{return vh.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Em(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var wm=()=>Em().__FIREBASE_DEFAULTS__,Tm=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Am=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Vo(n[1]);return e&&JSON.parse(e)},Ii=()=>{try{return wm()||Tm()||Am()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Mo=n=>{var e,t;return(t=(e=Ii())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ih=n=>{let e=Mo(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Uo=()=>{var n;return(n=Ii())===null||n===void 0?void 0:n.config},Bo=n=>{var e;return(e=Ii())===null||e===void 0?void 0:e[`_${n}`]};var vi=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Eh(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[pr(JSON.stringify(t)),pr(JSON.stringify(a)),""].join(".")}function fe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fe())}function Dm(){var n;let e=(n=Ii())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Th(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ah(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Dh(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function bh(){let n=fe();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Sh(){return!Dm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $o(){try{return typeof indexedDB=="object"}catch{return!1}}function Ch(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var bm="FirebaseError",Ne=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=bm,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ut.prototype.create)}},ut=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],a=o?Sm(o,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Ne(i,c,r)}};function Sm(n,e){return n.replace(Cm,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Cm=/\{\$([^}]+)}/g;function Rh(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Wt(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],a=e[i];if(_h(o)&&_h(a)){if(!Wt(o,a))return!1}else if(o!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function _h(n){return n!==null&&typeof n=="object"}function yn(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ph(n,e){let t=new Lo(n,e);return t.subscribe.bind(t)}var Lo=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Rm(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Fo),i.error===void 0&&(i.error=Fo),i.complete===void 0&&(i.complete=Fo);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Rm(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Fo(){}var GE=4*60*60*1e3;function pe(n){return n&&n._delegate?n._delegate:n}var Ve=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Kt="[DEFAULT]";var qo=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new vi;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(km(e))try{this.getOrInitializeService({instanceIdentifier:Kt})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Kt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return y(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Kt){return this.instances.has(e)}getOptions(e=Kt){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(o);r===c&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Pm(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kt){return this.component?this.component.multipleInstances?e:Kt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Pm(n){return n===Kt?void 0:n}function km(n){return n.instantiationMode==="EAGER"}var Ei=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new qo(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Nm=[],$=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}($||{}),Om={debug:$.DEBUG,verbose:$.VERBOSE,info:$.INFO,warn:$.WARN,error:$.ERROR,silent:$.SILENT},Fm=$.INFO,xm={[$.DEBUG]:"log",[$.VERBOSE]:"log",[$.INFO]:"info",[$.WARN]:"warn",[$.ERROR]:"error"},Lm=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=xm[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ct=class{constructor(e){this.name=e,this._logLevel=Fm,this._logHandler=Lm,this._userLogHandler=null,Nm.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Om[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$.DEBUG,...e),this._logHandler(this,$.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$.VERBOSE,...e),this._logHandler(this,$.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$.INFO,...e),this._logHandler(this,$.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$.WARN,...e),this._logHandler(this,$.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$.ERROR,...e),this._logHandler(this,$.ERROR,...e)}};var Vm=(n,e)=>e.some(t=>n instanceof t),kh,Nh;function Mm(){return kh||(kh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Um(){return Nh||(Nh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Oh=new WeakMap,jo=new WeakMap,Fh=new WeakMap,zo=new WeakMap,Wo=new WeakMap;function Bm(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Ge(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Oh.set(t,n)}).catch(()=>{}),Wo.set(e,n),e}function $m(n){if(jo.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});jo.set(n,e)}var Go={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return jo.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Fh.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ge(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function xh(n){Go=n(Go)}function qm(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(wi(this),e,...t);return Fh.set(r,e.sort?e.sort():[e]),Ge(r)}:Um().includes(n)?function(...e){return n.apply(wi(this),e),Ge(Oh.get(this))}:function(...e){return Ge(n.apply(wi(this),e))}}function zm(n){return typeof n=="function"?qm(n):(n instanceof IDBTransaction&&$m(n),Vm(n,Mm())?new Proxy(n,Go):n)}function Ge(n){if(n instanceof IDBRequest)return Bm(n);if(zo.has(n))return zo.get(n);let e=zm(n);return e!==n&&(zo.set(n,e),Wo.set(e,n)),e}var wi=n=>Wo.get(n);function Vh(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let a=indexedDB.open(n,e),c=Ge(a);return r&&a.addEventListener("upgradeneeded",h=>{r(Ge(a.result),h.oldVersion,h.newVersion,Ge(a.transaction),h)}),t&&a.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}var jm=["get","getKey","getAll","getAllKeys","count"],Gm=["put","add","delete","clear"],Ko=new Map;function Lh(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ko.get(e))return Ko.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Gm.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||jm.includes(t)))return;let o=function(a,...c){return y(this,null,function*(){let h=this.transaction(a,i?"readwrite":"readonly"),d=h.store;return r&&(d=d.index(c.shift())),(yield Promise.all([d[t](...c),i&&h.done]))[0]})};return Ko.set(e,o),o}xh(n=>Ao(_n({},n),{get:(e,t,r)=>Lh(e,t)||n.get(e,t,r),has:(e,t)=>!!Lh(e,t)||n.has(e,t)}));var Qo=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Wm(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Wm(n){let e=n.getComponent();return e?.type==="VERSION"}var Yo="@firebase/app",Mh="0.10.13";var ct=new Ct("@firebase/app"),Km="@firebase/app-compat",Hm="@firebase/analytics-compat",Qm="@firebase/analytics",Ym="@firebase/app-check-compat",Jm="@firebase/app-check",Xm="@firebase/auth",Zm="@firebase/auth-compat",eg="@firebase/database",tg="@firebase/data-connect",ng="@firebase/database-compat",rg="@firebase/functions",ig="@firebase/functions-compat",sg="@firebase/installations",og="@firebase/installations-compat",ag="@firebase/messaging",ug="@firebase/messaging-compat",cg="@firebase/performance",lg="@firebase/performance-compat",hg="@firebase/remote-config",dg="@firebase/remote-config-compat",fg="@firebase/storage",pg="@firebase/storage-compat",mg="@firebase/firestore",gg="@firebase/vertexai-preview",_g="@firebase/firestore-compat",yg="firebase",vg="10.14.1";var Jo="[DEFAULT]",Ig={[Yo]:"fire-core",[Km]:"fire-core-compat",[Qm]:"fire-analytics",[Hm]:"fire-analytics-compat",[Jm]:"fire-app-check",[Ym]:"fire-app-check-compat",[Xm]:"fire-auth",[Zm]:"fire-auth-compat",[eg]:"fire-rtdb",[tg]:"fire-data-connect",[ng]:"fire-rtdb-compat",[rg]:"fire-fn",[ig]:"fire-fn-compat",[sg]:"fire-iid",[og]:"fire-iid-compat",[ag]:"fire-fcm",[ug]:"fire-fcm-compat",[cg]:"fire-perf",[lg]:"fire-perf-compat",[hg]:"fire-rc",[dg]:"fire-rc-compat",[fg]:"fire-gcs",[pg]:"fire-gcs-compat",[mg]:"fire-fst",[_g]:"fire-fst-compat",[gg]:"fire-vertex","fire-js":"fire-js",[yg]:"fire-js-all"};var mr=new Map,Eg=new Map,Xo=new Map;function Uh(n,e){try{n.container.addComponent(e)}catch(t){ct.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pt(n){let e=n.name;if(Xo.has(e))return ct.debug(`There were multiple attempts to register component ${e}.`),!1;Xo.set(e,n);for(let t of mr.values())Uh(t,n);for(let t of Eg.values())Uh(t,n);return!0}function _r(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function We(n){return n.settings!==void 0}var wg={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Rt=new ut("app","Firebase",wg);var Zo=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ve("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rt.create("app-deleted",{appName:this._name})}};var kt=vg;function Ti(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Jo,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Rt.create("bad-app-name",{appName:String(i)});if(t||(t=Uo()),!t)throw Rt.create("no-options");let o=mr.get(i);if(o){if(Wt(t,o.options)&&Wt(r,o.config))return o;throw Rt.create("duplicate-app",{appName:i})}let a=new Ei(i);for(let h of Xo.values())a.addComponent(h);let c=new Zo(t,r,a);return mr.set(i,c),c}function vn(n=Jo){let e=mr.get(n);if(!e&&n===Jo&&Uo())return Ti();if(!e)throw Rt.create("no-app",{appName:n});return e}function Ai(){return Array.from(mr.values())}function _e(n,e,t){var r;let i=(r=Ig[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){let c=[`Unable to register library "${i}" with version "${e}":`];o&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ct.warn(c.join(" "));return}Pt(new Ve(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Tg="firebase-heartbeat-database",Ag=1,gr="firebase-heartbeat-store",Ho=null;function zh(){return Ho||(Ho=Vh(Tg,Ag,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(gr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Rt.create("idb-open",{originalErrorMessage:n.message})})),Ho}function Dg(n){return y(this,null,function*(){try{let t=(yield zh()).transaction(gr),r=yield t.objectStore(gr).get(jh(n));return yield t.done,r}catch(e){if(e instanceof Ne)ct.warn(e.message);else{let t=Rt.create("idb-get",{originalErrorMessage:e?.message});ct.warn(t.message)}}})}function Bh(n,e){return y(this,null,function*(){try{let r=(yield zh()).transaction(gr,"readwrite");yield r.objectStore(gr).put(e,jh(n)),yield r.done}catch(t){if(t instanceof Ne)ct.warn(t.message);else{let r=Rt.create("idb-set",{originalErrorMessage:t?.message});ct.warn(r.message)}}})}function jh(n){return`${n.name}!${n.options.appId}`}var bg=1024,Sg=30*24*60*60*1e3,ea=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ta(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return y(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=$h();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let c=new Date(a.date).valueOf();return Date.now()-c<=Sg}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ct.warn(r)}})}getHeartbeatsHeader(){return y(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=$h(),{heartbeatsToSend:r,unsentEntries:i}=Cg(this._heartbeatsCache.heartbeats),o=pr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return ct.warn(t),""}})}};function $h(){return new Date().toISOString().substring(0,10)}function Cg(n,e=bg){let t=[],r=n.slice();for(let i of n){let o=t.find(a=>a.agent===i.agent);if(o){if(o.dates.push(i.date),qh(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),qh(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var ta=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return y(this,null,function*(){return $o()?Ch().then(()=>!0).catch(()=>!1):!1})}read(){return y(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Dg(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Bh(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return y(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Bh(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function qh(n){return pr(JSON.stringify({version:2,heartbeats:n})).length}function Rg(n){Pt(new Ve("platform-logger",e=>new Qo(e),"PRIVATE")),Pt(new Ve("heartbeat",e=>new ea(e),"PRIVATE")),_e(Yo,Mh,n),_e(Yo,Mh,"esm2017"),_e("fire-js","")}Rg("");var Pg="firebase",kg="10.14.1";_e(Pg,kg,"app");var yr=new ko("ANGULARFIRE2_VERSION");function Gh(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(a=>a.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var ra=(n,e)=>{let t=e?[e]:Ai(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Di=class{constructor(){return ra(Ng)}},Ng="app-check";function In(){}var bi=class{zone;delegate;constructor(e,t=oh){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(o,t,r)}},na=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",In,{},In,In)),t.pipe(ah({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Ci=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new bi(Zone.current)),this.insideAngular=t.run(()=>new bi(Zone.current,sh)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(St(jt))};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ri(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Og(n){return Ri().ngZone.runOutsideAngular(()=>n())}function Ht(n){return Ri().ngZone.run(()=>n())}function Fg(n){return xg(Ri())(n)}function xg(n){return function(t){return t=t.lift(new na(n.ngZone)),t.pipe(bo(n.outsideAngular),Do(n.insideAngular))}}var Lg=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ht(()=>n.apply(void 0,r))},Pi=(n,e)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(e&&(t||=Ht(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",In,{},In,In))),r[o]=Lg(r[o],t));let i=Og(()=>n.apply(this,r));if(!e)if(i instanceof bt){let o=Ri();return i.pipe(bo(o.outsideAngular),Do(o.insideAngular))}else return Ht(()=>i);return i instanceof bt?i.pipe(Fg):i instanceof Promise?Ht(()=>new Promise((o,a)=>i.then(c=>Ht(()=>o(c)),c=>Ht(()=>a(c))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Ht(()=>i)};var Qt=class{constructor(e){return e}},vr=class{constructor(){return Ai()}};function Vg(n){return n&&n.length===1?n[0]:new Qt(vn())}var ia=new ot("angularfire2._apps"),Mg={provide:Qt,useFactory:Vg,deps:[[new zt,ia]]},Ug={provide:vr,deps:[[new zt,ia]]};function Bg(n){return(e,t)=>{let r=t.get(Ro);_e("angularfire",yr.full,"core"),_e("angularfire",yr.full,"app"),_e("angular",dh.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Qt(i)}}function kw(n,...e){return _i([Mg,Ug,{provide:ia,useFactory:Bg(n),multi:!0,deps:[jt,fr,Ci,...e]}])}function od(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var ad=od,ud=new ut("auth","Firebase",od());var Li=new Ct("@firebase/auth");function $g(n,...e){Li.logLevel<=$.WARN&&Li.warn(`Auth (${kt}): ${n}`,...e)}function Ni(n,...e){Li.logLevel<=$.ERROR&&Li.error(`Auth (${kt}): ${n}`,...e)}function He(n,...e){throw wa(n,...e)}function qe(n,...e){return wa(n,...e)}function Ea(n,e,t){let r=Object.assign(Object.assign({},ad()),{[e]:t});return new ut("auth","Firebase",r).create(e,{appName:n.name})}function Yt(n){return Ea(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qg(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&He(n,"argument-error"),Ea(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function wa(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ud.create(n,...e)}function M(n,e,...t){if(!n)throw wa(e,...t)}function lt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ni(e),new Error(e)}function dt(n,e){n||lt(e)}function aa(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function zg(){return Wh()==="http:"||Wh()==="https:"}function Wh(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function jg(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zg()||Ah()||"connection"in navigator)?navigator.onLine:!0}function Gg(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Jt=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,dt(t>e,"Short delay should be less than long delay!"),this.isMobile=wh()||Dh()}get(){return jg()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Ta(n,e){dt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Vi=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;lt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;lt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;lt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var Wg={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var Kg=new Jt(3e4,6e4);function Aa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Tn(o,a,c,h){return y(this,arguments,function*(n,e,t,r,i={}){return cd(n,i,()=>y(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let T=yn(Object.assign({key:n.config.apiKey},p)).slice(1),D=yield n._getAdditionalHeaders();D["Content-Type"]="application/json",n.languageCode&&(D["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:D},d);return Th()||(S.referrerPolicy="no-referrer"),Vi.fetch()(ld(n,n.config.apiHost,t,T),S)}))})}function cd(n,e,t){return y(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},Wg),e);try{let i=new ua(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield o.json();if("needConfirmation"in a)throw ki(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{let c=o.ok?a.errorMessage:a.error.message,[h,d]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw ki(n,"credential-already-in-use",a);if(h==="EMAIL_EXISTS")throw ki(n,"email-already-in-use",a);if(h==="USER_DISABLED")throw ki(n,"user-disabled",a);let p=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Ea(n,p,d);He(n,p)}}catch(i){if(i instanceof Ne)throw i;He(n,"network-request-failed",{message:String(i)})}})}function Hg(o,a,c,h){return y(this,arguments,function*(n,e,t,r,i={}){let d=yield Tn(n,e,t,r,i);return"mfaPendingCredential"in d&&He(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function ld(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Ta(n.config,i):`${n.config.apiScheme}://${i}`}var ua=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(qe(this.auth,"network-request-failed")),Kg.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function ki(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=qe(n,e,r);return i.customData._tokenResponse=t,i}function Qg(n,e){return y(this,null,function*(){return Tn(n,"POST","/v1/accounts:delete",e)})}function hd(n,e){return y(this,null,function*(){return Tn(n,"POST","/v1/accounts:lookup",e)})}function Ir(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Da(n,e=!1){return y(this,null,function*(){let t=pe(n),r=yield t.getIdToken(e),i=ba(r);M(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,a=o?.sign_in_provider;return{claims:i,token:r,authTime:Ir(sa(i.auth_time)),issuedAtTime:Ir(sa(i.iat)),expirationTime:Ir(sa(i.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function sa(n){return Number(n)*1e3}function ba(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ni("JWT malformed, contained fewer than 3 sections"),null;try{let i=Vo(t);return i?JSON.parse(i):(Ni("Failed to decode base64 JWT payload"),null)}catch(i){return Ni("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Kh(n){let e=ba(n);return M(e,"internal-error"),M(typeof e.exp<"u","internal-error"),M(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function wr(n,e,t=!1){return y(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ne&&Yg(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function Yg({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ca=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>y(this,null,function*(){yield this.iteration()}),t)}iteration(){return y(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Tr=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ir(this.lastLoginAt),this.creationTime=Ir(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Mi(n){return y(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield wr(n,hd(t,{idToken:r}));M(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?dd(o.providerUserInfo):[],c=Jg(n.providerData,a),h=n.isAnonymous,d=!(n.email&&o.passwordHash)&&!c?.length,p=h?d:!1,T={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Tr(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,T)})}function Sa(n){return y(this,null,function*(){let e=pe(n);yield Mi(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Jg(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function dd(n){return n.map(e=>{var{providerId:t}=e,r=mi(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Xg(n,e){return y(this,null,function*(){let t=yield cd(n,{},()=>y(this,null,function*(){let r=yn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,a=ld(n,i,"/v1/token",`key=${o}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Vi.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Zg(n,e){return y(this,null,function*(){return Tn(n,"POST","/v2/accounts:revokeToken",Aa(n,e))})}var Er=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){M(e.idToken,"internal-error"),M(typeof e.idToken<"u","internal-error"),M(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Kh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){M(e.length!==0,"internal-error");let t=Kh(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return y(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(M(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return y(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield Xg(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,a=new n;return r&&(M(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(M(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),o&&(M(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return lt("not implemented")}};function Nt(n,e){M(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var wn=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=mi(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ca(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Tr(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return y(this,null,function*(){let t=yield wr(this,this.stsTokenManager.getToken(this.auth,e));return M(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Da(this,e)}reload(){return Sa(this)}_assign(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return y(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Mi(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return y(this,null,function*(){if(We(this.auth.app))return Promise.reject(Yt(this.auth));let e=yield this.getIdToken();return yield wr(this,Qg(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,a,c,h,d,p;let T=(r=t.displayName)!==null&&r!==void 0?r:void 0,D=(i=t.email)!==null&&i!==void 0?i:void 0,S=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,N=(a=t.photoURL)!==null&&a!==void 0?a:void 0,O=(c=t.tenantId)!==null&&c!==void 0?c:void 0,k=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,z=(d=t.createdAt)!==null&&d!==void 0?d:void 0,j=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:G,emailVerified:ne,isAnonymous:be,providerData:J,stsTokenManager:I}=t;M(G&&I,e,"internal-error");let m=Er.fromJSON(this.name,I);M(typeof G=="string",e,"internal-error"),Nt(T,e.name),Nt(D,e.name),M(typeof ne=="boolean",e,"internal-error"),M(typeof be=="boolean",e,"internal-error"),Nt(S,e.name),Nt(N,e.name),Nt(O,e.name),Nt(k,e.name),Nt(z,e.name),Nt(j,e.name);let _=new n({uid:G,auth:e,email:D,emailVerified:ne,displayName:T,isAnonymous:be,photoURL:N,phoneNumber:S,tenantId:O,stsTokenManager:m,createdAt:z,lastLoginAt:j});return J&&Array.isArray(J)&&(_.providerData=J.map(v=>Object.assign({},v))),k&&(_._redirectEventId=k),_}static _fromIdTokenResponse(e,t,r=!1){return y(this,null,function*(){let i=new Er;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Mi(o),o})}static _fromGetAccountInfoResponse(e,t,r){return y(this,null,function*(){let i=t.users[0];M(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?dd(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!o?.length,c=new Er;c.updateFromIdToken(r);let h=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Tr(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h})}};var Hh=new Map;function ht(n){dt(n instanceof Function,"Expected a class definition");let e=Hh.get(n);return e?(dt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Hh.set(n,e),e)}var e_=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return y(this,null,function*(){return!0})}_set(t,r){return y(this,null,function*(){this.storage[t]=r})}_get(t){return y(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return y(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),la=e_;function Oi(n,e,t){return`firebase:${n}:${e}:${t}`}var Ui=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=Oi(this.userKey,i.apiKey,o),this.fullPersistenceKey=Oi("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return y(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?wn._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return y(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return y(this,null,function*(){if(!t.length)return new n(ht(la),e,r);let i=(yield Promise.all(t.map(d=>y(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),o=i[0]||ht(la),a=Oi(r,e.config.apiKey,e.name),c=null;for(let d of t)try{let p=yield d._get(a);if(p){let T=wn._fromJSON(e,p);d!==o&&(c=T),o=d;break}}catch{}let h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new n(o,e,r):(o=h[0],c&&(yield o._set(a,c.toJSON())),yield Promise.all(t.map(d=>y(this,null,function*(){if(d!==o)try{yield d._remove(a)}catch{}}))),new n(o,e,r))})}};function Qh(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gd(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fd(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yd(e))return"Blackberry";if(vd(e))return"Webos";if(pd(e))return"Safari";if((e.includes("chrome/")||md(e))&&!e.includes("edge/"))return"Chrome";if(_d(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function fd(n=fe()){return/firefox\//i.test(n)}function pd(n=fe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function md(n=fe()){return/crios\//i.test(n)}function gd(n=fe()){return/iemobile/i.test(n)}function _d(n=fe()){return/android/i.test(n)}function yd(n=fe()){return/blackberry/i.test(n)}function vd(n=fe()){return/webos/i.test(n)}function Ca(n=fe()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function t_(n=fe()){var e;return Ca(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function n_(){return bh()&&document.documentMode===10}function Id(n=fe()){return Ca(n)||_d(n)||vd(n)||yd(n)||/windows phone/i.test(n)||gd(n)}function Ed(n,e=[]){let t;switch(n){case"Browser":t=Qh(fe());break;case"Worker":t=`${Qh(fe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kt}/${r}`}var ha=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((a,c)=>{try{let h=e(o);a(h)}catch(h){c(h)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return y(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function r_(t){return y(this,arguments,function*(n,e={}){return Tn(n,"GET","/v2/passwordPolicy",Aa(n,e))})}var i_=6,da=class{constructor(e){var t,r,i,o;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:i_,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,a,c;let h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsNumericCharacter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(c=h.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),h}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var fa=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Bi(this),this.idTokenSubscription=new Bi(this),this.beforeStateQueue=new ha(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ud,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ht(t)),this._initializationPromise=this.queue(()=>y(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Ui.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return y(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return y(this,null,function*(){try{let t=yield hd(this,{idToken:e}),r=yield wn._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return y(this,null,function*(){var t;if(We(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,h=yield this.tryRedirectSignIn(e);(!a||a===c)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return M(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return y(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return y(this,null,function*(){try{yield Mi(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=Gg()}_delete(){return y(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return y(this,null,function*(){if(We(this.app))return Promise.reject(Yt(this));let t=e?pe(e):null;return t&&M(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return y(this,null,function*(){if(!this._deleted)return e&&M(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>y(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return y(this,null,function*(){return We(this.app)?Promise.reject(Yt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return We(this.app)?Promise.reject(Yt(this)):this.queue(()=>y(this,null,function*(){yield this.assertedPersistence.setPersistence(ht(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return y(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return y(this,null,function*(){let e=yield r_(this),t=new da(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ut("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return y(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Zg(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return y(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return y(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&ht(e)||this._popupRedirectResolver;M(t,this,"argument-error"),this.redirectPersistenceManager=yield Ui.create(this,[ht(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return y(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>y(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return y(this,null,function*(){if(e===this.currentUser)return this.queue(()=>y(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(c,this,"internal-error"),c.then(()=>{a||o(this.currentUser)}),typeof t=="function"){let h=e.addObserver(t,r,i);return()=>{a=!0,h()}}else{let h=e.addObserver(t);return()=>{a=!0,h()}}}directlySetCurrentUser(e){return y(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ed(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return y(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return y(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&$g(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Hi(n){return pe(n)}var Bi=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ph(t=>this.observer=t)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ra={loadJS(){return y(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function s_(n){Ra=n}function o_(n){return Ra.loadJS(n)}function a_(){return Ra.gapiScript}function wd(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Pa(n,e){let t=_r(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Wt(o,e??{}))return i;He(i,"already-initialized")}return t.initialize({options:e})}function u_(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(ht);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function ka(n,e,t){let r=Hi(n);M(r._canInitEmulator,r,"emulator-config-failed"),M(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=Td(e),{host:a,port:c}=c_(e),h=c===null?"":`:${c}`;r.config.emulator={url:`${o}//${a}${h}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||l_()}function Td(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function c_(n){let e=Td(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:Yh(r.substr(o.length+1))}}else{let[o,a]=r.split(":");return{host:o,port:Yh(a)}}}function Yh(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function l_(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ar=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return lt("not implemented")}_getIdTokenResponse(e){return lt("not implemented")}_linkToIdToken(e,t){return lt("not implemented")}_getReauthenticationResolver(e){return lt("not implemented")}};function En(n,e){return y(this,null,function*(){return Hg(n,"POST","/v1/accounts:signInWithIdp",Aa(n,e))})}var h_="http://localhost",$i=class n extends Ar{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):He("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,o=mi(t,["providerId","signInMethod"]);if(!r||!i)return null;let a=new n(r,i);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){let t=this.buildRequest();return En(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,En(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,En(e,t)}buildRequest(){let e={requestUri:h_,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=yn(t)}return e}};var Dr=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var qi=class extends Dr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Qi=(()=>{class n extends qi{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return $i._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();var br=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return y(this,null,function*(){let o=yield wn._fromIdTokenResponse(e,r,i),a=Jh(r);return new n({user:o,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return y(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Jh(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Jh(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var pa=class n extends Ne{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Ad(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?pa._fromErrorAndOperation(n,o,e,r):o})}function d_(n,e,t=!1){return y(this,null,function*(){let r=yield wr(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return br._forOperation(n,"link",r)})}function f_(n,e,t=!1){return y(this,null,function*(){let{auth:r}=n;if(We(r.app))return Promise.reject(Yt(r));let i="reauthenticate";try{let o=yield wr(n,Ad(r,i,e,n),t);M(o.idToken,r,"internal-error");let a=ba(o.idToken);M(a,r,"internal-error");let{sub:c}=a;return M(n.uid===c,r,"user-mismatch"),br._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&He(r,"user-mismatch"),o}})}function p_(n,e,t=!1){return y(this,null,function*(){if(We(n.app))return Promise.reject(Yt(n));let r="signIn",i=yield Ad(n,r,e),o=yield br._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function Na(n,e,t,r){return pe(n).onIdTokenChanged(e,t,r)}function Oa(n,e,t){return pe(n).beforeAuthStateChanged(e,t)}function Yi(n,e,t,r){return pe(n).onAuthStateChanged(e,t,r)}function Ji(n){return pe(n).signOut()}var zi="__sak";var ji=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zi,"1"),this.storage.removeItem(zi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var m_=1e3,g_=10,__=(()=>{class n extends ji{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Id(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,h,d)=>{this.notifyListeners(c,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);n_()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,g_):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},m_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return y(this,null,function*(){yield Dt(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return y(this,null,function*(){let r=yield Dt(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return y(this,null,function*(){yield Dt(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Dd=__;var y_=(()=>{class n extends ji{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Fa=y_;function v_(n){return Promise.all(n.map(e=>y(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var I_=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return y(this,null,function*(){let r=t,{eventId:i,eventType:o,data:a}=r.data,c=this.handlersMap[o];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let h=Array.from(c).map(p=>y(this,null,function*(){return p(r.origin,a)})),d=yield v_(h);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function xa(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var ma=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return y(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,a;return new Promise((c,h)=>{let d=xa("",20);i.port1.start();let p=setTimeout(()=>{h(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(T){let D=T;if(D.data.eventId===d)switch(D.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(D.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function Ke(){return window}function E_(n){Ke().location.href=n}function bd(){return typeof Ke().WorkerGlobalScope<"u"&&typeof Ke().importScripts=="function"}function w_(){return y(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function T_(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function A_(){return bd()?self:null}var Sd="firebaseLocalStorageDb",D_=1,Gi="firebaseLocalStorage",Cd="fbase_key",Xt=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Xi(n,e){return n.transaction([Gi],e?"readwrite":"readonly").objectStore(Gi)}function b_(){let n=indexedDB.deleteDatabase(Sd);return new Xt(n).toPromise()}function ga(){let n=indexedDB.open(Sd,D_);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Gi,{keyPath:Cd})}catch(i){t(i)}}),n.addEventListener("success",()=>y(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Gi)?e(r):(r.close(),yield b_(),e(yield ga()))}))})}function Xh(n,e,t){return y(this,null,function*(){let r=Xi(n,!0).put({[Cd]:e,value:t});return new Xt(r).toPromise()})}function S_(n,e){return y(this,null,function*(){let t=Xi(n,!1).get(e),r=yield new Xt(t).toPromise();return r===void 0?null:r.value})}function Zh(n,e){let t=Xi(n,!0).delete(e);return new Xt(t).toPromise()}var C_=800,R_=3,P_=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return y(this,null,function*(){return this.db?this.db:(this.db=yield ga(),this.db)})}_withRetries(t){return y(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>R_)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return y(this,null,function*(){return bd()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return y(this,null,function*(){this.receiver=I_._getInstance(A_()),this.receiver._subscribe("keyChanged",(t,r)=>y(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>y(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return y(this,null,function*(){var t,r;if(this.activeServiceWorker=yield w_(),!this.activeServiceWorker)return;this.sender=new ma(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return y(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||T_()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return y(this,null,function*(){try{if(!indexedDB)return!1;let t=yield ga();return yield Xh(t,zi,"1"),yield Zh(t,zi),!0}catch{}return!1})}_withPendingWrite(t){return y(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(i=>Xh(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return y(this,null,function*(){let r=yield this._withRetries(i=>S_(i,t));return this.localCache[t]=r,r})}_remove(t){return y(this,null,function*(){return this._withPendingWrite(()=>y(this,null,function*(){return yield this._withRetries(r=>Zh(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return y(this,null,function*(){let t=yield this._withRetries(o=>{let a=Xi(o,!1).getAll();return new Xt(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:a}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>y(this,null,function*(){return this._poll()}),C_)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Rd=P_;var $w=wd("rcb"),qw=new Jt(3e4,6e4);function Pd(n,e){return e?ht(e):(M(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Sr=class extends Ar{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return En(e,this._buildIdpRequest())}_linkToIdToken(e,t){return En(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return En(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function k_(n){return p_(n.auth,new Sr(n),n.bypassAuthState)}function N_(n){let{auth:e,user:t}=n;return M(t,e,"internal-error"),f_(t,new Sr(n),n.bypassAuthState)}function O_(n){return y(this,null,function*(){let{auth:e,user:t}=n;return M(t,e,"internal-error"),d_(t,new Sr(n),n.bypassAuthState)})}var Wi=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>y(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return y(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:a,type:c}=e;if(a){this.reject(a);return}let h={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(h))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return k_;case"linkViaPopup":case"linkViaRedirect":return O_;case"reauthViaPopup":case"reauthViaRedirect":return N_;default:He(this.auth,"internal-error")}}resolve(e){dt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var F_=new Jt(2e3,1e4);function La(n,e,t){return y(this,null,function*(){if(We(n.app))return Promise.reject(qe(n,"operation-not-supported-in-this-environment"));let r=Hi(n);qg(n,e,Dr);let i=Pd(r,t);return new x_(r,"signInViaPopup",e,i).executeNotNull()})}var x_=(()=>{class n extends Wi{constructor(t,r,i,o,a){super(t,r,o,a),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return y(this,null,function*(){let t=yield this.execute();return M(t,this.auth,"internal-error"),t})}onExecution(){return y(this,null,function*(){dt(this.filter.length===1,"Popup operations only handle one event");let t=xa();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(qe(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(qe(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qe(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,F_.get())};t()}}n.currentPopupAction=null;return n})(),L_="pendingRedirect",Fi=new Map,_a=class n extends Wi{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return y(this,null,function*(){let e=Fi.get(this.auth._key());if(!e){try{let r=(yield V_(this.resolver,this.auth))?yield Dt(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Fi.set(this.auth._key(),e)}return this.bypassAuthState||Fi.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return y(this,null,function*(){if(e.type==="signInViaRedirect")return Dt(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Dt(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return y(this,null,function*(){})}cleanUp(){}};function V_(n,e){return y(this,null,function*(){let t=B_(e),r=U_(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function M_(n,e){Fi.set(n._key(),e)}function U_(n){return ht(n._redirectPersistence)}function B_(n){return Oi(L_,n.config.apiKey,n.name)}function $_(n,e,t=!1){return y(this,null,function*(){if(We(n.app))return Promise.reject(Yt(n));let r=Hi(n),i=Pd(r,e),a=yield new _a(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var q_=10*60*1e3,ya=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!z_(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!kd(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(qe(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=q_&&this.cachedEventUids.clear(),this.cachedEventUids.has(ed(e))}saveEventToCache(e){this.cachedEventUids.add(ed(e)),this.lastProcessedEventTime=Date.now()}};function ed(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function kd({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function z_(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return kd(n);default:return!1}}function j_(t){return y(this,arguments,function*(n,e={}){return Tn(n,"GET","/v1/projects",e)})}var G_=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,W_=/^https?/;function K_(n){return y(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield j_(n);for(let t of e)try{if(H_(t))return}catch{}He(n,"unauthorized-domain")})}function H_(n){let e=aa(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!W_.test(t))return!1;if(G_.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Q_=new Jt(3e4,6e4);function td(){let n=Ke().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function Y_(n){return new Promise((e,t)=>{var r,i,o;function a(){td(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{td(),t(qe(n,"network-request-failed"))},timeout:Q_.get()})}if(!((i=(r=Ke().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Ke().gapi)===null||o===void 0)&&o.load)a();else{let c=wd("iframefcb");return Ke()[c]=()=>{gapi.load?a():t(qe(n,"network-request-failed"))},o_(`${a_()}?onload=${c}`).catch(h=>t(h))}}).catch(e=>{throw xi=null,e})}var xi=null;function J_(n){return xi=xi||Y_(n),xi}var X_=new Jt(5e3,15e3),Z_="__/auth/iframe",ey="emulator/auth/iframe",ty={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ny=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ry(n){let e=n.config;M(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Ta(e,ey):`https://${n.config.authDomain}/${Z_}`,r={apiKey:e.apiKey,appName:n.name,v:kt},i=ny.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${yn(r).slice(1)}`}function iy(n){return y(this,null,function*(){let e=yield J_(n),t=Ke().gapi;return M(t,n,"internal-error"),e.open({where:document.body,url:ry(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ty,dontclear:!0},r=>new Promise((i,o)=>y(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=qe(n,"network-request-failed"),c=Ke().setTimeout(()=>{o(a)},X_.get());function h(){Ke().clearTimeout(c),i(r)}r.ping(h).then(h,()=>{o(a)})})))})}var sy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oy=500,ay=600,uy="_blank",cy="http://localhost",Ki=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function ly(n,e,t,r=oy,i=ay){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",h=Object.assign(Object.assign({},sy),{width:r.toString(),height:i.toString(),top:o,left:a}),d=fe().toLowerCase();t&&(c=md(d)?uy:t),fd(d)&&(e=e||cy,h.scrollbars="yes");let p=Object.entries(h).reduce((D,[S,N])=>`${D}${S}=${N},`,"");if(t_(d)&&c!=="_self")return hy(e||"",c),new Ki(null);let T=window.open(e||"",c,p);M(T,n,"popup-blocked");try{T.focus()}catch{}return new Ki(T)}function hy(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var dy="__/auth/handler",fy="emulator/auth/handler",py=encodeURIComponent("fac");function nd(n,e,t,r,i,o){return y(this,null,function*(){M(n.config.authDomain,n,"auth-domain-config-required"),M(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:kt,eventId:i};if(e instanceof Dr){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Rh(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,T]of Object.entries(o||{}))a[p]=T}if(e instanceof qi){let p=e.getScopes().filter(T=>T!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let c=a;for(let p of Object.keys(c))c[p]===void 0&&delete c[p];let h=yield n._getAppCheckToken(),d=h?`#${py}=${encodeURIComponent(h)}`:"";return`${my(n)}?${yn(c).slice(1)}${d}`})}function my({config:n}){return n.emulator?Ta(n,fy):`https://${n.authDomain}/${dy}`}var oa="webStorageSupport",va=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Fa,this._completeRedirectFn=$_,this._overrideRedirectResult=M_}_openPopup(e,t,r,i){return y(this,null,function*(){var o;dt((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let a=yield nd(e,t,r,aa(),i);return ly(e,a,xa())})}_openRedirect(e,t,r,i){return y(this,null,function*(){yield this._originValidation(e);let o=yield nd(e,t,r,aa(),i);return E_(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(dt(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return y(this,null,function*(){let t=yield iy(e),r=new ya(e);return t.register("authEvent",i=>(M(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(oa,{type:oa},i=>{var o;let a=(o=i?.[0])===null||o===void 0?void 0:o[oa];a!==void 0&&t(!!a),He(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=K_(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Id()||pd()||Ca()}},Nd=va;var rd="@firebase/auth",id="1.7.9";var Ia=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return y(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function gy(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function _y(n){Pt(new Ve("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;M(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let h={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ed(n)},d=new fa(r,i,o,h);return u_(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Pt(new Ve("auth-internal",e=>{let t=Hi(e.getProvider("auth").getImmediate());return(r=>new Ia(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),_e(rd,id,gy(n)),_e(rd,id,"esm2017")}var yy=5*60,vy=Bo("authIdTokenMaxAge")||yy,sd=null,Iy=n=>e=>y(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>vy)return;let i=t?.token;sd!==i&&(sd=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Cr(n=vn()){let e=_r(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Pa(n,{popupRedirectResolver:Nd,persistence:[Rd,Dd,Fa]}),r=Bo("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let a=Iy(o.toString());Oa(t,a,()=>a(t.currentUser)),Na(t,c=>a(c))}}let i=Mo("auth");return i&&ka(t,`http://${i}`),t}function Ey(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}s_({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=qe("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",Ey().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});_y("Browser");var Od="auth",ft=class{constructor(e){return e}},Va=class{constructor(){return ra(Od)}};var Ma=new ot("angularfire2.auth-instances");function dv(n,e){let t=Gh(Od,n,e);return t&&new ft(t)}function fv(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ft(r)}}var pv={provide:Va,deps:[[new zt,Ma]]},mv={provide:ft,useFactory:dv,deps:[[new zt,Ma],Qt]};function b0(n,...e){return _e("angularfire",yr.full,"auth"),_i([mv,pv,{provide:Ma,useFactory:fv(n),multi:!0,deps:[jt,fr,Ci,vr,[new zt,Di],...e]}])}var S0=Pi(Cr,!0);var Fd=Pi(La,!0);var xd=class n{provider=new Qi;auth=at(ft);signIn(){return this.provider.setCustomParameters({prompt:"select_account"}),Fd(this.auth,this.provider).then(e=>{let r=Qi.credentialFromResult(e)?.accessToken;return e.user.displayName||null}).catch(e=>{throw console.error("Error during sign-in:",e),e})}checkUserLogin(){return new bt(e=>{Yi(this.auth,t=>{t?(e.next(t.displayName),e.complete()):(e.next(null),e.complete())})})}signOut(){return new bt(e=>{let t=Cr();Ji(t).then(()=>{e.next(null),e.complete()}).catch(r=>{console.log("signedOut error"),e.error()})})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})};var qd=null;function Ua(){return qd}function _T(n){qd??=n}var Ld=class{};var zd=new ot(""),jd=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ke({token:n,factory:()=>at(gv),providedIn:"platform"})}}return n})();var gv=(()=>{class n extends jd{constructor(){super(),this._doc=at(zd),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Ua().getBaseHref(this._doc)}onPopState(t){let r=Ua().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Ua().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ke({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function Gd(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function Vd(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Zt(n){return n&&n[0]!=="?"?"?"+n:n}var Wa=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=ke({token:n,factory:()=>at(yv),providedIn:"root"})}}return n})(),_v=new ot(""),yv=(()=>{class n extends Wa{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??at(zd).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Gd(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Zt(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let a=this.prepareExternalUrl(i+Zt(o));this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,o){let a=this.prepareExternalUrl(i+Zt(o));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(St(jd),St(_v,8))}}static{this.\u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var vv=(()=>{class n{constructor(t){this._subject=new hh,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=wv(Vd(Md(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Zt(r))}normalize(t){return n.stripTrailingSlash(Ev(this._basePath,Md(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zt(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Zt(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Zt}static{this.joinWithSlash=Gd}static{this.stripTrailingSlash=Vd}static{this.\u0275fac=function(r){return new(r||n)(St(Wa))}}static{this.\u0275prov=ke({token:n,factory:()=>Iv(),providedIn:"root"})}}return n})();function Iv(){return new vv(St(Wa))}function Ev(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Md(n){return n.replace(/\/index.html$/,"")}function wv(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Re=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(Re||{}),ee=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(ee||{}),Oe=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(Oe||{}),Ot={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function Tv(n){return Le(n)[ue.LocaleId]}function Av(n,e,t){let r=Le(n),i=[r[ue.DayPeriodsFormat],r[ue.DayPeriodsStandalone]],o=Me(i,e);return Me(o,t)}function Dv(n,e,t){let r=Le(n),i=[r[ue.DaysFormat],r[ue.DaysStandalone]],o=Me(i,e);return Me(o,t)}function bv(n,e,t){let r=Le(n),i=[r[ue.MonthsFormat],r[ue.MonthsStandalone]],o=Me(i,e);return Me(o,t)}function Sv(n,e){let r=Le(n)[ue.Eras];return Me(r,e)}function Zi(n,e){let t=Le(n);return Me(t[ue.DateFormat],e)}function es(n,e){let t=Le(n);return Me(t[ue.TimeFormat],e)}function ts(n,e){let r=Le(n)[ue.DateTimeFormat];return Me(r,e)}function us(n,e){let t=Le(n),r=t[ue.NumberSymbols][e];if(typeof r>"u"){if(e===Ot.CurrencyDecimal)return t[ue.NumberSymbols][Ot.Decimal];if(e===Ot.CurrencyGroup)return t[ue.NumberSymbols][Ot.Group]}return r}function Wd(n){if(!n[ue.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[ue.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Cv(n){let e=Le(n);return Wd(e),(e[ue.ExtraData][2]||[]).map(r=>typeof r=="string"?Ba(r):[Ba(r[0]),Ba(r[1])])}function Rv(n,e,t){let r=Le(n);Wd(r);let i=[r[ue.ExtraData][0],r[ue.ExtraData][1]],o=Me(i,e)||[];return Me(o,t)||[]}function Me(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function Ba(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var Pv=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ns={},kv=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,mt=function(n){return n[n.Short=0]="Short",n[n.ShortGMT=1]="ShortGMT",n[n.Long=2]="Long",n[n.Extended=3]="Extended",n}(mt||{}),Y=function(n){return n[n.FullYear=0]="FullYear",n[n.Month=1]="Month",n[n.Date=2]="Date",n[n.Hours=3]="Hours",n[n.Minutes=4]="Minutes",n[n.Seconds=5]="Seconds",n[n.FractionalSeconds=6]="FractionalSeconds",n[n.Day=7]="Day",n}(Y||{}),Q=function(n){return n[n.DayPeriods=0]="DayPeriods",n[n.Days=1]="Days",n[n.Months=2]="Months",n[n.Eras=3]="Eras",n}(Q||{});function Nv(n,e,t,r){let i=$v(n);e=pt(t,e)||e;let a=[],c;for(;e;)if(c=kv.exec(e),c){a=a.concat(c.slice(1));let p=a.pop();if(!p)break;e=p}else{a.push(e);break}let h=i.getTimezoneOffset();r&&(h=Hd(r,h),i=Bv(i,r,!0));let d="";return a.forEach(p=>{let T=Mv(p);d+=T?T(i,t,h):p==="''"?"'":p.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function as(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function pt(n,e){let t=Tv(n);if(ns[t]??={},ns[t][e])return ns[t][e];let r="";switch(e){case"shortDate":r=Zi(n,Oe.Short);break;case"mediumDate":r=Zi(n,Oe.Medium);break;case"longDate":r=Zi(n,Oe.Long);break;case"fullDate":r=Zi(n,Oe.Full);break;case"shortTime":r=es(n,Oe.Short);break;case"mediumTime":r=es(n,Oe.Medium);break;case"longTime":r=es(n,Oe.Long);break;case"fullTime":r=es(n,Oe.Full);break;case"short":let i=pt(n,"shortTime"),o=pt(n,"shortDate");r=rs(ts(n,Oe.Short),[i,o]);break;case"medium":let a=pt(n,"mediumTime"),c=pt(n,"mediumDate");r=rs(ts(n,Oe.Medium),[a,c]);break;case"long":let h=pt(n,"longTime"),d=pt(n,"longDate");r=rs(ts(n,Oe.Long),[h,d]);break;case"full":let p=pt(n,"fullTime"),T=pt(n,"fullDate");r=rs(ts(n,Oe.Full),[p,T]);break}return r&&(ns[t][e]=r),r}function rs(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function ze(n,e,t="-",r,i){let o="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,o=t));let a=String(n);for(;a.length<e;)a="0"+a;return r&&(a=a.slice(a.length-e)),o+a}function Ov(n,e){return ze(n,3).substring(0,e)}function ce(n,e,t=0,r=!1,i=!1){return function(o,a){let c=Fv(n,o);if((t>0||c>-t)&&(c+=t),n===Y.Hours)c===0&&t===-12&&(c=12);else if(n===Y.FractionalSeconds)return Ov(c,e);let h=us(a,Ot.MinusSign);return ze(c,e,h,r,i)}}function Fv(n,e){switch(n){case Y.FullYear:return e.getFullYear();case Y.Month:return e.getMonth();case Y.Date:return e.getDate();case Y.Hours:return e.getHours();case Y.Minutes:return e.getMinutes();case Y.Seconds:return e.getSeconds();case Y.FractionalSeconds:return e.getMilliseconds();case Y.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function te(n,e,t=Re.Format,r=!1){return function(i,o){return xv(i,o,n,e,t,r)}}function xv(n,e,t,r,i,o){switch(t){case Q.Months:return bv(e,i,r)[n.getMonth()];case Q.Days:return Dv(e,i,r)[n.getDay()];case Q.DayPeriods:let a=n.getHours(),c=n.getMinutes();if(o){let d=Cv(e),p=Rv(e,i,r),T=d.findIndex(D=>{if(Array.isArray(D)){let[S,N]=D,O=a>=S.hours&&c>=S.minutes,k=a<N.hours||a===N.hours&&c<N.minutes;if(S.hours<N.hours){if(O&&k)return!0}else if(O||k)return!0}else if(D.hours===a&&D.minutes===c)return!0;return!1});if(T!==-1)return p[T]}return Av(e,i,r)[a<12?0:1];case Q.Eras:return Sv(e,r)[n.getFullYear()<=0?0:1];default:let h=t;throw new Error(`unexpected translation type ${h}`)}}function is(n){return function(e,t,r){let i=-1*r,o=us(t,Ot.MinusSign),a=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case mt.Short:return(i>=0?"+":"")+ze(a,2,o)+ze(Math.abs(i%60),2,o);case mt.ShortGMT:return"GMT"+(i>=0?"+":"")+ze(a,1,o);case mt.Long:return"GMT"+(i>=0?"+":"")+ze(a,2,o)+":"+ze(Math.abs(i%60),2,o);case mt.Extended:return r===0?"Z":(i>=0?"+":"")+ze(a,2,o)+":"+ze(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}var Lv=0,os=4;function Vv(n){let e=as(n,Lv,1).getDay();return as(n,0,1+(e<=os?os:os+7)-e)}function Kd(n){let e=n.getDay(),t=e===0?-3:os-e;return as(n.getFullYear(),n.getMonth(),n.getDate()+t)}function $a(n,e=!1){return function(t,r){let i;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,a=t.getDate();i=1+Math.floor((a+o)/7)}else{let o=Kd(t),a=Vv(o.getFullYear()),c=o.getTime()-a.getTime();i=1+Math.round(c/6048e5)}return ze(i,n,us(r,Ot.MinusSign))}}function ss(n,e=!1){return function(t,r){let o=Kd(t).getFullYear();return ze(o,n,us(r,Ot.MinusSign),e)}}var qa={};function Mv(n){if(qa[n])return qa[n];let e;switch(n){case"G":case"GG":case"GGG":e=te(Q.Eras,ee.Abbreviated);break;case"GGGG":e=te(Q.Eras,ee.Wide);break;case"GGGGG":e=te(Q.Eras,ee.Narrow);break;case"y":e=ce(Y.FullYear,1,0,!1,!0);break;case"yy":e=ce(Y.FullYear,2,0,!0,!0);break;case"yyy":e=ce(Y.FullYear,3,0,!1,!0);break;case"yyyy":e=ce(Y.FullYear,4,0,!1,!0);break;case"Y":e=ss(1);break;case"YY":e=ss(2,!0);break;case"YYY":e=ss(3);break;case"YYYY":e=ss(4);break;case"M":case"L":e=ce(Y.Month,1,1);break;case"MM":case"LL":e=ce(Y.Month,2,1);break;case"MMM":e=te(Q.Months,ee.Abbreviated);break;case"MMMM":e=te(Q.Months,ee.Wide);break;case"MMMMM":e=te(Q.Months,ee.Narrow);break;case"LLL":e=te(Q.Months,ee.Abbreviated,Re.Standalone);break;case"LLLL":e=te(Q.Months,ee.Wide,Re.Standalone);break;case"LLLLL":e=te(Q.Months,ee.Narrow,Re.Standalone);break;case"w":e=$a(1);break;case"ww":e=$a(2);break;case"W":e=$a(1,!0);break;case"d":e=ce(Y.Date,1);break;case"dd":e=ce(Y.Date,2);break;case"c":case"cc":e=ce(Y.Day,1);break;case"ccc":e=te(Q.Days,ee.Abbreviated,Re.Standalone);break;case"cccc":e=te(Q.Days,ee.Wide,Re.Standalone);break;case"ccccc":e=te(Q.Days,ee.Narrow,Re.Standalone);break;case"cccccc":e=te(Q.Days,ee.Short,Re.Standalone);break;case"E":case"EE":case"EEE":e=te(Q.Days,ee.Abbreviated);break;case"EEEE":e=te(Q.Days,ee.Wide);break;case"EEEEE":e=te(Q.Days,ee.Narrow);break;case"EEEEEE":e=te(Q.Days,ee.Short);break;case"a":case"aa":case"aaa":e=te(Q.DayPeriods,ee.Abbreviated);break;case"aaaa":e=te(Q.DayPeriods,ee.Wide);break;case"aaaaa":e=te(Q.DayPeriods,ee.Narrow);break;case"b":case"bb":case"bbb":e=te(Q.DayPeriods,ee.Abbreviated,Re.Standalone,!0);break;case"bbbb":e=te(Q.DayPeriods,ee.Wide,Re.Standalone,!0);break;case"bbbbb":e=te(Q.DayPeriods,ee.Narrow,Re.Standalone,!0);break;case"B":case"BB":case"BBB":e=te(Q.DayPeriods,ee.Abbreviated,Re.Format,!0);break;case"BBBB":e=te(Q.DayPeriods,ee.Wide,Re.Format,!0);break;case"BBBBB":e=te(Q.DayPeriods,ee.Narrow,Re.Format,!0);break;case"h":e=ce(Y.Hours,1,-12);break;case"hh":e=ce(Y.Hours,2,-12);break;case"H":e=ce(Y.Hours,1);break;case"HH":e=ce(Y.Hours,2);break;case"m":e=ce(Y.Minutes,1);break;case"mm":e=ce(Y.Minutes,2);break;case"s":e=ce(Y.Seconds,1);break;case"ss":e=ce(Y.Seconds,2);break;case"S":e=ce(Y.FractionalSeconds,1);break;case"SS":e=ce(Y.FractionalSeconds,2);break;case"SSS":e=ce(Y.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=is(mt.Short);break;case"ZZZZZ":e=is(mt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=is(mt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=is(mt.Long);break;default:return null}return qa[n]=e,e}function Hd(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function Uv(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function Bv(n,e,t){let r=t?-1:1,i=n.getTimezoneOffset(),o=Hd(e,i);return Uv(n,r*(o-i))}function $v(n){if(Ud(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,o=1,a=1]=n.split("-").map(c=>+c);return as(i,o-1,a)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(Pv))return qv(r)}let e=new Date(n);if(!Ud(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function qv(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let a=Number(n[4]||0)-t,c=Number(n[5]||0)-r,h=Number(n[6]||0),d=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,a,c,h,d),e}function Ud(n){return n instanceof Date&&!isNaN(n.valueOf())}function yT(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var za=/\s+/,Bd=[],vT=(()=>{class n{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=Bd,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(za):Bd}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(za):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(za).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||n)(Gt(Co),Gt(Po))}}static{this.\u0275dir=gi({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();function Qd(n,e){return new uh(2100,!1)}var ja=class{createSubscription(e,t){return Oo(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){Oo(()=>e.unsubscribe())}},Ga=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},zv=new Ga,jv=new ja,IT=(()=>{class n{constructor(t){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,r=>this._updateLatestValue(t,r))}_selectStrategy(t){if(fh(t))return zv;if(ph(t))return jv;throw Qd(n,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,r){t===this._obj&&(this._latestValue=r,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static{this.\u0275fac=function(r){return new(r||n)(Gt(No,16))}}static{this.\u0275pipe=So({name:"async",type:n,pure:!1,standalone:!0})}}return n})();var Gv="mediumDate",Wv=new ot(""),Kv=new ot(""),ET=(()=>{class n{constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,o){if(t==null||t===""||t!==t)return null;try{let a=r??this.defaultOptions?.dateFormat??Gv,c=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return Nv(t,a,o||this.locale,c)}catch(a){throw Qd(n,a.message)}}static{this.\u0275fac=function(r){return new(r||n)(Gt(mh,16),Gt(Wv,24),Gt(Kv,24))}}static{this.\u0275pipe=So({name:"date",type:n,pure:!0,standalone:!0})}}return n})();var wT=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=lh({type:n})}static{this.\u0275inj=ch({})}}return n})(),TT="browser",Hv="server";function AT(n){return n===Hv}var $d=class{};var Yd={apiKey:"AIzaSyAtvWNL0SosEH5IfXqCTjrmC_iwx_v600s",authDomain:"todo-13c71.firebaseapp.com",projectId:"todo-13c71",storageBucket:"todo-13c71.firebasestorage.app",messagingSenderId:"196363664197",appId:"1:196363664197:web:50e211c42bdfca6ea21c2c",measurementId:"G-WZB3CC6QKC"};var Jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xd={};var Ft,Ka;(function(){var n;function e(I,m){function _(){}_.prototype=m.prototype,I.D=m.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(v,E,A){for(var g=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)g[rt-2]=arguments[rt];return m.prototype[E].apply(v,g)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,m,_){_||(_=0);var v=Array(16);if(typeof m=="string")for(var E=0;16>E;++E)v[E]=m.charCodeAt(_++)|m.charCodeAt(_++)<<8|m.charCodeAt(_++)<<16|m.charCodeAt(_++)<<24;else for(E=0;16>E;++E)v[E]=m[_++]|m[_++]<<8|m[_++]<<16|m[_++]<<24;m=I.g[0],_=I.g[1],E=I.g[2];var A=I.g[3],g=m+(A^_&(E^A))+v[0]+3614090360&4294967295;m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[1]+3905402710&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[2]+606105819&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[3]+3250441966&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[4]+4118548399&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[5]+1200080426&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[6]+2821735955&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[7]+4249261313&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[8]+1770035416&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[9]+2336552879&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[10]+4294925233&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[11]+2304563134&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(A^_&(E^A))+v[12]+1804603682&4294967295,m=_+(g<<7&4294967295|g>>>25),g=A+(E^m&(_^E))+v[13]+4254626195&4294967295,A=m+(g<<12&4294967295|g>>>20),g=E+(_^A&(m^_))+v[14]+2792965006&4294967295,E=A+(g<<17&4294967295|g>>>15),g=_+(m^E&(A^m))+v[15]+1236535329&4294967295,_=E+(g<<22&4294967295|g>>>10),g=m+(E^A&(_^E))+v[1]+4129170786&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[6]+3225465664&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[11]+643717713&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[0]+3921069994&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[5]+3593408605&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[10]+38016083&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[15]+3634488961&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[4]+3889429448&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[9]+568446438&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[14]+3275163606&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[3]+4107603335&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[8]+1163531501&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(E^A&(_^E))+v[13]+2850285829&4294967295,m=_+(g<<5&4294967295|g>>>27),g=A+(_^E&(m^_))+v[2]+4243563512&4294967295,A=m+(g<<9&4294967295|g>>>23),g=E+(m^_&(A^m))+v[7]+1735328473&4294967295,E=A+(g<<14&4294967295|g>>>18),g=_+(A^m&(E^A))+v[12]+2368359562&4294967295,_=E+(g<<20&4294967295|g>>>12),g=m+(_^E^A)+v[5]+4294588738&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[8]+2272392833&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[11]+1839030562&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[14]+4259657740&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[1]+2763975236&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[4]+1272893353&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[7]+4139469664&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[10]+3200236656&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[13]+681279174&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[0]+3936430074&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[3]+3572445317&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[6]+76029189&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(_^E^A)+v[9]+3654602809&4294967295,m=_+(g<<4&4294967295|g>>>28),g=A+(m^_^E)+v[12]+3873151461&4294967295,A=m+(g<<11&4294967295|g>>>21),g=E+(A^m^_)+v[15]+530742520&4294967295,E=A+(g<<16&4294967295|g>>>16),g=_+(E^A^m)+v[2]+3299628645&4294967295,_=E+(g<<23&4294967295|g>>>9),g=m+(E^(_|~A))+v[0]+4096336452&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[7]+1126891415&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[14]+2878612391&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[5]+4237533241&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[12]+1700485571&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[3]+2399980690&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[10]+4293915773&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[1]+2240044497&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[8]+1873313359&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[15]+4264355552&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[6]+2734768916&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[13]+1309151649&4294967295,_=E+(g<<21&4294967295|g>>>11),g=m+(E^(_|~A))+v[4]+4149444226&4294967295,m=_+(g<<6&4294967295|g>>>26),g=A+(_^(m|~E))+v[11]+3174756917&4294967295,A=m+(g<<10&4294967295|g>>>22),g=E+(m^(A|~_))+v[2]+718787259&4294967295,E=A+(g<<15&4294967295|g>>>17),g=_+(A^(E|~m))+v[9]+3951481745&4294967295,I.g[0]=I.g[0]+m&4294967295,I.g[1]=I.g[1]+(E+(g<<21&4294967295|g>>>11))&4294967295,I.g[2]=I.g[2]+E&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.u=function(I,m){m===void 0&&(m=I.length);for(var _=m-this.blockSize,v=this.B,E=this.h,A=0;A<m;){if(E==0)for(;A<=_;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<m;)if(v[E++]=I.charCodeAt(A++),E==this.blockSize){i(this,v),E=0;break}}else for(;A<m;)if(v[E++]=I[A++],E==this.blockSize){i(this,v),E=0;break}}this.h=E,this.o+=m},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var m=1;m<I.length-8;++m)I[m]=0;var _=8*this.o;for(m=I.length-8;m<I.length;++m)I[m]=_&255,_/=256;for(this.u(I),I=Array(16),m=_=0;4>m;++m)for(var v=0;32>v;v+=8)I[_++]=this.g[m]>>>v&255;return I};function o(I,m){var _=c;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=m(I)}function a(I,m){this.h=m;for(var _=[],v=!0,E=I.length-1;0<=E;E--){var A=I[E]|0;v&&A==m||(_[E]=A,v=!1)}this.g=_}var c={};function h(I){return-128<=I&&128>I?o(I,function(m){return new a([m|0],0>m?-1:0)}):new a([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return T;if(0>I)return k(d(-I));for(var m=[],_=1,v=0;I>=_;v++)m[v]=I/_|0,_*=4294967296;return new a(m,0)}function p(I,m){if(I.length==0)throw Error("number format error: empty string");if(m=m||10,2>m||36<m)throw Error("radix out of range: "+m);if(I.charAt(0)=="-")return k(p(I.substring(1),m));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(m,8)),v=T,E=0;E<I.length;E+=8){var A=Math.min(8,I.length-E),g=parseInt(I.substring(E,E+A),m);8>A?(A=d(Math.pow(m,A)),v=v.j(A).add(d(g))):(v=v.j(_),v=v.add(d(g)))}return v}var T=h(0),D=h(1),S=h(16777216);n=a.prototype,n.m=function(){if(O(this))return-k(this).m();for(var I=0,m=1,_=0;_<this.g.length;_++){var v=this.i(_);I+=(0<=v?v:4294967296+v)*m,m*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(N(this))return"0";if(O(this))return"-"+k(this).toString(I);for(var m=d(Math.pow(I,6)),_=this,v="";;){var E=ne(_,m).g;_=z(_,E.j(m));var A=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=E,N(_))return A+v;for(;6>A.length;)A="0"+A;v=A+v}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function N(I){if(I.h!=0)return!1;for(var m=0;m<I.g.length;m++)if(I.g[m]!=0)return!1;return!0}function O(I){return I.h==-1}n.l=function(I){return I=z(this,I),O(I)?-1:N(I)?0:1};function k(I){for(var m=I.g.length,_=[],v=0;v<m;v++)_[v]=~I.g[v];return new a(_,~I.h).add(D)}n.abs=function(){return O(this)?k(this):this},n.add=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0,E=0;E<=m;E++){var A=v+(this.i(E)&65535)+(I.i(E)&65535),g=(A>>>16)+(this.i(E)>>>16)+(I.i(E)>>>16);v=g>>>16,A&=65535,g&=65535,_[E]=g<<16|A}return new a(_,_[_.length-1]&-2147483648?-1:0)};function z(I,m){return I.add(k(m))}n.j=function(I){if(N(this)||N(I))return T;if(O(this))return O(I)?k(this).j(k(I)):k(k(this).j(I));if(O(I))return k(this.j(k(I)));if(0>this.l(S)&&0>I.l(S))return d(this.m()*I.m());for(var m=this.g.length+I.g.length,_=[],v=0;v<2*m;v++)_[v]=0;for(v=0;v<this.g.length;v++)for(var E=0;E<I.g.length;E++){var A=this.i(v)>>>16,g=this.i(v)&65535,rt=I.i(E)>>>16,Hn=I.i(E)&65535;_[2*v+2*E]+=g*Hn,j(_,2*v+2*E),_[2*v+2*E+1]+=A*Hn,j(_,2*v+2*E+1),_[2*v+2*E+1]+=g*rt,j(_,2*v+2*E+1),_[2*v+2*E+2]+=A*rt,j(_,2*v+2*E+2)}for(v=0;v<m;v++)_[v]=_[2*v+1]<<16|_[2*v];for(v=m;v<2*m;v++)_[v]=0;return new a(_,0)};function j(I,m){for(;(I[m]&65535)!=I[m];)I[m+1]+=I[m]>>>16,I[m]&=65535,m++}function G(I,m){this.g=I,this.h=m}function ne(I,m){if(N(m))throw Error("division by zero");if(N(I))return new G(T,T);if(O(I))return m=ne(k(I),m),new G(k(m.g),k(m.h));if(O(m))return m=ne(I,k(m)),new G(k(m.g),m.h);if(30<I.g.length){if(O(I)||O(m))throw Error("slowDivide_ only works with positive integers.");for(var _=D,v=m;0>=v.l(I);)_=be(_),v=be(v);var E=J(_,1),A=J(v,1);for(v=J(v,2),_=J(_,2);!N(v);){var g=A.add(v);0>=g.l(I)&&(E=E.add(_),A=g),v=J(v,1),_=J(_,1)}return m=z(I,E.j(m)),new G(E,m)}for(E=T;0<=I.l(m);){for(_=Math.max(1,Math.floor(I.m()/m.m())),v=Math.ceil(Math.log(_)/Math.LN2),v=48>=v?1:Math.pow(2,v-48),A=d(_),g=A.j(m);O(g)||0<g.l(I);)_-=v,A=d(_),g=A.j(m);N(A)&&(A=D),E=E.add(A),I=z(I,g)}return new G(E,I)}n.A=function(I){return ne(this,I).h},n.and=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)&I.i(v);return new a(_,this.h&I.h)},n.or=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)|I.i(v);return new a(_,this.h|I.h)},n.xor=function(I){for(var m=Math.max(this.g.length,I.g.length),_=[],v=0;v<m;v++)_[v]=this.i(v)^I.i(v);return new a(_,this.h^I.h)};function be(I){for(var m=I.g.length+1,_=[],v=0;v<m;v++)_[v]=I.i(v)<<1|I.i(v-1)>>>31;return new a(_,I.h)}function J(I,m){var _=m>>5;m%=32;for(var v=I.g.length-_,E=[],A=0;A<v;A++)E[A]=0<m?I.i(A+_)>>>m|I.i(A+_+1)<<32-m:I.i(A+_);return new a(E,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Ka=Xd.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Ft=Xd.Integer=a}).apply(typeof Jd<"u"?Jd:typeof self<"u"?self:typeof window<"u"?window:{});var cs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gt={};var Ha,Qv,An,Qa,Rr,ls,Ya,Ja,Xa;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(s,u,l){return s==Array.prototype||s==Object.prototype||(s[u]=l.value),s};function t(s){s=[typeof globalThis=="object"&&globalThis,s,typeof window=="object"&&window,typeof self=="object"&&self,typeof cs=="object"&&cs];for(var u=0;u<s.length;++u){var l=s[u];if(l&&l.Math==Math)return l}throw Error("Cannot find global object")}var r=t(this);function i(s,u){if(u)e:{var l=r;s=s.split(".");for(var f=0;f<s.length-1;f++){var w=s[f];if(!(w in l))break e;l=l[w]}s=s[s.length-1],f=l[s],u=u(f),u!=f&&u!=null&&e(l,s,{configurable:!0,writable:!0,value:u})}}function o(s,u){s instanceof String&&(s+="");var l=0,f=!1,w={next:function(){if(!f&&l<s.length){var b=l++;return{value:u(b,s[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return w[Symbol.iterator]=function(){return w},w}i("Array.prototype.values",function(s){return s||function(){return o(this,function(u,l){return l})}});var a=a||{},c=this||self;function h(s){var u=typeof s;return u=u!="object"?u:s?Array.isArray(s)?"array":u:"null",u=="array"||u=="object"&&typeof s.length=="number"}function d(s){var u=typeof s;return u=="object"&&s!=null||u=="function"}function p(s,u,l){return s.call.apply(s.bind,arguments)}function T(s,u,l){if(!s)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var w=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(w,f),s.apply(u,w)}}return function(){return s.apply(u,arguments)}}function D(s,u,l){return D=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:T,D.apply(null,arguments)}function S(s,u){var l=Array.prototype.slice.call(arguments,1);return function(){var f=l.slice();return f.push.apply(f,arguments),s.apply(this,f)}}function N(s,u){function l(){}l.prototype=u.prototype,s.aa=u.prototype,s.prototype=new l,s.prototype.constructor=s,s.Qb=function(f,w,b){for(var P=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)P[Z-2]=arguments[Z];return u.prototype[w].apply(f,P)}}function O(s){let u=s.length;if(0<u){let l=Array(u);for(let f=0;f<u;f++)l[f]=s[f];return l}return[]}function k(s,u){for(let l=1;l<arguments.length;l++){let f=arguments[l];if(h(f)){let w=s.length||0,b=f.length||0;s.length=w+b;for(let P=0;P<b;P++)s[w+P]=f[P]}else s.push(f)}}class z{constructor(u,l){this.i=u,this.j=l,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function j(s){return/^[\s\xa0]*$/.test(s)}function G(){var s=c.navigator;return s&&(s=s.userAgent)?s:""}function ne(s){return ne[" "](s),s}ne[" "]=function(){};var be=G().indexOf("Gecko")!=-1&&!(G().toLowerCase().indexOf("webkit")!=-1&&G().indexOf("Edge")==-1)&&!(G().indexOf("Trident")!=-1||G().indexOf("MSIE")!=-1)&&G().indexOf("Edge")==-1;function J(s,u,l){for(let f in s)u.call(l,s[f],f,s)}function I(s,u){for(let l in s)u.call(void 0,s[l],l,s)}function m(s){let u={};for(let l in s)u[l]=s[l];return u}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function v(s,u){let l,f;for(let w=1;w<arguments.length;w++){f=arguments[w];for(l in f)s[l]=f[l];for(let b=0;b<_.length;b++)l=_[b],Object.prototype.hasOwnProperty.call(f,l)&&(s[l]=f[l])}}function E(s){var u=1;s=s.split(":");let l=[];for(;0<u&&s.length;)l.push(s.shift()),u--;return s.length&&l.push(s.join(":")),l}function A(s){c.setTimeout(()=>{throw s},0)}function g(){var s=Xs;let u=null;return s.g&&(u=s.g,s.g=s.g.next,s.g||(s.h=null),u.next=null),u}class rt{constructor(){this.h=this.g=null}add(u,l){let f=Hn.get();f.set(u,l),this.h?this.h.next=f:this.g=f,this.h=f}}var Hn=new z(()=>new Up,s=>s.reset());class Up{constructor(){this.next=this.g=this.h=null}set(u,l){this.h=u,this.g=l,this.next=null}reset(){this.next=this.g=this.h=null}}let Qn,Yn=!1,Xs=new rt,rl=()=>{let s=c.Promise.resolve(void 0);Qn=()=>{s.then(Bp)}};var Bp=()=>{for(var s;s=g();){try{s.h.call(s.g)}catch(l){A(l)}var u=Hn;u.j(s),100>u.h&&(u.h++,s.next=u.g,u.g=s)}Yn=!1};function Et(){this.s=this.s,this.C=this.C}Et.prototype.s=!1,Et.prototype.ma=function(){this.s||(this.s=!0,this.N())},Et.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(s,u){this.type=s,this.g=this.target=u,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var $p=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var s=!1,u=Object.defineProperty({},"passive",{get:function(){s=!0}});try{let l=()=>{};c.addEventListener("test",l,u),c.removeEventListener("test",l,u)}catch{}return s}();function Jn(s,u){if(ve.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var l=this.type=s.type,f=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=u,u=s.relatedTarget){if(be){e:{try{ne(u.nodeName);var w=!0;break e}catch{}w=!1}w||(u=null)}}else l=="mouseover"?u=s.fromElement:l=="mouseout"&&(u=s.toElement);this.relatedTarget=u,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType=typeof s.pointerType=="string"?s.pointerType:qp[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&Jn.aa.h.call(this)}}N(Jn,ve);var qp={2:"touch",3:"pen",4:"mouse"};Jn.prototype.h=function(){Jn.aa.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var Xn="closure_listenable_"+(1e6*Math.random()|0),zp=0;function jp(s,u,l,f,w){this.listener=s,this.proxy=null,this.src=u,this.type=l,this.capture=!!f,this.ha=w,this.key=++zp,this.da=this.fa=!1}function Xr(s){s.da=!0,s.listener=null,s.proxy=null,s.src=null,s.ha=null}function Zr(s){this.src=s,this.g={},this.h=0}Zr.prototype.add=function(s,u,l,f,w){var b=s.toString();s=this.g[b],s||(s=this.g[b]=[],this.h++);var P=eo(s,u,f,w);return-1<P?(u=s[P],l||(u.fa=!1)):(u=new jp(u,this.src,b,!!f,w),u.fa=l,s.push(u)),u};function Zs(s,u){var l=u.type;if(l in s.g){var f=s.g[l],w=Array.prototype.indexOf.call(f,u,void 0),b;(b=0<=w)&&Array.prototype.splice.call(f,w,1),b&&(Xr(u),s.g[l].length==0&&(delete s.g[l],s.h--))}}function eo(s,u,l,f){for(var w=0;w<s.length;++w){var b=s[w];if(!b.da&&b.listener==u&&b.capture==!!l&&b.ha==f)return w}return-1}var to="closure_lm_"+(1e6*Math.random()|0),no={};function il(s,u,l,f,w){if(f&&f.once)return ol(s,u,l,f,w);if(Array.isArray(u)){for(var b=0;b<u.length;b++)il(s,u[b],l,f,w);return null}return l=oo(l),s&&s[Xn]?s.K(u,l,d(f)?!!f.capture:!!f,w):sl(s,u,l,!1,f,w)}function sl(s,u,l,f,w,b){if(!u)throw Error("Invalid event type");var P=d(w)?!!w.capture:!!w,Z=io(s);if(Z||(s[to]=Z=new Zr(s)),l=Z.add(u,l,f,P,b),l.proxy)return l;if(f=Gp(),l.proxy=f,f.src=s,f.listener=l,s.addEventListener)$p||(w=P),w===void 0&&(w=!1),s.addEventListener(u.toString(),f,w);else if(s.attachEvent)s.attachEvent(ul(u.toString()),f);else if(s.addListener&&s.removeListener)s.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return l}function Gp(){function s(l){return u.call(s.src,s.listener,l)}let u=Wp;return s}function ol(s,u,l,f,w){if(Array.isArray(u)){for(var b=0;b<u.length;b++)ol(s,u[b],l,f,w);return null}return l=oo(l),s&&s[Xn]?s.L(u,l,d(f)?!!f.capture:!!f,w):sl(s,u,l,!0,f,w)}function al(s,u,l,f,w){if(Array.isArray(u))for(var b=0;b<u.length;b++)al(s,u[b],l,f,w);else f=d(f)?!!f.capture:!!f,l=oo(l),s&&s[Xn]?(s=s.i,u=String(u).toString(),u in s.g&&(b=s.g[u],l=eo(b,l,f,w),-1<l&&(Xr(b[l]),Array.prototype.splice.call(b,l,1),b.length==0&&(delete s.g[u],s.h--)))):s&&(s=io(s))&&(u=s.g[u.toString()],s=-1,u&&(s=eo(u,l,f,w)),(l=-1<s?u[s]:null)&&ro(l))}function ro(s){if(typeof s!="number"&&s&&!s.da){var u=s.src;if(u&&u[Xn])Zs(u.i,s);else{var l=s.type,f=s.proxy;u.removeEventListener?u.removeEventListener(l,f,s.capture):u.detachEvent?u.detachEvent(ul(l),f):u.addListener&&u.removeListener&&u.removeListener(f),(l=io(u))?(Zs(l,s),l.h==0&&(l.src=null,u[to]=null)):Xr(s)}}}function ul(s){return s in no?no[s]:no[s]="on"+s}function Wp(s,u){if(s.da)s=!0;else{u=new Jn(u,this);var l=s.listener,f=s.ha||s.src;s.fa&&ro(s),s=l.call(f,u)}return s}function io(s){return s=s[to],s instanceof Zr?s:null}var so="__closure_events_fn_"+(1e9*Math.random()>>>0);function oo(s){return typeof s=="function"?s:(s[so]||(s[so]=function(u){return s.handleEvent(u)}),s[so])}function Ie(){Et.call(this),this.i=new Zr(this),this.M=this,this.F=null}N(Ie,Et),Ie.prototype[Xn]=!0,Ie.prototype.removeEventListener=function(s,u,l,f){al(this,s,u,l,f)};function Se(s,u){var l,f=s.F;if(f)for(l=[];f;f=f.F)l.push(f);if(s=s.M,f=u.type||u,typeof u=="string")u=new ve(u,s);else if(u instanceof ve)u.target=u.target||s;else{var w=u;u=new ve(f,s),v(u,w)}if(w=!0,l)for(var b=l.length-1;0<=b;b--){var P=u.g=l[b];w=ei(P,f,!0,u)&&w}if(P=u.g=s,w=ei(P,f,!0,u)&&w,w=ei(P,f,!1,u)&&w,l)for(b=0;b<l.length;b++)P=u.g=l[b],w=ei(P,f,!1,u)&&w}Ie.prototype.N=function(){if(Ie.aa.N.call(this),this.i){var s=this.i,u;for(u in s.g){for(var l=s.g[u],f=0;f<l.length;f++)Xr(l[f]);delete s.g[u],s.h--}}this.F=null},Ie.prototype.K=function(s,u,l,f){return this.i.add(String(s),u,!1,l,f)},Ie.prototype.L=function(s,u,l,f){return this.i.add(String(s),u,!0,l,f)};function ei(s,u,l,f){if(u=s.i.g[String(u)],!u)return!0;u=u.concat();for(var w=!0,b=0;b<u.length;++b){var P=u[b];if(P&&!P.da&&P.capture==l){var Z=P.listener,ge=P.ha||P.src;P.fa&&Zs(s.i,P),w=Z.call(ge,f)!==!1&&w}}return w&&!f.defaultPrevented}function cl(s,u,l){if(typeof s=="function")l&&(s=D(s,l));else if(s&&typeof s.handleEvent=="function")s=D(s.handleEvent,s);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(s,u||0)}function ll(s){s.g=cl(()=>{s.g=null,s.i&&(s.i=!1,ll(s))},s.l);let u=s.h;s.h=null,s.m.apply(null,u)}class Kp extends Et{constructor(u,l){super(),this.m=u,this.l=l,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:ll(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Zn(s){Et.call(this),this.h=s,this.g={}}N(Zn,Et);var hl=[];function dl(s){J(s.g,function(u,l){this.g.hasOwnProperty(l)&&ro(u)},s),s.g={}}Zn.prototype.N=function(){Zn.aa.N.call(this),dl(this)},Zn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ao=c.JSON.stringify,Hp=c.JSON.parse,Qp=class{stringify(s){return c.JSON.stringify(s,void 0)}parse(s){return c.JSON.parse(s,void 0)}};function uo(){}uo.prototype.h=null;function fl(s){return s.h||(s.h=s.i())}function pl(){}var er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function co(){ve.call(this,"d")}N(co,ve);function lo(){ve.call(this,"c")}N(lo,ve);var Ut={},ml=null;function ti(){return ml=ml||new Ie}Ut.La="serverreachability";function gl(s){ve.call(this,Ut.La,s)}N(gl,ve);function tr(s){let u=ti();Se(u,new gl(u))}Ut.STAT_EVENT="statevent";function _l(s,u){ve.call(this,Ut.STAT_EVENT,s),this.stat=u}N(_l,ve);function Ce(s){let u=ti();Se(u,new _l(u,s))}Ut.Ma="timingevent";function yl(s,u){ve.call(this,Ut.Ma,s),this.size=u}N(yl,ve);function nr(s,u){if(typeof s!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){s()},u)}function rr(){this.g=!0}rr.prototype.xa=function(){this.g=!1};function Yp(s,u,l,f,w,b){s.info(function(){if(s.g)if(b)for(var P="",Z=b.split("&"),ge=0;ge<Z.length;ge++){var K=Z[ge].split("=");if(1<K.length){var Ee=K[0];K=K[1];var we=Ee.split("_");P=2<=we.length&&we[1]=="type"?P+(Ee+"="+K+"&"):P+(Ee+"=redacted&")}}else P=null;else P=b;return"XMLHTTP REQ ("+f+") [attempt "+w+"]: "+u+`
`+l+`
`+P})}function Jp(s,u,l,f,w,b,P){s.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+w+"]: "+u+`
`+l+`
`+b+" "+P})}function fn(s,u,l,f){s.info(function(){return"XMLHTTP TEXT ("+u+"): "+Zp(s,l)+(f?" "+f:"")})}function Xp(s,u){s.info(function(){return"TIMEOUT: "+u})}rr.prototype.info=function(){};function Zp(s,u){if(!s.g)return u;if(!u)return null;try{var l=JSON.parse(u);if(l){for(s=0;s<l.length;s++)if(Array.isArray(l[s])){var f=l[s];if(!(2>f.length)){var w=f[1];if(Array.isArray(w)&&!(1>w.length)){var b=w[0];if(b!="noop"&&b!="stop"&&b!="close")for(var P=1;P<w.length;P++)w[P]=""}}}}return ao(l)}catch{return u}}var ni={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ho;function ri(){}N(ri,uo),ri.prototype.g=function(){return new XMLHttpRequest},ri.prototype.i=function(){return{}},ho=new ri;function wt(s,u,l,f){this.j=s,this.i=u,this.l=l,this.R=f||1,this.U=new Zn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Il}function Il(){this.i=null,this.g="",this.h=!1}var El={},fo={};function po(s,u,l){s.L=1,s.v=ai(it(u)),s.m=l,s.P=!0,wl(s,null)}function wl(s,u){s.F=Date.now(),ii(s),s.A=it(s.v);var l=s.A,f=s.R;Array.isArray(f)||(f=[String(f)]),Ll(l.i,"t",f),s.C=0,l=s.j.J,s.h=new Il,s.g=eh(s.j,l?u:null,!s.m),0<s.O&&(s.M=new Kp(D(s.Y,s,s.g),s.O)),u=s.U,l=s.g,f=s.ca;var w="readystatechange";Array.isArray(w)||(w&&(hl[0]=w.toString()),w=hl);for(var b=0;b<w.length;b++){var P=il(l,w[b],f||u.handleEvent,!1,u.h||u);if(!P)break;u.g[P.key]=P}u=s.H?m(s.H):{},s.m?(s.u||(s.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.m,u)):(s.u="GET",s.g.ea(s.A,s.u,null,u)),tr(),Yp(s.i,s.u,s.A,s.l,s.R,s.m)}wt.prototype.ca=function(s){s=s.target;let u=this.M;u&&st(s)==3?u.j():this.Y(s)},wt.prototype.Y=function(s){try{if(s==this.g)e:{let we=st(this.g);var u=this.g.Ba();let gn=this.g.Z();if(!(3>we)&&(we!=3||this.g&&(this.h.h||this.g.oa()||zl(this.g)))){this.J||we!=4||u==7||(u==8||0>=gn?tr(3):tr(2)),mo(this);var l=this.g.Z();this.X=l;t:if(Tl(this)){var f=zl(this.g);s="";var w=f.length,b=st(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Bt(this),ir(this);var P="";break t}this.h.i=new c.TextDecoder}for(u=0;u<w;u++)this.h.h=!0,s+=this.h.i.decode(f[u],{stream:!(b&&u==w-1)});f.length=0,this.h.g+=s,this.C=0,P=this.h.g}else P=this.g.oa();if(this.o=l==200,Jp(this.i,this.u,this.A,this.l,this.R,we,l),this.o){if(this.T&&!this.K){t:{if(this.g){var Z,ge=this.g;if((Z=ge.g?ge.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(Z)){var K=Z;break t}}K=null}if(l=K)fn(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,go(this,l);else{this.o=!1,this.s=3,Ce(12),Bt(this),ir(this);break e}}if(this.P){l=!0;let $e;for(;!this.J&&this.C<P.length;)if($e=em(this,P),$e==fo){we==4&&(this.s=4,Ce(14),l=!1),fn(this.i,this.l,null,"[Incomplete Response]");break}else if($e==El){this.s=4,Ce(15),fn(this.i,this.l,P,"[Invalid Chunk]"),l=!1;break}else fn(this.i,this.l,$e,null),go(this,$e);if(Tl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),we!=4||P.length!=0||this.h.h||(this.s=1,Ce(16),l=!1),this.o=this.o&&l,!l)fn(this.i,this.l,P,"[Invalid Chunked Response]"),Bt(this),ir(this);else if(0<P.length&&!this.W){this.W=!0;var Ee=this.j;Ee.g==this&&Ee.ba&&!Ee.M&&(Ee.j.info("Great, no buffering proxy detected. Bytes received: "+P.length),wo(Ee),Ee.M=!0,Ce(11))}}else fn(this.i,this.l,P,null),go(this,P);we==4&&Bt(this),this.o&&!this.J&&(we==4?Yl(this.j,this):(this.o=!1,ii(this)))}else _m(this.g),l==400&&0<P.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Bt(this),ir(this)}}}catch{}finally{}};function Tl(s){return s.g?s.u=="GET"&&s.L!=2&&s.j.Ca:!1}function em(s,u){var l=s.C,f=u.indexOf(`
`,l);return f==-1?fo:(l=Number(u.substring(l,f)),isNaN(l)?El:(f+=1,f+l>u.length?fo:(u=u.slice(f,f+l),s.C=f+l,u)))}wt.prototype.cancel=function(){this.J=!0,Bt(this)};function ii(s){s.S=Date.now()+s.I,Al(s,s.I)}function Al(s,u){if(s.B!=null)throw Error("WatchDog timer not null");s.B=nr(D(s.ba,s),u)}function mo(s){s.B&&(c.clearTimeout(s.B),s.B=null)}wt.prototype.ba=function(){this.B=null;let s=Date.now();0<=s-this.S?(Xp(this.i,this.A),this.L!=2&&(tr(),Ce(17)),Bt(this),this.s=2,ir(this)):Al(this,this.S-s)};function ir(s){s.j.G==0||s.J||Yl(s.j,s)}function Bt(s){mo(s);var u=s.M;u&&typeof u.ma=="function"&&u.ma(),s.M=null,dl(s.U),s.g&&(u=s.g,s.g=null,u.abort(),u.ma())}function go(s,u){try{var l=s.j;if(l.G!=0&&(l.g==s||_o(l.h,s))){if(!s.K&&_o(l.h,s)&&l.G==3){try{var f=l.Da.g.parse(u)}catch{f=null}if(Array.isArray(f)&&f.length==3){var w=f;if(w[0]==0){e:if(!l.u){if(l.g)if(l.g.F+3e3<s.F)di(l),li(l);else break e;Eo(l),Ce(18)}}else l.za=w[1],0<l.za-l.T&&37500>w[2]&&l.F&&l.v==0&&!l.C&&(l.C=nr(D(l.Za,l),6e3));if(1>=Sl(l.h)&&l.ca){try{l.ca()}catch{}l.ca=void 0}}else qt(l,11)}else if((s.K||l.g==s)&&di(l),!j(u))for(w=l.Da.g.parse(u),u=0;u<w.length;u++){let K=w[u];if(l.T=K[0],K=K[1],l.G==2)if(K[0]=="c"){l.K=K[1],l.ia=K[2];let Ee=K[3];Ee!=null&&(l.la=Ee,l.j.info("VER="+l.la));let we=K[4];we!=null&&(l.Aa=we,l.j.info("SVER="+l.Aa));let gn=K[5];gn!=null&&typeof gn=="number"&&0<gn&&(f=1.5*gn,l.L=f,l.j.info("backChannelRequestTimeoutMs_="+f)),f=l;let $e=s.g;if($e){let pi=$e.g?$e.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(pi){var b=f.h;b.g||pi.indexOf("spdy")==-1&&pi.indexOf("quic")==-1&&pi.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(yo(b,b.h),b.h=null))}if(f.D){let To=$e.g?$e.g.getResponseHeader("X-HTTP-Session-Id"):null;To&&(f.ya=To,re(f.I,f.D,To))}}l.G=3,l.l&&l.l.ua(),l.ba&&(l.R=Date.now()-s.F,l.j.info("Handshake RTT: "+l.R+"ms")),f=l;var P=s;if(f.qa=Zl(f,f.J?f.ia:null,f.W),P.K){Cl(f.h,P);var Z=P,ge=f.L;ge&&(Z.I=ge),Z.B&&(mo(Z),ii(Z)),f.g=P}else Hl(f);0<l.i.length&&hi(l)}else K[0]!="stop"&&K[0]!="close"||qt(l,7);else l.G==3&&(K[0]=="stop"||K[0]=="close"?K[0]=="stop"?qt(l,7):Io(l):K[0]!="noop"&&l.l&&l.l.ta(K),l.v=0)}}tr(4)}catch{}}var tm=class{constructor(s,u){this.g=s,this.map=u}};function Dl(s){this.l=s||10,c.PerformanceNavigationTiming?(s=c.performance.getEntriesByType("navigation"),s=0<s.length&&(s[0].nextHopProtocol=="hq"||s[0].nextHopProtocol=="h2")):s=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bl(s){return s.h?!0:s.g?s.g.size>=s.j:!1}function Sl(s){return s.h?1:s.g?s.g.size:0}function _o(s,u){return s.h?s.h==u:s.g?s.g.has(u):!1}function yo(s,u){s.g?s.g.add(u):s.h=u}function Cl(s,u){s.h&&s.h==u?s.h=null:s.g&&s.g.has(u)&&s.g.delete(u)}Dl.prototype.cancel=function(){if(this.i=Rl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let s of this.g.values())s.cancel();this.g.clear()}};function Rl(s){if(s.h!=null)return s.i.concat(s.h.D);if(s.g!=null&&s.g.size!==0){let u=s.i;for(let l of s.g.values())u=u.concat(l.D);return u}return O(s.i)}function nm(s){if(s.V&&typeof s.V=="function")return s.V();if(typeof Map<"u"&&s instanceof Map||typeof Set<"u"&&s instanceof Set)return Array.from(s.values());if(typeof s=="string")return s.split("");if(h(s)){for(var u=[],l=s.length,f=0;f<l;f++)u.push(s[f]);return u}u=[],l=0;for(f in s)u[l++]=s[f];return u}function rm(s){if(s.na&&typeof s.na=="function")return s.na();if(!s.V||typeof s.V!="function"){if(typeof Map<"u"&&s instanceof Map)return Array.from(s.keys());if(!(typeof Set<"u"&&s instanceof Set)){if(h(s)||typeof s=="string"){var u=[];s=s.length;for(var l=0;l<s;l++)u.push(l);return u}u=[],l=0;for(let f in s)u[l++]=f;return u}}}function Pl(s,u){if(s.forEach&&typeof s.forEach=="function")s.forEach(u,void 0);else if(h(s)||typeof s=="string")Array.prototype.forEach.call(s,u,void 0);else for(var l=rm(s),f=nm(s),w=f.length,b=0;b<w;b++)u.call(void 0,f[b],l&&l[b],s)}var kl=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function im(s,u){if(s){s=s.split("&");for(var l=0;l<s.length;l++){var f=s[l].indexOf("="),w=null;if(0<=f){var b=s[l].substring(0,f);w=s[l].substring(f+1)}else b=s[l];u(b,w?decodeURIComponent(w.replace(/\+/g," ")):"")}}}function $t(s){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,s instanceof $t){this.h=s.h,si(this,s.j),this.o=s.o,this.g=s.g,oi(this,s.s),this.l=s.l;var u=s.i,l=new ar;l.i=u.i,u.g&&(l.g=new Map(u.g),l.h=u.h),Nl(this,l),this.m=s.m}else s&&(u=String(s).match(kl))?(this.h=!1,si(this,u[1]||"",!0),this.o=sr(u[2]||""),this.g=sr(u[3]||"",!0),oi(this,u[4]),this.l=sr(u[5]||"",!0),Nl(this,u[6]||"",!0),this.m=sr(u[7]||"")):(this.h=!1,this.i=new ar(null,this.h))}$t.prototype.toString=function(){var s=[],u=this.j;u&&s.push(or(u,Ol,!0),":");var l=this.g;return(l||u=="file")&&(s.push("//"),(u=this.o)&&s.push(or(u,Ol,!0),"@"),s.push(encodeURIComponent(String(l)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l=this.s,l!=null&&s.push(":",String(l))),(l=this.l)&&(this.g&&l.charAt(0)!="/"&&s.push("/"),s.push(or(l,l.charAt(0)=="/"?am:om,!0))),(l=this.i.toString())&&s.push("?",l),(l=this.m)&&s.push("#",or(l,cm)),s.join("")};function it(s){return new $t(s)}function si(s,u,l){s.j=l?sr(u,!0):u,s.j&&(s.j=s.j.replace(/:$/,""))}function oi(s,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);s.s=u}else s.s=null}function Nl(s,u,l){u instanceof ar?(s.i=u,lm(s.i,s.h)):(l||(u=or(u,um)),s.i=new ar(u,s.h))}function re(s,u,l){s.i.set(u,l)}function ai(s){return re(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function sr(s,u){return s?u?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function or(s,u,l){return typeof s=="string"?(s=encodeURI(s).replace(u,sm),l&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function sm(s){return s=s.charCodeAt(0),"%"+(s>>4&15).toString(16)+(s&15).toString(16)}var Ol=/[#\/\?@]/g,om=/[#\?:]/g,am=/[#\?]/g,um=/[#\?@]/g,cm=/#/g;function ar(s,u){this.h=this.g=null,this.i=s||null,this.j=!!u}function Tt(s){s.g||(s.g=new Map,s.h=0,s.i&&im(s.i,function(u,l){s.add(decodeURIComponent(u.replace(/\+/g," ")),l)}))}n=ar.prototype,n.add=function(s,u){Tt(this),this.i=null,s=pn(this,s);var l=this.g.get(s);return l||this.g.set(s,l=[]),l.push(u),this.h+=1,this};function Fl(s,u){Tt(s),u=pn(s,u),s.g.has(u)&&(s.i=null,s.h-=s.g.get(u).length,s.g.delete(u))}function xl(s,u){return Tt(s),u=pn(s,u),s.g.has(u)}n.forEach=function(s,u){Tt(this),this.g.forEach(function(l,f){l.forEach(function(w){s.call(u,w,f,this)},this)},this)},n.na=function(){Tt(this);let s=Array.from(this.g.values()),u=Array.from(this.g.keys()),l=[];for(let f=0;f<u.length;f++){let w=s[f];for(let b=0;b<w.length;b++)l.push(u[f])}return l},n.V=function(s){Tt(this);let u=[];if(typeof s=="string")xl(this,s)&&(u=u.concat(this.g.get(pn(this,s))));else{s=Array.from(this.g.values());for(let l=0;l<s.length;l++)u=u.concat(s[l])}return u},n.set=function(s,u){return Tt(this),this.i=null,s=pn(this,s),xl(this,s)&&(this.h-=this.g.get(s).length),this.g.set(s,[u]),this.h+=1,this},n.get=function(s,u){return s?(s=this.V(s),0<s.length?String(s[0]):u):u};function Ll(s,u,l){Fl(s,u),0<l.length&&(s.i=null,s.g.set(pn(s,u),O(l)),s.h+=l.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let s=[],u=Array.from(this.g.keys());for(var l=0;l<u.length;l++){var f=u[l];let b=encodeURIComponent(String(f)),P=this.V(f);for(f=0;f<P.length;f++){var w=b;P[f]!==""&&(w+="="+encodeURIComponent(String(P[f]))),s.push(w)}}return this.i=s.join("&")};function pn(s,u){return u=String(u),s.j&&(u=u.toLowerCase()),u}function lm(s,u){u&&!s.j&&(Tt(s),s.i=null,s.g.forEach(function(l,f){var w=f.toLowerCase();f!=w&&(Fl(this,f),Ll(this,w,l))},s)),s.j=u}function hm(s,u){let l=new rr;if(c.Image){let f=new Image;f.onload=S(At,l,"TestLoadImage: loaded",!0,u,f),f.onerror=S(At,l,"TestLoadImage: error",!1,u,f),f.onabort=S(At,l,"TestLoadImage: abort",!1,u,f),f.ontimeout=S(At,l,"TestLoadImage: timeout",!1,u,f),c.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=s}else u(!1)}function dm(s,u){let l=new rr,f=new AbortController,w=setTimeout(()=>{f.abort(),At(l,"TestPingServer: timeout",!1,u)},1e4);fetch(s,{signal:f.signal}).then(b=>{clearTimeout(w),b.ok?At(l,"TestPingServer: ok",!0,u):At(l,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(w),At(l,"TestPingServer: error",!1,u)})}function At(s,u,l,f,w){try{w&&(w.onload=null,w.onerror=null,w.onabort=null,w.ontimeout=null),f(l)}catch{}}function fm(){this.g=new Qp}function pm(s,u,l){let f=l||"";try{Pl(s,function(w,b){let P=w;d(w)&&(P=ao(w)),u.push(f+b+"="+encodeURIComponent(P))})}catch(w){throw u.push(f+"type="+encodeURIComponent("_badmap")),w}}function ur(s){this.l=s.Ub||null,this.j=s.eb||!1}N(ur,uo),ur.prototype.g=function(){return new ui(this.l,this.j)},ur.prototype.i=function(s){return function(){return s}}({});function ui(s,u){Ie.call(this),this.D=s,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ui,Ie),n=ui.prototype,n.open=function(s,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=s,this.A=u,this.readyState=1,lr(this)},n.send=function(s){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};s&&(u.body=s),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,cr(this)),this.readyState=0},n.Sa=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,lr(this)),this.g&&(this.readyState=3,lr(this),this.g)))if(this.responseType==="arraybuffer")s.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in s){if(this.j=s.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vl(this)}else s.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vl(s){s.j.read().then(s.Pa.bind(s)).catch(s.ga.bind(s))}n.Pa=function(s){if(this.g){if(this.o&&s.value)this.response.push(s.value);else if(!this.o){var u=s.value?s.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!s.done}))&&(this.response=this.responseText+=u)}s.done?cr(this):lr(this),this.readyState==3&&Vl(this)}},n.Ra=function(s){this.g&&(this.response=this.responseText=s,cr(this))},n.Qa=function(s){this.g&&(this.response=s,cr(this))},n.ga=function(){this.g&&cr(this)};function cr(s){s.readyState=4,s.l=null,s.j=null,s.v=null,lr(s)}n.setRequestHeader=function(s,u){this.u.append(s,u)},n.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let s=[],u=this.h.entries();for(var l=u.next();!l.done;)l=l.value,s.push(l[0]+": "+l[1]),l=u.next();return s.join(`\r
`)};function lr(s){s.onreadystatechange&&s.onreadystatechange.call(s)}Object.defineProperty(ui.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(s){this.m=s?"include":"same-origin"}});function Ml(s){let u="";return J(s,function(l,f){u+=f,u+=":",u+=l,u+=`\r
`}),u}function vo(s,u,l){e:{for(f in l){var f=!1;break e}f=!0}f||(l=Ml(l),typeof s=="string"?l!=null&&encodeURIComponent(String(l)):re(s,u,l))}function se(s){Ie.call(this),this.headers=new Map,this.o=s||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(se,Ie);var mm=/^https?$/i,gm=["POST","PUT"];n=se.prototype,n.Ha=function(s){this.J=s},n.ea=function(s,u,l,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+s);u=u?u.toUpperCase():"GET",this.D=s,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ho.g(),this.v=this.o?fl(this.o):fl(ho),this.g.onreadystatechange=D(this.Ea,this);try{this.B=!0,this.g.open(u,String(s),!0),this.B=!1}catch(b){Ul(this,b);return}if(s=l||"",l=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var w in f)l.set(w,f[w]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())l.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(l.keys()).find(b=>b.toLowerCase()=="content-type"),w=c.FormData&&s instanceof c.FormData,!(0<=Array.prototype.indexOf.call(gm,u,void 0))||f||w||l.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,P]of l)this.g.setRequestHeader(b,P);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ql(this),this.u=!0,this.g.send(s),this.u=!1}catch(b){Ul(this,b)}};function Ul(s,u){s.h=!1,s.g&&(s.j=!0,s.g.abort(),s.j=!1),s.l=u,s.m=5,Bl(s),ci(s)}function Bl(s){s.A||(s.A=!0,Se(s,"complete"),Se(s,"error"))}n.abort=function(s){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=s||7,Se(this,"complete"),Se(this,"abort"),ci(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ci(this,!0)),se.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?$l(this):this.bb())},n.bb=function(){$l(this)};function $l(s){if(s.h&&typeof a<"u"&&(!s.v[1]||st(s)!=4||s.Z()!=2)){if(s.u&&st(s)==4)cl(s.Ea,0,s);else if(Se(s,"readystatechange"),st(s)==4){s.h=!1;try{let P=s.Z();e:switch(P){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var l;if(!(l=u)){var f;if(f=P===0){var w=String(s.D).match(kl)[1]||null;!w&&c.self&&c.self.location&&(w=c.self.location.protocol.slice(0,-1)),f=!mm.test(w?w.toLowerCase():"")}l=f}if(l)Se(s,"complete"),Se(s,"success");else{s.m=6;try{var b=2<st(s)?s.g.statusText:""}catch{b=""}s.l=b+" ["+s.Z()+"]",Bl(s)}}finally{ci(s)}}}}function ci(s,u){if(s.g){ql(s);let l=s.g,f=s.v[0]?()=>{}:null;s.g=null,s.v=null,u||Se(s,"ready");try{l.onreadystatechange=f}catch{}}}function ql(s){s.I&&(c.clearTimeout(s.I),s.I=null)}n.isActive=function(){return!!this.g};function st(s){return s.g?s.g.readyState:0}n.Z=function(){try{return 2<st(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(s){if(this.g){var u=this.g.responseText;return s&&u.indexOf(s)==0&&(u=u.substring(s.length)),Hp(u)}};function zl(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.H){case"":case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch{return null}}function _m(s){let u={};s=(s.g&&2<=st(s)&&s.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<s.length;f++){if(j(s[f]))continue;var l=E(s[f]);let w=l[0];if(l=l[1],typeof l!="string")continue;l=l.trim();let b=u[w]||[];u[w]=b,b.push(l)}I(u,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hr(s,u,l){return l&&l.internalChannelParams&&l.internalChannelParams[s]||u}function jl(s){this.Aa=0,this.i=[],this.j=new rr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hr("failFast",!1,s),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hr("baseRetryDelayMs",5e3,s),this.cb=hr("retryDelaySeedMs",1e4,s),this.Wa=hr("forwardChannelMaxRetries",2,s),this.wa=hr("forwardChannelRequestTimeoutMs",2e4,s),this.pa=s&&s.xmlHttpFactory||void 0,this.Xa=s&&s.Tb||void 0,this.Ca=s&&s.useFetchStreams||!1,this.L=void 0,this.J=s&&s.supportsCrossDomainXhr||!1,this.K="",this.h=new Dl(s&&s.concurrentRequestLimit),this.Da=new fm,this.P=s&&s.fastHandshake||!1,this.O=s&&s.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=s&&s.Rb||!1,s&&s.xa&&this.j.xa(),s&&s.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&s&&s.detectBufferingProxy||!1,this.ja=void 0,s&&s.longPollingTimeout&&0<s.longPollingTimeout&&(this.ja=s.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=jl.prototype,n.la=8,n.G=1,n.connect=function(s,u,l,f){Ce(0),this.W=s,this.H=u||{},l&&f!==void 0&&(this.H.OSID=l,this.H.OAID=f),this.F=this.X,this.I=Zl(this,null,this.W),hi(this)};function Io(s){if(Gl(s),s.G==3){var u=s.U++,l=it(s.I);if(re(l,"SID",s.K),re(l,"RID",u),re(l,"TYPE","terminate"),dr(s,l),u=new wt(s,s.j,u),u.L=2,u.v=ai(it(l)),l=!1,c.navigator&&c.navigator.sendBeacon)try{l=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!l&&c.Image&&(new Image().src=u.v,l=!0),l||(u.g=eh(u.j,null),u.g.ea(u.v)),u.F=Date.now(),ii(u)}Xl(s)}function li(s){s.g&&(wo(s),s.g.cancel(),s.g=null)}function Gl(s){li(s),s.u&&(c.clearTimeout(s.u),s.u=null),di(s),s.h.cancel(),s.s&&(typeof s.s=="number"&&c.clearTimeout(s.s),s.s=null)}function hi(s){if(!bl(s.h)&&!s.s){s.s=!0;var u=s.Ga;Qn||rl(),Yn||(Qn(),Yn=!0),Xs.add(u,s),s.B=0}}function ym(s,u){return Sl(s.h)>=s.h.j-(s.s?1:0)?!1:s.s?(s.i=u.D.concat(s.i),!0):s.G==1||s.G==2||s.B>=(s.Va?0:s.Wa)?!1:(s.s=nr(D(s.Ga,s,u),Jl(s,s.B)),s.B++,!0)}n.Ga=function(s){if(this.s)if(this.s=null,this.G==1){if(!s){this.U=Math.floor(1e5*Math.random()),s=this.U++;let w=new wt(this,this.j,s),b=this.o;if(this.S&&(b?(b=m(b),v(b,this.S)):b=this.S),this.m!==null||this.O||(w.H=b,b=null),this.P)e:{for(var u=0,l=0;l<this.i.length;l++){t:{var f=this.i[l];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(u+=f,4096<u){u=l;break e}if(u===4096||l===this.i.length-1){u=l+1;break e}}u=1e3}else u=1e3;u=Kl(this,w,u),l=it(this.I),re(l,"RID",s),re(l,"CVER",22),this.D&&re(l,"X-HTTP-Session-Id",this.D),dr(this,l),b&&(this.O?u="headers="+encodeURIComponent(String(Ml(b)))+"&"+u:this.m&&vo(l,this.m,b)),yo(this.h,w),this.Ua&&re(l,"TYPE","init"),this.P?(re(l,"$req",u),re(l,"SID","null"),w.T=!0,po(w,l,null)):po(w,l,u),this.G=2}}else this.G==3&&(s?Wl(this,s):this.i.length==0||bl(this.h)||Wl(this))};function Wl(s,u){var l;u?l=u.l:l=s.U++;let f=it(s.I);re(f,"SID",s.K),re(f,"RID",l),re(f,"AID",s.T),dr(s,f),s.m&&s.o&&vo(f,s.m,s.o),l=new wt(s,s.j,l,s.B+1),s.m===null&&(l.H=s.o),u&&(s.i=u.D.concat(s.i)),u=Kl(s,l,1e3),l.I=Math.round(.5*s.wa)+Math.round(.5*s.wa*Math.random()),yo(s.h,l),po(l,f,u)}function dr(s,u){s.H&&J(s.H,function(l,f){re(u,f,l)}),s.l&&Pl({},function(l,f){re(u,f,l)})}function Kl(s,u,l){l=Math.min(s.i.length,l);var f=s.l?D(s.l.Na,s.l,s):null;e:{var w=s.i;let b=-1;for(;;){let P=["count="+l];b==-1?0<l?(b=w[0].g,P.push("ofs="+b)):b=0:P.push("ofs="+b);let Z=!0;for(let ge=0;ge<l;ge++){let K=w[ge].g,Ee=w[ge].map;if(K-=b,0>K)b=Math.max(0,w[ge].g-100),Z=!1;else try{pm(Ee,P,"req"+K+"_")}catch{f&&f(Ee)}}if(Z){f=P.join("&");break e}}}return s=s.i.splice(0,l),u.D=s,f}function Hl(s){if(!s.g&&!s.u){s.Y=1;var u=s.Fa;Qn||rl(),Yn||(Qn(),Yn=!0),Xs.add(u,s),s.v=0}}function Eo(s){return s.g||s.u||3<=s.v?!1:(s.Y++,s.u=nr(D(s.Fa,s),Jl(s,s.v)),s.v++,!0)}n.Fa=function(){if(this.u=null,Ql(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var s=2*this.R;this.j.info("BP detection timer enabled: "+s),this.A=nr(D(this.ab,this),s)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),li(this),Ql(this))};function wo(s){s.A!=null&&(c.clearTimeout(s.A),s.A=null)}function Ql(s){s.g=new wt(s,s.j,"rpc",s.Y),s.m===null&&(s.g.H=s.o),s.g.O=0;var u=it(s.qa);re(u,"RID","rpc"),re(u,"SID",s.K),re(u,"AID",s.T),re(u,"CI",s.F?"0":"1"),!s.F&&s.ja&&re(u,"TO",s.ja),re(u,"TYPE","xmlhttp"),dr(s,u),s.m&&s.o&&vo(u,s.m,s.o),s.L&&(s.g.I=s.L);var l=s.g;s=s.ia,l.L=1,l.v=ai(it(u)),l.m=null,l.P=!0,wl(l,s)}n.Za=function(){this.C!=null&&(this.C=null,li(this),Eo(this),Ce(19))};function di(s){s.C!=null&&(c.clearTimeout(s.C),s.C=null)}function Yl(s,u){var l=null;if(s.g==u){di(s),wo(s),s.g=null;var f=2}else if(_o(s.h,u))l=u.D,Cl(s.h,u),f=1;else return;if(s.G!=0){if(u.o)if(f==1){l=u.m?u.m.length:0,u=Date.now()-u.F;var w=s.B;f=ti(),Se(f,new yl(f,l)),hi(s)}else Hl(s);else if(w=u.s,w==3||w==0&&0<u.X||!(f==1&&ym(s,u)||f==2&&Eo(s)))switch(l&&0<l.length&&(u=s.h,u.i=u.i.concat(l)),w){case 1:qt(s,5);break;case 4:qt(s,10);break;case 3:qt(s,6);break;default:qt(s,2)}}}function Jl(s,u){let l=s.Ta+Math.floor(Math.random()*s.cb);return s.isActive()||(l*=2),l*u}function qt(s,u){if(s.j.info("Error code "+u),u==2){var l=D(s.fb,s),f=s.Xa;let w=!f;f=new $t(f||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||si(f,"https"),ai(f),w?hm(f.toString(),l):dm(f.toString(),l)}else Ce(2);s.G=0,s.l&&s.l.sa(u),Xl(s),Gl(s)}n.fb=function(s){s?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))};function Xl(s){if(s.G=0,s.ka=[],s.l){let u=Rl(s.h);(u.length!=0||s.i.length!=0)&&(k(s.ka,u),k(s.ka,s.i),s.h.i.length=0,O(s.i),s.i.length=0),s.l.ra()}}function Zl(s,u,l){var f=l instanceof $t?it(l):new $t(l);if(f.g!="")u&&(f.g=u+"."+f.g),oi(f,f.s);else{var w=c.location;f=w.protocol,u=u?u+"."+w.hostname:w.hostname,w=+w.port;var b=new $t(null);f&&si(b,f),u&&(b.g=u),w&&oi(b,w),l&&(b.l=l),f=b}return l=s.D,u=s.ya,l&&u&&re(f,l,u),re(f,"VER",s.la),dr(s,f),f}function eh(s,u,l){if(u&&!s.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=s.Ca&&!s.pa?new se(new ur({eb:l})):new se(s.pa),u.Ha(s.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function th(){}n=th.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function fi(){}fi.prototype.g=function(s,u){return new Pe(s,u)};function Pe(s,u){Ie.call(this),this.g=new jl(u),this.l=s,this.h=u&&u.messageUrlParams||null,s=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.o=s,s=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(s?s["X-WebChannel-Content-Type"]=u.messageContentType:s={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(s?s["X-WebChannel-Client-Profile"]=u.va:s={"X-WebChannel-Client-Profile":u.va}),this.g.S=s,(s=u&&u.Sb)&&!j(s)&&(this.g.m=s),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!j(u)&&(this.g.D=u,s=this.h,s!==null&&u in s&&(s=this.h,u in s&&delete s[u])),this.j=new mn(this)}N(Pe,Ie),Pe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Pe.prototype.close=function(){Io(this.g)},Pe.prototype.o=function(s){var u=this.g;if(typeof s=="string"){var l={};l.__data__=s,s=l}else this.u&&(l={},l.__data__=ao(s),s=l);u.i.push(new tm(u.Ya++,s)),u.G==3&&hi(u)},Pe.prototype.N=function(){this.g.l=null,delete this.j,Io(this.g),delete this.g,Pe.aa.N.call(this)};function nh(s){co.call(this),s.__headers__&&(this.headers=s.__headers__,this.statusCode=s.__status__,delete s.__headers__,delete s.__status__);var u=s.__sm__;if(u){e:{for(let l in u){s=l;break e}s=void 0}(this.i=s)&&(s=this.i,u=u!==null&&s in u?u[s]:void 0),this.data=u}else this.data=s}N(nh,co);function rh(){lo.call(this),this.status=1}N(rh,lo);function mn(s){this.g=s}N(mn,th),mn.prototype.ua=function(){Se(this.g,"a")},mn.prototype.ta=function(s){Se(this.g,new nh(s))},mn.prototype.sa=function(s){Se(this.g,new rh)},mn.prototype.ra=function(){Se(this.g,"b")},fi.prototype.createWebChannel=fi.prototype.g,Pe.prototype.send=Pe.prototype.o,Pe.prototype.open=Pe.prototype.m,Pe.prototype.close=Pe.prototype.close,Xa=gt.createWebChannelTransport=function(){return new fi},Ja=gt.getStatEventTarget=function(){return ti()},Ya=gt.Event=Ut,ls=gt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ni.NO_ERROR=0,ni.TIMEOUT=8,ni.HTTP_ERROR=6,Rr=gt.ErrorCode=ni,vl.COMPLETE="complete",Qa=gt.EventType=vl,pl.EventType=er,er.OPEN="a",er.CLOSE="b",er.ERROR="c",er.MESSAGE="d",Ie.prototype.listen=Ie.prototype.K,An=gt.WebChannel=pl,Qv=gt.FetchXmlHttpFactory=ur,se.prototype.listenOnce=se.prototype.L,se.prototype.getLastError=se.prototype.Ka,se.prototype.getLastErrorCode=se.prototype.Ba,se.prototype.getStatus=se.prototype.Z,se.prototype.getResponseJson=se.prototype.Oa,se.prototype.getResponseText=se.prototype.oa,se.prototype.send=se.prototype.ea,se.prototype.setWithCredentials=se.prototype.Ha,Ha=gt.XhrIo=se}).apply(typeof cs<"u"?cs:typeof self<"u"?self:typeof window<"u"?window:{});var Zd="@firebase/firestore";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var Wn="10.14.0";var nn=new Ct("@firebase/firestore");function Pr(){return nn.logLevel}function F(n,...e){if(nn.logLevel<=$.DEBUG){let t=e.map(Lc);nn.debug(`Firestore (${Wn}): ${n}`,...t)}}function yt(n,...e){if(nn.logLevel<=$.ERROR){let t=e.map(Lc);nn.error(`Firestore (${Wn}): ${n}`,...t)}}function Nn(n,...e){if(nn.logLevel<=$.WARN){let t=e.map(Lc);nn.warn(`Firestore (${Wn}): ${n}`,...t)}}function Lc(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function V(n="Unexpected state"){let e=`FIRESTORE (${Wn}) INTERNAL ASSERTION FAILED: `+n;throw yt(e),new Error(e)}function X(n,e){n||V()}function U(n,e){return n}var C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends Ne{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ye=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var ms=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},ru=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(me.UNAUTHENTICATED))}shutdown(){}},iu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},su=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){X(this.o===void 0);let r=this.i,i=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve(),o=new Ye;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ye,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let h=o;e.enqueueRetryable(()=>y(this,null,function*(){yield h.promise,yield i(this.currentUser)}))},c=h=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(h=>c(h)),setTimeout(()=>{if(!this.auth){let h=this.t.getImmediate({optional:!0});h?c(h):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ye)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(X(typeof r.accessToken=="string"),new ms(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return X(e===null||typeof e=="string"),new me(e)}},ou=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},au=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ou(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(me.FIRST_PARTY))}shutdown(){}invalidateToken(){}},uu=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},cu=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){X(this.o===void 0);let r=o=>{o.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let a=o.token!==this.R;return this.R=o.token,F("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.A.getImmediate({optional:!0});o?i(o):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(X(typeof t.token=="string"),this.R=t.token,new uu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Yv(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var gs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Yv(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}};function H(n,e){return n<e?-1:n>e?1:0}function On(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ye=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?H(this.nanoseconds,e.nanoseconds):H(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ye(0,0))}static max(){return new n(new ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var _s=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&V(),r===void 0?r=e.length-t:r>e.length-t&&V(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=e.get(i),a=t.get(i);if(o<a)return-1;if(o>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},oe=class n extends _s{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(C.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Jv=/^[_a-zA-Z][_a-zA-Z0-9]*$/,xe=class n extends _s{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Jv.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new x(C.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new x(C.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new x(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(o(),i++)}if(o(),a)throw new x(C.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(oe.fromString(e))}static fromName(e){return new n(oe.fromString(e).popFirst(5))}static empty(){return new n(oe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&oe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return oe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new oe(e.slice()))}};var lu=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};lu.UNKNOWN_ID=-1;function Xv(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new ye(t+1,0):new ye(t,r));return new rn(i,L.empty(),e)}function Zv(n){return new rn(n.readTime,n.key,-1)}var rn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(B.min(),L.empty(),-1)}static max(){return new n(B.max(),L.empty(),-1)}};function eI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:H(n.largestBatchId,e.largestBatchId))}var tI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",hu=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Hr(n){return y(this,null,function*(){if(n.code!==C.FAILED_PRECONDITION||n.message!==tI)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&V(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++o,a&&o===i&&t()},h=>r(h))}),a=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,a=new Array(o),c=0;for(let h=0;h<o;h++){let d=h;t(e[d]).next(p=>{a[d]=p,++c,c===o&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function nI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Qr(n){return n.name==="IndexedDbTransactionError"}var kf=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function js(n){return n==null}function Lr(n){return n===0&&1/n==-1/0}function rI(n){return typeof n=="number"&&Number.isInteger(n)&&!Lr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var iI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],UT=[...iI,"documentOverlays"],sI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],oI=sI,aI=[...oI,"indexConfiguration","indexState","indexEntries"];var BT=[...aI,"globals"];function ef(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function hn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Nf(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var ae=class n{constructor(e,t){this.comparator=e,this.root=t||Je.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Je.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Je.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cn(this.root,e,this.comparator,!0)}},Cn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Je=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw V();let e=this.left.check();if(e!==this.right.check())throw V();return e+(this.isRed()?0:1)}};Je.EMPTY=null,Je.RED=!0,Je.BLACK=!1;Je.EMPTY=new class{constructor(){this.size=0}get key(){throw V()}get value(){throw V()}get color(){throw V()}get left(){throw V()}get right(){throw V()}copy(e,t,r,i,o){return this}insert(e,t,r){return new Je(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ae=class n{constructor(e){this.comparator=e,this.data=new ae(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ys(this.data.getIterator())}getIteratorFrom(e){return new ys(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},ys=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ue=class n{constructor(e){this.fields=e,e.sort(xe.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ae(xe.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return On(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var vs=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var De=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new vs("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let a=0;a<i.length;++a)o+=String.fromCharCode(i[a]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return H(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};De.EMPTY_BYTE_STRING=new De("");var uI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vt(n){if(X(!!n),typeof n=="string"){let e=0,t=uI.exec(n);if(X(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ie(n.seconds),nanos:ie(n.nanos)}}function ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Lt(n){return typeof n=="string"?De.fromBase64String(n):De.fromUint8Array(n)}function Vc(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Mc(n){let e=n.mapValue.fields.__previous_value__;return Vc(e)?Mc(e):e}function Vr(n){let e=vt(n.mapValue.fields.__local_write_time__.timestampValue);return new ye(e.seconds,e.nanos)}var du=class{constructor(e,t,r,i,o,a,c,h,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=h,this.useFetchStreams=d}},Is=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var hs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function sn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Vc(n)?4:Ff(n)?9007199254740991:Of(n)?10:11:V()}function et(n,e){if(n===e)return!0;let t=sn(n);if(t!==sn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Vr(n).isEqual(Vr(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let a=vt(i.timestampValue),c=vt(o.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return Lt(i.bytesValue).isEqual(Lt(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return ie(i.geoPointValue.latitude)===ie(o.geoPointValue.latitude)&&ie(i.geoPointValue.longitude)===ie(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return ie(i.integerValue)===ie(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let a=ie(i.doubleValue),c=ie(o.doubleValue);return a===c?Lr(a)===Lr(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return On(n.arrayValue.values||[],e.arrayValue.values||[],et);case 10:case 11:return function(i,o){let a=i.mapValue.fields||{},c=o.mapValue.fields||{};if(ef(a)!==ef(c))return!1;for(let h in a)if(a.hasOwnProperty(h)&&(c[h]===void 0||!et(a[h],c[h])))return!1;return!0}(n,e);default:return V()}}function Mr(n,e){return(n.values||[]).find(t=>et(t,e))!==void 0}function Fn(n,e){if(n===e)return 0;let t=sn(n),r=sn(e);if(t!==r)return H(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return H(n.booleanValue,e.booleanValue);case 2:return function(o,a){let c=ie(o.integerValue||o.doubleValue),h=ie(a.integerValue||a.doubleValue);return c<h?-1:c>h?1:c===h?0:isNaN(c)?isNaN(h)?0:-1:1}(n,e);case 3:return tf(n.timestampValue,e.timestampValue);case 4:return tf(Vr(n),Vr(e));case 5:return H(n.stringValue,e.stringValue);case 6:return function(o,a){let c=Lt(o),h=Lt(a);return c.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){let c=o.split("/"),h=a.split("/");for(let d=0;d<c.length&&d<h.length;d++){let p=H(c[d],h[d]);if(p!==0)return p}return H(c.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){let c=H(ie(o.latitude),ie(a.latitude));return c!==0?c:H(ie(o.longitude),ie(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return nf(n.arrayValue,e.arrayValue);case 10:return function(o,a){var c,h,d,p;let T=o.fields||{},D=a.fields||{},S=(c=T.value)===null||c===void 0?void 0:c.arrayValue,N=(h=D.value)===null||h===void 0?void 0:h.arrayValue,O=H(((d=S?.values)===null||d===void 0?void 0:d.length)||0,((p=N?.values)===null||p===void 0?void 0:p.length)||0);return O!==0?O:nf(S,N)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===hs.mapValue&&a===hs.mapValue)return 0;if(o===hs.mapValue)return 1;if(a===hs.mapValue)return-1;let c=o.fields||{},h=Object.keys(c),d=a.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let T=0;T<h.length&&T<p.length;++T){let D=H(h[T],p[T]);if(D!==0)return D;let S=Fn(c[h[T]],d[p[T]]);if(S!==0)return S}return H(h.length,p.length)}(n.mapValue,e.mapValue);default:throw V()}}function tf(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return H(n,e);let t=vt(n),r=vt(e),i=H(t.seconds,r.seconds);return i!==0?i:H(t.nanos,r.nanos)}function nf(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Fn(t[i],r[i]);if(o)return o}return H(t.length,r.length)}function xn(n){return fu(n)}function fu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=vt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Lt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=fu(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let a of r)o?o=!1:i+=",",i+=`${a}:${fu(t.fields[a])}`;return i+"}"}(n.mapValue):V()}function pu(n){return!!n&&"integerValue"in n}function Uc(n){return!!n&&"arrayValue"in n}function rf(n){return!!n&&"nullValue"in n}function sf(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function fs(n){return!!n&&"mapValue"in n}function Of(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Nr(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return hn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Nr(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nr(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ff(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Fe=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!fs(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nr(t)}setAll(e){let t=xe.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let h=this.getFieldsMap(t);this.applyChanges(h,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=Nr(a):i.push(c.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());fs(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return et(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];fs(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){hn(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(Nr(this.value))}};function xf(n){let e=[];return hn(n.fields,(t,r)=>{let i=new xe([t]);if(fs(r)){let o=xf(r.mapValue).fields;if(o.length===0)e.push(i);else for(let a of o)e.push(i.child(a))}else e.push(i)}),new Ue(e)}var je=class n{constructor(e,t,r,i,o,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,B.min(),B.min(),B.min(),Fe.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,B.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,B.min(),B.min(),Fe.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,B.min(),B.min(),Fe.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fe.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ln=class{constructor(e,t){this.position=e,this.inclusive=t}};function of(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],a=n.position[i];if(o.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=Fn(a,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function af(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!et(n.position[t],e.position[t]))return!1;return!0}var Vn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function cI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Es=class{},de=class n extends Es{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new gu(e,t,r):t==="array-contains"?new vu(e,r):t==="in"?new Iu(e,r):t==="not-in"?new Eu(e,r):t==="array-contains-any"?new wu(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new _u(e,r):new yu(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Fn(t,this.value)):t!==null&&sn(this.value)===sn(t)&&this.matchesComparison(Fn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return V()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},tt=class n extends Es{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Lf(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Lf(n){return n.op==="and"}function Vf(n){return lI(n)&&Lf(n)}function lI(n){for(let e of n.filters)if(e instanceof tt)return!1;return!0}function mu(n){if(n instanceof de)return n.field.canonicalString()+n.op.toString()+xn(n.value);if(Vf(n))return n.filters.map(e=>mu(e)).join(",");{let e=n.filters.map(t=>mu(t)).join(",");return`${n.op}(${e})`}}function Mf(n,e){return n instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.field.isEqual(i.field)&&et(r.value,i.value)}(n,e):n instanceof tt?function(r,i){return i instanceof tt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,a,c)=>o&&Mf(a,i.filters[c]),!0):!1}(n,e):void V()}function Uf(n){return n instanceof de?function(t){return`${t.field.canonicalString()} ${t.op} ${xn(t.value)}`}(n):n instanceof tt?function(t){return t.op.toString()+" {"+t.getFilters().map(Uf).join(" ,")+"}"}(n):"Filter"}var gu=class extends de{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},_u=class extends de{constructor(e,t){super(e,"in",t),this.keys=Bf("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},yu=class extends de{constructor(e,t){super(e,"not-in",t),this.keys=Bf("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Bf(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var vu=class extends de{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Uc(t)&&Mr(t.arrayValue,this.value)}},Iu=class extends de{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Mr(this.value.arrayValue,t)}},Eu=class extends de{constructor(e,t){super(e,"not-in",t)}matches(e){if(Mr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Mr(this.value.arrayValue,t)}},wu=class extends de{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Uc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Mr(this.value.arrayValue,r))}};var Tu=class{constructor(e,t=null,r=[],i=[],o=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=a,this.endAt=c,this.ue=null}};function uf(n,e=null,t=[],r=[],i=null,o=null,a=null){return new Tu(n,e,t,r,i,o,a)}function Bc(n){let e=U(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>mu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),js(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>xn(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>xn(r)).join(",")),e.ue=t}return e.ue}function $c(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!cI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Mf(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!af(n.startAt,e.startAt)&&af(n.endAt,e.endAt)}function Au(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Mn=class{constructor(e,t=null,r=[],i=[],o=null,a="F",c=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=a,this.startAt=c,this.endAt=h,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function hI(n,e,t,r,i,o,a,c){return new Mn(n,e,t,r,i,o,a,c)}function $f(n){return new Mn(n)}function cf(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dI(n){return n.collectionGroup!==null}function Or(n){let e=U(n);if(e.ce===null){e.ce=[];let t=new Set;for(let o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Ae(xe.comparator);return a.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Vn(o,r))}),t.has(xe.keyField().canonicalString())||e.ce.push(new Vn(xe.keyField(),r))}return e.ce}function Xe(n){let e=U(n);return e.le||(e.le=fI(e,Or(n))),e.le}function fI(n,e){if(n.limitType==="F")return uf(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new Vn(i.field,o)});let t=n.endAt?new Ln(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ln(n.startAt.position,n.startAt.inclusive):null;return uf(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Du(n,e,t){return new Mn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Gs(n,e){return $c(Xe(n),Xe(e))&&n.limitType===e.limitType}function qf(n){return`${Bc(Xe(n))}|lt:${n.limitType}`}function Dn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Uf(i)).join(", ")}]`),js(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>xn(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>xn(i)).join(",")),`Target(${r})`}(Xe(n))}; limitType=${n.limitType})`}function Ws(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):L.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of Or(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,c,h){let d=of(a,c,h);return a.inclusive?d<=0:d<0}(r.startAt,Or(r),i)||r.endAt&&!function(a,c,h){let d=of(a,c,h);return a.inclusive?d>=0:d>0}(r.endAt,Or(r),i))}(n,e)}function pI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function zf(n){return(e,t)=>{let r=!1;for(let i of Or(n)){let o=mI(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function mI(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(o,a,c){let h=a.data.field(o),d=c.data.field(o);return h!==null&&d!==null?Fn(h,d):V()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return V()}}var Vt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){hn(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return Nf(this.inner)}size(){return this.innerSize}};var gI=new ae(L.comparator);function It(){return gI}var jf=new ae(L.comparator);function kr(...n){let e=jf;for(let t of n)e=e.insert(t.key,t);return e}function Gf(n){let e=jf;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function en(){return Fr()}function Wf(){return Fr()}function Fr(){return new Vt(n=>n.toString(),(n,e)=>n.isEqual(e))}var _I=new ae(L.comparator),yI=new Ae(L.comparator);function q(...n){let e=yI;for(let t of n)e=e.add(t);return e}var vI=new Ae(H);function II(){return vI}function qc(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lr(e)?"-0":e}}function Kf(n){return{integerValue:""+n}}function EI(n,e){return rI(e)?Kf(e):qc(n,e)}var Un=class{constructor(){this._=void 0}};function wI(n,e,t){return n instanceof Bn?function(i,o){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Vc(o)&&(o=Mc(o)),o&&(a.fields.__previous_value__=o),{mapValue:a}}(t,e):n instanceof on?Qf(n,e):n instanceof an?Yf(n,e):function(i,o){let a=Hf(i,o),c=lf(a)+lf(i.Pe);return pu(a)&&pu(i.Pe)?Kf(c):qc(i.serializer,c)}(n,e)}function TI(n,e,t){return n instanceof on?Qf(n,e):n instanceof an?Yf(n,e):t}function Hf(n,e){return n instanceof $n?function(r){return pu(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Bn=class extends Un{},on=class extends Un{constructor(e){super(),this.elements=e}};function Qf(n,e){let t=Jf(e);for(let r of n.elements)t.some(i=>et(i,r))||t.push(r);return{arrayValue:{values:t}}}var an=class extends Un{constructor(e){super(),this.elements=e}};function Yf(n,e){let t=Jf(e);for(let r of n.elements)t=t.filter(i=>!et(i,r));return{arrayValue:{values:t}}}var $n=class extends Un{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function lf(n){return ie(n.integerValue||n.doubleValue)}function Jf(n){return Uc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function AI(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof on&&i instanceof on||r instanceof an&&i instanceof an?On(r.elements,i.elements,et):r instanceof $n&&i instanceof $n?et(r.Pe,i.Pe):r instanceof Bn&&i instanceof Bn}(n.transform,e.transform)}var bu=class{constructor(e,t){this.version=e,this.transformResults=t}},_t=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ps(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var qn=class{};function Xf(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ur(n.key,_t.none()):new un(n.key,n.data,_t.none());{let t=n.data,r=Fe.empty(),i=new Ae(xe.comparator);for(let o of e.fields)if(!i.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?r.delete(o):r.set(o,a),i=i.add(o)}return new nt(n.key,r,new Ue(i.toArray()),_t.none())}}function DI(n,e,t){n instanceof un?function(i,o,a){let c=i.value.clone(),h=df(i.fieldTransforms,o,a.transformResults);c.setAll(h),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof nt?function(i,o,a){if(!ps(i.precondition,o))return void o.convertToUnknownDocument(a.version);let c=df(i.fieldTransforms,o,a.transformResults),h=o.data;h.setAll(Zf(i)),h.setAll(c),o.convertToFoundDocument(a.version,h).setHasCommittedMutations()}(n,e,t):function(i,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function xr(n,e,t,r){return n instanceof un?function(o,a,c,h){if(!ps(o.precondition,a))return c;let d=o.value.clone(),p=ff(o.fieldTransforms,h,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof nt?function(o,a,c,h){if(!ps(o.precondition,a))return c;let d=ff(o.fieldTransforms,h,a),p=a.data;return p.setAll(Zf(o)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(T=>T.field))}(n,e,t,r):function(o,a,c){return ps(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function bI(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=Hf(r.transform,i||null);o!=null&&(t===null&&(t=Fe.empty()),t.set(r.field,o))}return t||null}function hf(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&On(r,i,(o,a)=>AI(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var un=class extends qn{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nt=class extends qn{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function Zf(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function df(n,e,t){let r=new Map;X(n.length===t.length);for(let i=0;i<t.length;i++){let o=n[i],a=o.transform,c=e.data.field(o.field);r.set(o.field,TI(a,c,t[i]))}return r}function ff(n,e,t){let r=new Map;for(let i of n){let o=i.transform,a=t.data.field(i.field);r.set(i.field,wI(o,a,e))}return r}var Ur=class extends qn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Su=class extends qn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Cu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&DI(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=xr(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=xr(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Wf();return this.mutations.forEach(i=>{let o=e.get(i.key),a=o.overlayedDocument,c=this.applyToLocalView(a,o.mutatedFields);c=t.has(i.key)?null:c;let h=Xf(a,c);h!==null&&r.set(i.key,h),a.isValidDocument()||a.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),q())}isEqual(e){return this.batchId===e.batchId&&On(this.mutations,e.mutations,(t,r)=>hf(t,r))&&On(this.baseMutations,e.baseMutations,(t,r)=>hf(t,r))}},Ru=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){X(e.mutations.length===r.length);let i=function(){return _I}(),o=e.mutations;for(let a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new n(e,t,r,i)}};var Pu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ku=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var le,W;function SI(n){switch(n){default:return V();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function ep(n){if(n===void 0)return yt("GRPC error has no .code"),C.UNKNOWN;switch(n){case le.OK:return C.OK;case le.CANCELLED:return C.CANCELLED;case le.UNKNOWN:return C.UNKNOWN;case le.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case le.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case le.INTERNAL:return C.INTERNAL;case le.UNAVAILABLE:return C.UNAVAILABLE;case le.UNAUTHENTICATED:return C.UNAUTHENTICATED;case le.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case le.NOT_FOUND:return C.NOT_FOUND;case le.ALREADY_EXISTS:return C.ALREADY_EXISTS;case le.PERMISSION_DENIED:return C.PERMISSION_DENIED;case le.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case le.ABORTED:return C.ABORTED;case le.OUT_OF_RANGE:return C.OUT_OF_RANGE;case le.UNIMPLEMENTED:return C.UNIMPLEMENTED;case le.DATA_LOSS:return C.DATA_LOSS;default:return V()}}(W=le||(le={}))[W.OK=0]="OK",W[W.CANCELLED=1]="CANCELLED",W[W.UNKNOWN=2]="UNKNOWN",W[W.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",W[W.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",W[W.NOT_FOUND=5]="NOT_FOUND",W[W.ALREADY_EXISTS=6]="ALREADY_EXISTS",W[W.PERMISSION_DENIED=7]="PERMISSION_DENIED",W[W.UNAUTHENTICATED=16]="UNAUTHENTICATED",W[W.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",W[W.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",W[W.ABORTED=10]="ABORTED",W[W.OUT_OF_RANGE=11]="OUT_OF_RANGE",W[W.UNIMPLEMENTED=12]="UNIMPLEMENTED",W[W.INTERNAL=13]="INTERNAL",W[W.UNAVAILABLE=14]="UNAVAILABLE",W[W.DATA_LOSS=15]="DATA_LOSS";var pf=null;function CI(){return new TextEncoder}var RI=new Ft([4294967295,4294967295],0);function mf(n){let e=CI().encode(n),t=new Ka;return t.update(e),new Uint8Array(t.digest())}function gf(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ft([t,r],0),new Ft([i,o],0)]}var Nu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new tn(`Invalid padding: ${t}`);if(r<0)throw new tn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new tn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new tn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ft.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Ft.fromNumber(r)));return i.compare(RI)===1&&(i=new Ft([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=mf(e),[r,i]=gf(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new n(o,i,t);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;let t=mf(e),[r,i]=gf(t);for(let o=0;o<this.hashCount;o++){let a=this.Ee(r,i,o);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},tn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ws=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Br.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(B.min(),i,new ae(H),It(),q())}},Br=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,q(),q(),q())}};var Pn=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Ts=class{constructor(e,t){this.targetId=e,this.me=t}},As=class{constructor(e,t,r=De.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ds=class{constructor(){this.fe=0,this.ge=yf(),this.pe=De.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=q(),t=q(),r=q();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:V()}}),new Br(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=yf()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,X(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Ou=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=It(),this.qe=_f(),this.Qe=new ae(H)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:V()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let o=i.target;if(Au(o))if(r===0){let a=new L(o.path);this.Ue(t,a,je.newNoDocument(a,B.min()))}else X(r===1);else{let a=this.Ye(t);if(a!==r){let c=this.Ze(e),h=c?this.Xe(c,e,a):1;if(h!==0){this.je(t);let d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}pf?.et(function(p,T,D,S,N){var O,k,z,j,G,ne;let be={localCacheCount:p,existenceFilterCount:T.count,databaseId:D.database,projectId:D.projectId},J=T.unchangedNames;return J&&(be.bloomFilter={applied:N===0,hashCount:(O=J?.hashCount)!==null&&O!==void 0?O:0,bitmapLength:(j=(z=(k=J?.bits)===null||k===void 0?void 0:k.bitmap)===null||z===void 0?void 0:z.length)!==null&&j!==void 0?j:0,padding:(ne=(G=J?.bits)===null||G===void 0?void 0:G.padding)!==null&&ne!==void 0?ne:0,mightContain:I=>{var m;return(m=S?.mightContain(I))!==null&&m!==void 0&&m}}),be}(a,e.me,this.Le.tt(),c,h))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,a,c;try{a=Lt(r).toUint8Array()}catch(h){if(h instanceof vs)return Nn("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{c=new Nu(a,i,o)}catch(h){return Nn(h instanceof tn?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return c.Ie===0?null:c}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,o,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((o,a)=>{let c=this.Je(a);if(c){if(o.current&&Au(c.target)){let h=new L(c.target.path);this.ke.get(h)!==null||this.it(a,h)||this.Ue(a,h,je.newNoDocument(h,e))}o.be&&(t.set(a,o.ve()),o.Ce())}});let r=q();this.qe.forEach((o,a)=>{let c=!0;a.forEachWhile(h=>{let d=this.Je(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(o))}),this.ke.forEach((o,a)=>a.setReadTime(e));let i=new ws(e,t,this.Qe,this.ke,r);return this.ke=It(),this.qe=_f(),this.Qe=new ae(H),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Ds,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ae(H),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Ds),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function _f(){return new ae(L.comparator)}function yf(){return new ae(L.comparator)}var PI={asc:"ASCENDING",desc:"DESCENDING"},kI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NI={and:"AND",or:"OR"},Fu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function xu(n,e){return n.useProto3Json||js(e)?e:{value:e}}function bs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tp(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function OI(n,e){return bs(n,e.toTimestamp())}function Ze(n){return X(!!n),B.fromTimestamp(function(t){let r=vt(t);return new ye(r.seconds,r.nanos)}(n))}function zc(n,e){return Lu(n,e).canonicalString()}function Lu(n,e){let t=function(i){return new oe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function np(n){let e=oe.fromString(n);return X(ap(e)),e}function Vu(n,e){return zc(n.databaseId,e.path)}function Za(n,e){let t=np(e);if(t.get(1)!==n.databaseId.projectId)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(C.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(ip(t))}function rp(n,e){return zc(n.databaseId,e)}function FI(n){let e=np(n);return e.length===4?oe.emptyPath():ip(e)}function Mu(n){return new oe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ip(n){return X(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function vf(n,e,t){return{name:Vu(n,e),fields:t.value.mapValue.fields}}function xI(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:V()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,p){return d.useProto3Json?(X(p===void 0||typeof p=="string"),De.fromBase64String(p||"")):(X(p===void 0||p instanceof Buffer||p instanceof Uint8Array),De.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){let p=d.code===void 0?C.UNKNOWN:ep(d.code);return new x(p,d.message||"")}(a);t=new As(r,i,o,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Za(n,r.document.name),o=Ze(r.document.updateTime),a=r.document.createTime?Ze(r.document.createTime):B.min(),c=new Fe({mapValue:{fields:r.document.fields}}),h=je.newFoundDocument(i,o,a,c),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Pn(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Za(n,r.document),o=r.readTime?Ze(r.readTime):B.min(),a=je.newNoDocument(i,o),c=r.removedTargetIds||[];t=new Pn([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Za(n,r.document),o=r.removedTargetIds||[];t=new Pn([],o,i,null)}else{if(!("filter"in e))return V();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,a=new ku(i,o),c=r.targetId;t=new Ts(c,a)}}return t}function LI(n,e){let t;if(e instanceof un)t={update:vf(n,e.key,e.value)};else if(e instanceof Ur)t={delete:Vu(n,e.key)};else if(e instanceof nt)t={update:vf(n,e.key,e.data),updateMask:GI(e.fieldMask)};else{if(!(e instanceof Su))return V();t={verify:Vu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,a){let c=a.transform;if(c instanceof Bn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof on)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof an)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof $n)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw V()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:OI(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:V()}(n,e.precondition)),t}function VI(n,e){return n&&n.length>0?(X(e!==void 0),n.map(t=>function(i,o){let a=i.updateTime?Ze(i.updateTime):Ze(o);return a.isEqual(B.min())&&(a=Ze(o)),new bu(a,i.transformResults||[])}(t,e))):[]}function MI(n,e){return{documents:[rp(n,e.path)]}}function UI(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=rp(n,i);let o=function(d){if(d.length!==0)return op(tt.create(d,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let a=function(d){if(d.length!==0)return d.map(p=>function(D){return{field:bn(D.field),direction:qI(D.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=xu(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function BI(n){let e=FI(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){X(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let o=[];t.where&&(o=function(T){let D=sp(T);return D instanceof tt&&Vf(D)?D.getFilters():[D]}(t.where));let a=[];t.orderBy&&(a=function(T){return T.map(D=>function(N){return new Vn(Sn(N.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(N.direction))}(D))}(t.orderBy));let c=null;t.limit&&(c=function(T){let D;return D=typeof T=="object"?T.value:T,js(D)?null:D}(t.limit));let h=null;t.startAt&&(h=function(T){let D=!!T.before,S=T.values||[];return new Ln(S,D)}(t.startAt));let d=null;return t.endAt&&(d=function(T){let D=!T.before,S=T.values||[];return new Ln(S,D)}(t.endAt)),hI(e,i,a,o,c,"F",h,d)}function $I(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return V()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function sp(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Sn(t.unaryFilter.field);return de.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Sn(t.unaryFilter.field);return de.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=Sn(t.unaryFilter.field);return de.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Sn(t.unaryFilter.field);return de.create(a,"!=",{nullValue:"NULL_VALUE"});default:return V()}}(n):n.fieldFilter!==void 0?function(t){return de.create(Sn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return V()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return tt.create(t.compositeFilter.filters.map(r=>sp(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return V()}}(t.compositeFilter.op))}(n):V()}function qI(n){return PI[n]}function zI(n){return kI[n]}function jI(n){return NI[n]}function bn(n){return{fieldPath:n.canonicalString()}}function Sn(n){return xe.fromServerFormat(n.fieldPath)}function op(n){return n instanceof de?function(t){if(t.op==="=="){if(sf(t.value))return{unaryFilter:{field:bn(t.field),op:"IS_NAN"}};if(rf(t.value))return{unaryFilter:{field:bn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(sf(t.value))return{unaryFilter:{field:bn(t.field),op:"IS_NOT_NAN"}};if(rf(t.value))return{unaryFilter:{field:bn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bn(t.field),op:zI(t.op),value:t.value}}}(n):n instanceof tt?function(t){let r=t.getFilters().map(i=>op(i));return r.length===1?r[0]:{compositeFilter:{op:jI(t.op),filters:r}}}(n):V()}function GI(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ap(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var $r=class n{constructor(e,t,r,i,o=B.min(),a=B.min(),c=De.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=h}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Uu=class{constructor(e){this.ct=e}};function WI(n){let e=BI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Du(e,e.limit,"L"):e}var Ss=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ie(e.integerValue));else if("doubleValue"in e){let r=ie(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Lr(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=vt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Lt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Ff(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Of(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):V()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let o=e.fields||{};this.dt(t,53);let a="value",c=((i=(r=o[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ie(c)),this.Vt(a,t),this.Tt(o[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),L.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Ss.vt=new Ss;var Bu=class{constructor(){this.un=new $u}addToCollectionParentIndex(e,t){return this.un.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(rn.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(rn.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},$u=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ae(oe.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ae(oe.comparator)).toArray()}};var qT=new Uint8Array(0);var Qe=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Qe.DEFAULT_COLLECTION_PERCENTILE=10,Qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qe.DEFAULT=new Qe(41943040,Qe.DEFAULT_COLLECTION_PERCENTILE,Qe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qe.DISABLED=new Qe(-1,0,0);var qr=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var qu=class{constructor(){this.changes=new Vt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,je.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var zu=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var ju=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&xr(r.mutation,i,Ue.empty(),ye.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,q()).next(()=>r))}getLocalViewOfDocuments(e,t,r=q()){let i=en();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let a=kr();return o.forEach((c,h)=>{a=a.insert(c,h.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=en();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,q()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,r,i){let o=It(),a=Fr(),c=function(){return Fr()}();return t.forEach((h,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof nt)?o=o.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),xr(p.mutation,d,p.mutation.getFieldMask(),ye.now())):a.set(d.key,Ue.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var T;return c.set(d,new zu(p,(T=a.get(d))!==null&&T!==void 0?T:null))}),c))}recalculateAndSaveOverlays(e,t){let r=Fr(),i=new ae((a,c)=>a-c),o=q();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(h=>{let d=t.get(h);if(d===null)return;let p=r.get(h)||Ue.empty();p=c.applyToLocalView(d,p),r.set(h,p);let T=(i.get(c.batchId)||q()).add(h);i=i.insert(c.batchId,T)})}).next(()=>{let a=[],c=i.getReverseIterator();for(;c.hasNext();){let h=c.getNext(),d=h.key,p=h.value,T=Wf();p.forEach(D=>{if(!o.has(D)){let S=Xf(t.get(D),r.get(D));S!==null&&T.set(D,S),o=o.add(D)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,T))}return R.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let a=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):R.resolve(en()),c=-1,h=o;return a.next(d=>R.forEach(d,(p,T)=>(c<T.largestBatchId&&(c=T.largestBatchId),o.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(D=>{h=h.insert(p,D)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,q())).next(p=>({batchId:c,changes:Gf(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=kr();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,a=kr();return this.indexManager.getCollectionParents(e,o).next(c=>R.forEach(c,h=>{let d=function(T,D){return new Mn(D,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)}(t,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((T,D)=>{a=a.insert(T,D)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(a=>{o.forEach((h,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,je.newInvalidDocument(p)))});let c=kr();return a.forEach((h,d)=>{let p=o.get(h);p!==void 0&&xr(p.mutation,d,Ue.empty(),ye.now()),Ws(t,d)&&(c=c.insert(h,d))}),c})}};var Gu=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return R.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ze(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:WI(i.bundledQuery),readTime:Ze(i.readTime)}}(t)),R.resolve()}};var Wu=class{constructor(){this.overlays=new ae(L.comparator),this.Ir=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=en();return R.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=en(),o=t.length+1,a=new L(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let h=c.getNext().value,d=h.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>r&&i.set(h.getKey(),h)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new ae((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=o.get(d.largestBatchId);p===null&&(p=en(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let c=en(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,p)=>c.set(d,p)),!(c.size()>=i)););return R.resolve(c)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Pu(t,r));let o=this.Ir.get(t);o===void 0&&(o=q(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}};var Ku=class{constructor(){this.sessionToken=De.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var zr=class{constructor(){this.Tr=new Ae(he.Er),this.dr=new Ae(he.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new he(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new he(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new L(new oe([])),r=new he(t,e),i=new he(t,e+1),o=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),o.push(a.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new L(new oe([])),r=new he(t,e),i=new he(t,e+1),o=q();return this.dr.forEachInRange([r,i],a=>{o=o.add(a.key)}),o}containsKey(e){let t=new he(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},he=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return L.comparator(e.key,t.key)||H(e.wr,t.wr)}static Ar(e,t){return H(e.wr,t.wr)||L.comparator(e.key,t.key)}};var Hu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ae(he.Er)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Cu(o,t,r,i);this.mutationQueue.push(a);for(let c of i)this.br=this.br.add(new he(c.key,o)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),o=i<0?0:i;return R.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new he(t,0),i=new he(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],a=>{let c=this.Dr(a.wr);o.push(c)}),R.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ae(H);return t.forEach(i=>{let o=new he(i,0),a=new he(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,a],c=>{r=r.add(c.wr)})}),R.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;L.isDocumentKey(o)||(o=o.child(""));let a=new he(new L(o),0),c=new Ae(H);return this.br.forEachWhile(h=>{let d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(h.wr)),!0)},a),R.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){X(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return R.forEach(t.mutations,i=>{let o=new he(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new he(t,0),i=this.br.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Qu=class{constructor(e){this.Mr=e,this.docs=function(){return new ae(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():je.newInvalidDocument(t))}getEntries(e,t){let r=It();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():je.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=It(),a=t.path,c=new L(a.child("")),h=this.docs.getIteratorFrom(c);for(;h.hasNext();){let{key:d,value:{document:p}}=h.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||eI(Zv(p),r)<=0||(i.has(p.key)||Ws(t,p))&&(o=o.insert(p.key,p.mutableCopy()))}return R.resolve(o)}getAllFromCollectionGroup(e,t,r,i){V()}Or(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Yu(this)}getSize(e){return R.resolve(this.size)}},Yu=class extends qu{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Ju=class{constructor(e){this.persistence=e,this.Nr=new Vt(t=>Bc(t),$c),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.Lr=0,this.Br=new zr,this.targetCount=0,this.kr=qr.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),R.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new qr(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Kn(t),R.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.Nr.forEach((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.Nr.delete(a),o.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),R.waitFor(o).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(a=>{o.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.Br.containsKey(t))}};var Xu=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new kf(0),this.Kr=!1,this.Kr=!0,this.$r=new Ku,this.referenceDelegate=e(this),this.Ur=new Ju(this),this.indexManager=new Bu,this.remoteDocumentCache=function(i){return new Qu(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Uu(t),this.Gr=new Gu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Wu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Hu(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new Zu(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return R.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Zu=class extends hu{constructor(e){super(),this.currentSequenceNumber=e}},ec=class n{constructor(e){this.persistence=e,this.Jr=new zr,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw V()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Xr,r=>{let i=L.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,B.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return R.or([()=>R.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var tc=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=q(),i=q();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var nc=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var rc=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Sh()?8:nI(fe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.Yi(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(a=>{o.result=a})}).next(()=>{if(o.result)return;let a=new nc;return this.Xi(e,t,a).next(c=>{if(o.result=c,this.zi)return this.es(e,t,a,c.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Pr()<=$.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",Dn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),R.resolve()):(Pr()<=$.DEBUG&&F("QueryEngine","Query:",Dn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Pr()<=$.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",Dn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Xe(t))):R.resolve())}Yi(e,t){if(cf(t))return R.resolve(null);let r=Xe(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Du(t,null,"F"),r=Xe(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let a=q(...o);return this.Ji.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(h=>{let d=this.ts(t,c);return this.ns(t,d,a,h.readTime)?this.Yi(e,Du(t,null,"F")):this.rs(e,d,t,h)}))})))}Zi(e,t,r,i){return cf(t)||i.isEqual(B.min())?R.resolve(null):this.Ji.getDocuments(e,r).next(o=>{let a=this.ts(t,o);return this.ns(t,a,r,i)?R.resolve(null):(Pr()<=$.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Dn(t)),this.rs(e,a,t,Xv(i,-1)).next(c=>c))})}ts(e,t){let r=new Ae(zf(e));return t.forEach((i,o)=>{Ws(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Pr()<=$.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",Dn(t)),this.Ji.getDocumentsMatchingQuery(e,t,rn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}};var ic=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new ae(H),this._s=new Vt(o=>Bc(o),$c),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ju(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function KI(n,e,t,r){return new ic(n,e,t,r)}function up(n,e){return y(this,null,function*(){let t=U(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let a=[],c=[],h=q();for(let d of i){a.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}for(let d of o){c.push(d.batchId);for(let p of d.mutations)h=h.add(p.key)}return t.localDocuments.getDocuments(r,h).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:c}))})})})}function HI(n,e){let t=U(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(c,h,d,p){let T=d.batch,D=T.keys(),S=R.resolve();return D.forEach(N=>{S=S.next(()=>p.getEntry(h,N)).next(O=>{let k=d.docVersions.get(N);X(k!==null),O.version.compareTo(k)<0&&(T.applyToRemoteDocument(O,d),O.isValidDocument()&&(O.setReadTime(d.commitVersion),p.addEntry(O)))})}),S.next(()=>c.mutationQueue.removeMutationBatch(h,T))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let h=q();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(h=h.add(c.batch.mutations[d].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function cp(n){let e=U(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function QI(n,e){let t=U(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let c=[];e.targetChanges.forEach((p,T)=>{let D=i.get(T);if(!D)return;c.push(t.Ur.removeMatchingKeys(o,p.removedDocuments,T).next(()=>t.Ur.addMatchingKeys(o,p.addedDocuments,T)));let S=D.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(T)!==null?S=S.withResumeToken(De.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(T,S),function(O,k,z){return O.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(D,S,p)&&c.push(t.Ur.updateTargetData(o,S))});let h=It(),d=q();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(o,p))}),c.push(YI(o,a,e.documentUpdates).next(p=>{h=p.Ps,d=p.Is})),!r.isEqual(B.min())){let p=t.Ur.getLastRemoteSnapshotVersion(o).next(T=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));c.push(p)}return R.waitFor(c).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(t.os=i,o))}function YI(n,e,t){let r=q(),i=q();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let a=It();return t.forEach((c,h)=>{let d=o.get(c);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),h.isNoDocument()&&h.version.isEqual(B.min())?(e.removeEntry(c,h.readTime),a=a.insert(c,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),a=a.insert(c,h)):F("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",h.version)}),{Ps:a,Is:i}})}function JI(n,e){let t=U(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function XI(n,e){let t=U(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,R.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new $r(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function sc(n,e,t){return y(this,null,function*(){let r=U(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Qr(a))throw a;F("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function If(n,e,t){let r=U(n),i=B.min(),o=q();return r.persistence.runTransaction("Execute query","readwrite",a=>function(h,d,p){let T=U(h),D=T._s.get(p);return D!==void 0?R.resolve(T.os.get(D)):T.Ur.getTargetData(d,p)}(r,a,Xe(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,c.targetId).next(h=>{o=h})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:B.min(),t?o:q())).next(c=>(ZI(r,pI(e),c),{documents:c,Ts:o})))}function ZI(n,e,t){let r=n.us.get(e)||B.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}var Cs=class{constructor(){this.activeTargetIds=II()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var oc=class{constructor(){this.so=new Cs,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Cs,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ac=class{_o(e){}shutdown(){}};var Rs=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){F("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){F("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var ds=null;function eu(){return ds===null?ds=function(){return 268435456+Math.round(2147483648*Math.random())}():ds++,"0x"+ds.toString(16)}var eE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var uc=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Te="WebChannelConnection",cc=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,a){let c=eu(),h=this.xo(t,r.toUriEncodedString());F("RestConnection",`Sending RPC '${t}' ${c}:`,h,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,a),this.No(t,h,d,i).then(p=>(F("RestConnection",`Received RPC '${t}' ${c}: `,p),p),p=>{throw Nn("RestConnection",`RPC '${t}' ${c} failed with error: `,p,"url: ",h,"request:",i),p})}Lo(t,r,i,o,a,c){return this.Mo(t,r,i,o,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Wn}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,a)=>t[a]=o),i&&i.headers.forEach((o,a)=>t[a]=o)}xo(t,r){let i=eE[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let o=eu();return new Promise((a,c)=>{let h=new Ha;h.setWithCredentials(!0),h.listenOnce(Qa.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Rr.NO_ERROR:let p=h.getResponseJson();F(Te,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case Rr.TIMEOUT:F(Te,`RPC '${e}' ${o} timed out`),c(new x(C.DEADLINE_EXCEEDED,"Request time out"));break;case Rr.HTTP_ERROR:let T=h.getStatus();if(F(Te,`RPC '${e}' ${o} failed with status:`,T,"response text:",h.getResponseText()),T>0){let D=h.getResponseJson();Array.isArray(D)&&(D=D[0]);let S=D?.error;if(S&&S.status&&S.message){let N=function(k){let z=k.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(z)>=0?z:C.UNKNOWN}(S.status);c(new x(N,S.message))}else c(new x(C.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new x(C.UNAVAILABLE,"Connection failed."));break;default:V()}}finally{F(Te,`RPC '${e}' ${o} completed.`)}});let d=JSON.stringify(i);F(Te,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=eu(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Xa(),c=Ja(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Oo(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;let p=o.join("");F(Te,`Creating RPC '${e}' stream ${i}: ${p}`,h);let T=a.createWebChannel(p,h),D=!1,S=!1,N=new uc({Io:k=>{S?F(Te,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(D||(F(Te,`Opening RPC '${e}' stream ${i} transport.`),T.open(),D=!0),F(Te,`RPC '${e}' stream ${i} sending:`,k),T.send(k))},To:()=>T.close()}),O=(k,z,j)=>{k.listen(z,G=>{try{j(G)}catch(ne){setTimeout(()=>{throw ne},0)}})};return O(T,An.EventType.OPEN,()=>{S||(F(Te,`RPC '${e}' stream ${i} transport opened.`),N.yo())}),O(T,An.EventType.CLOSE,()=>{S||(S=!0,F(Te,`RPC '${e}' stream ${i} transport closed`),N.So())}),O(T,An.EventType.ERROR,k=>{S||(S=!0,Nn(Te,`RPC '${e}' stream ${i} transport errored:`,k),N.So(new x(C.UNAVAILABLE,"The operation could not be completed")))}),O(T,An.EventType.MESSAGE,k=>{var z;if(!S){let j=k.data[0];X(!!j);let G=j,ne=G.error||((z=G[0])===null||z===void 0?void 0:z.error);if(ne){F(Te,`RPC '${e}' stream ${i} received error:`,ne);let be=ne.status,J=function(_){let v=le[_];if(v!==void 0)return ep(v)}(be),I=ne.message;J===void 0&&(J=C.INTERNAL,I="Unknown error status: "+be+" with message "+ne.message),S=!0,N.So(new x(J,I)),T.close()}else F(Te,`RPC '${e}' stream ${i} received:`,j),N.bo(j)}}),O(c,Ya.STAT_EVENT,k=>{k.stat===ls.PROXY?F(Te,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===ls.NOPROXY&&F(Te,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.wo()},0),N}};function tu(){return typeof document<"u"?document:null}function Ks(n){return new Fu(n,!0)}var Ps=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var ks=class{constructor(e,t,r,i,o,a,c,h){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=h,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ps(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return y(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return y(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return y(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===C.RESOURCE_EXHAUSTED?(yt(t.toString()),yt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new x(C.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>y(this,null,function*(){this.state=0,this.start()}))}I_(e){return F("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(F("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},lc=class extends ks{constructor(e,t,r,i,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=xI(this.serializer,e),r=function(o){if(!("targetChange"in o))return B.min();let a=o.targetChange;return a.targetIds&&a.targetIds.length?B.min():a.readTime?Ze(a.readTime):B.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=Mu(this.serializer),t.addTarget=function(o,a){let c,h=a.target;if(c=Au(h)?{documents:MI(o,h)}:{query:UI(o,h)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=tp(o,a.resumeToken);let d=xu(o,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(B.min())>0){c.readTime=bs(o,a.snapshotVersion.toTimestamp());let d=xu(o,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);let r=$I(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=Mu(this.serializer),t.removeTarget=e,this.a_(t)}},hc=class extends ks{constructor(e,t,r,i,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return X(!!e.streamToken),this.lastStreamToken=e.streamToken,X(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){X(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=VI(e.writeResults,e.commitTime),r=Ze(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=Mu(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>LI(this.serializer,r))};this.a_(t)}};var dc=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Mo(e,Lu(t,r),i,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new x(C.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Lo(e,Lu(t,r),i,a,c,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(C.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},fc=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(yt(t),this.D_=!1):F("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var pc=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(a=>{r.enqueueAndForget(()=>y(this,null,function*(){dn(this)&&(F("RemoteStore","Restarting streams for network reachability change."),yield function(h){return y(this,null,function*(){let d=U(h);d.L_.add(4),yield Yr(d),d.q_.set("Unknown"),d.L_.delete(4),yield Hs(d)})}(this))}))}),this.q_=new fc(r,i)}};function Hs(n){return y(this,null,function*(){if(dn(n))for(let e of n.B_)yield e(!0)})}function Yr(n){return y(this,null,function*(){for(let e of n.B_)yield e(!1)})}function lp(n,e){let t=U(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Kc(t)?Wc(t):Kn(t).r_()&&Gc(t,e))}function jc(n,e){let t=U(n),r=Kn(t);t.N_.delete(e),r.r_()&&hp(t,e),t.N_.size===0&&(r.r_()?r.o_():dn(t)&&t.q_.set("Unknown"))}function Gc(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Kn(n).A_(e)}function hp(n,e){n.Q_.xe(e),Kn(n).R_(e)}function Wc(n){n.Q_=new Ou({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Kn(n).start(),n.q_.v_()}function Kc(n){return dn(n)&&!Kn(n).n_()&&n.N_.size>0}function dn(n){return U(n).L_.size===0}function dp(n){n.Q_=void 0}function tE(n){return y(this,null,function*(){n.q_.set("Online")})}function nE(n){return y(this,null,function*(){n.N_.forEach((e,t)=>{Gc(n,e)})})}function rE(n,e){return y(this,null,function*(){dp(n),Kc(n)?(n.q_.M_(e),Wc(n)):n.q_.set("Unknown")})}function iE(n,e,t){return y(this,null,function*(){if(n.q_.set("Online"),e instanceof As&&e.state===2&&e.cause)try{yield function(i,o){return y(this,null,function*(){let a=o.cause;for(let c of o.targetIds)i.N_.has(c)&&(yield i.remoteSyncer.rejectListen(c,a),i.N_.delete(c),i.Q_.removeTarget(c))})}(n,e)}catch(r){F("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ns(n,r)}else if(e instanceof Pn?n.Q_.Ke(e):e instanceof Ts?n.Q_.He(e):n.Q_.We(e),!t.isEqual(B.min()))try{let r=yield cp(n.localStore);t.compareTo(r)>=0&&(yield function(o,a){let c=o.Q_.rt(a);return c.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let p=o.N_.get(d);p&&o.N_.set(d,p.withResumeToken(h.resumeToken,a))}}),c.targetMismatches.forEach((h,d)=>{let p=o.N_.get(h);if(!p)return;o.N_.set(h,p.withResumeToken(De.EMPTY_BYTE_STRING,p.snapshotVersion)),hp(o,h);let T=new $r(p.target,h,d,p.sequenceNumber);Gc(o,T)}),o.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){F("RemoteStore","Failed to raise snapshot:",r),yield Ns(n,r)}})}function Ns(n,e,t){return y(this,null,function*(){if(!Qr(e))throw e;n.L_.add(1),yield Yr(n),n.q_.set("Offline"),t||(t=()=>cp(n.localStore)),n.asyncQueue.enqueueRetryable(()=>y(this,null,function*(){F("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Hs(n)}))})}function fp(n,e){return e().catch(t=>Ns(n,t,e))}function Qs(n){return y(this,null,function*(){let e=U(n),t=Mt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;sE(e);)try{let i=yield JI(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,oE(e,i)}catch(i){yield Ns(e,i)}pp(e)&&mp(e)})}function sE(n){return dn(n)&&n.O_.length<10}function oE(n,e){n.O_.push(e);let t=Mt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function pp(n){return dn(n)&&!Mt(n).n_()&&n.O_.length>0}function mp(n){Mt(n).start()}function aE(n){return y(this,null,function*(){Mt(n).p_()})}function uE(n){return y(this,null,function*(){let e=Mt(n);for(let t of n.O_)e.m_(t.mutations)})}function cE(n,e,t){return y(this,null,function*(){let r=n.O_.shift(),i=Ru.from(r,e,t);yield fp(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Qs(n)})}function lE(n,e){return y(this,null,function*(){e&&Mt(n).V_&&(yield function(r,i){return y(this,null,function*(){if(function(a){return SI(a)&&a!==C.ABORTED}(i.code)){let o=r.O_.shift();Mt(r).s_(),yield fp(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield Qs(r)}})}(n,e)),pp(n)&&mp(n)})}function Ef(n,e){return y(this,null,function*(){let t=U(n);t.asyncQueue.verifyOperationInProgress(),F("RemoteStore","RemoteStore received new credentials");let r=dn(t);t.L_.add(3),yield Yr(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Hs(t)})}function hE(n,e){return y(this,null,function*(){let t=U(n);e?(t.L_.delete(2),yield Hs(t)):e||(t.L_.add(2),yield Yr(t),t.q_.set("Unknown"))})}function Kn(n){return n.K_||(n.K_=function(t,r,i){let o=U(t);return o.w_(),new lc(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:tE.bind(null,n),Ro:nE.bind(null,n),mo:rE.bind(null,n),d_:iE.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.K_.s_(),Kc(n)?Wc(n):n.q_.set("Unknown")):(yield n.K_.stop(),dp(n))}))),n.K_}function Mt(n){return n.U_||(n.U_=function(t,r,i){let o=U(t);return o.w_(),new hc(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:aE.bind(null,n),mo:lE.bind(null,n),f_:uE.bind(null,n),g_:cE.bind(null,n)}),n.B_.push(e=>y(this,null,function*(){e?(n.U_.s_(),yield Qs(n)):(yield n.U_.stop(),n.O_.length>0&&(F("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var mc=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Ye,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let a=Date.now()+r,c=new n(e,t,a,i,o);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(C.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Hc(n,e){if(yt("AsyncQueue",`${e}: ${n}`),Qr(n))return new x(C.UNAVAILABLE,`${e}: ${n}`);throw n}var Os=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=kr(),this.sortedSet=new ae(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Fs=class{constructor(){this.W_=new ae(L.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):V():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},zn=class n{constructor(e,t,r,i,o,a,c,h,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,o){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,Os.emptySet(t),a,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var gc=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},_c=class{constructor(){this.queries=wf(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=U(t),o=i.queries;i.queries=wf(),o.forEach((a,c)=>{for(let h of c.j_)h.onError(r)})})(this,new x(C.ABORTED,"Firestore shutting down"))}};function wf(){return new Vt(n=>qf(n),Gs)}function dE(n,e){return y(this,null,function*(){let t=U(n),r=3,i=e.query,o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new gc,r=e.J_()?0:1);try{switch(r){case 0:o.z_=yield t.onListen(i,!0);break;case 1:o.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let c=Hc(a,`Initialization of query '${Dn(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&Qc(t)})}function fE(n,e){return y(this,null,function*(){let t=U(n),r=e.query,i=3,o=t.queries.get(r);if(o){let a=o.j_.indexOf(e);a>=0&&(o.j_.splice(a,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function pE(n,e){let t=U(n),r=!1;for(let i of e){let o=i.query,a=t.queries.get(o);if(a){for(let c of a.j_)c.X_(i)&&(r=!0);a.z_=i}}r&&Qc(t)}function mE(n,e,t){let r=U(n),i=r.queries.get(e);if(i)for(let o of i.j_)o.onError(t);r.queries.delete(e)}function Qc(n){n.Y_.forEach(e=>{e.next()})}var yc,Tf;(Tf=yc||(yc={})).ea="default",Tf.Cache="cache";var vc=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new zn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=zn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==yc.Cache}};var xs=class{constructor(e){this.key=e}},Ls=class{constructor(e){this.key=e}},Ic=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=q(),this.mutatedKeys=q(),this.Aa=zf(e),this.Ra=new Os(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Fs,i=t?t.Ra:this.Ra,o=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1,h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,T)=>{let D=i.get(p),S=Ws(this.query,T)?T:null,N=!!D&&this.mutatedKeys.has(D.key),O=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),k=!1;D&&S?D.data.isEqual(S.data)?N!==O&&(r.track({type:3,doc:S}),k=!0):this.ga(D,S)||(r.track({type:2,doc:S}),k=!0,(h&&this.Aa(S,h)>0||d&&this.Aa(S,d)<0)&&(c=!0)):!D&&S?(r.track({type:0,doc:S}),k=!0):D&&!S&&(r.track({type:1,doc:D}),k=!0,(h||d)&&(c=!0)),k&&(S?(a=a.add(S),o=O?o.add(p):o.delete(p)):(a=a.delete(p),o=o.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),o=o.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:c,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,T)=>function(S,N){let O=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return V()}};return O(S)-O(N)}(p.type,T.type)||this.Aa(p.doc,T.doc)),this.pa(r),i=i!=null&&i;let c=t&&!i?this.ya():[],h=this.da.size===0&&this.current&&!i?1:0,d=h!==this.Ea;return this.Ea=h,a.length!==0||d?{snapshot:new zn(this.query,e.Ra,o,a,e.mutatedKeys,h===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Fs,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=q(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Ls(r))}),this.da.forEach(r=>{e.has(r)||t.push(new xs(r))}),t}ba(e){this.Ta=e.Ts,this.da=q();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return zn.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Ec=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},wc=class{constructor(e){this.key=e,this.va=!1}},Tc=class{constructor(e,t,r,i,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Vt(c=>qf(c),Gs),this.Ma=new Map,this.xa=new Set,this.Oa=new ae(L.comparator),this.Na=new Map,this.La=new zr,this.Ba={},this.ka=new Map,this.qa=qr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function gE(n,e,t=!0){return y(this,null,function*(){let r=Ep(n),i,o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=yield gp(r,e,t,!0),i})}function _E(n,e){return y(this,null,function*(){let t=Ep(n);yield gp(t,e,!0,!1)})}function gp(n,e,t,r){return y(this,null,function*(){let i=yield XI(n.localStore,Xe(e)),o=i.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t),c;return r&&(c=yield yE(n,e,o,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&lp(n.remoteStore,i),c})}function yE(n,e,t,r,i){return y(this,null,function*(){n.Ka=(T,D,S)=>function(O,k,z,j){return y(this,null,function*(){let G=k.view.ma(z);G.ns&&(G=yield If(O.localStore,k.query,!1).then(({documents:I})=>k.view.ma(I,G)));let ne=j&&j.targetChanges.get(k.targetId),be=j&&j.targetMismatches.get(k.targetId)!=null,J=k.view.applyChanges(G,O.isPrimaryClient,ne,be);return Df(O,k.targetId,J.wa),J.snapshot})}(n,T,D,S);let o=yield If(n.localStore,e,!0),a=new Ic(e,o.Ts),c=a.ma(o.documents),h=Br.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(c,n.isPrimaryClient,h);Df(n,t,d.wa);let p=new Ec(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function vE(n,e,t){return y(this,null,function*(){let r=U(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(a=>!Gs(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield sc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&jc(r.remoteStore,i.targetId),Ac(r,i.targetId)}).catch(Hr))):(Ac(r,i.targetId),yield sc(r.localStore,i.targetId,!0))})}function IE(n,e){return y(this,null,function*(){let t=U(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),jc(t.remoteStore,r.targetId))})}function EE(n,e,t){return y(this,null,function*(){let r=CE(n);try{let i=yield function(a,c){let h=U(a),d=ye.now(),p=c.reduce((S,N)=>S.add(N.key),q()),T,D;return h.persistence.runTransaction("Locally write mutations","readwrite",S=>{let N=It(),O=q();return h.cs.getEntries(S,p).next(k=>{N=k,N.forEach((z,j)=>{j.isValidDocument()||(O=O.add(z))})}).next(()=>h.localDocuments.getOverlayedDocuments(S,N)).next(k=>{T=k;let z=[];for(let j of c){let G=bI(j,T.get(j.key).overlayedDocument);G!=null&&z.push(new nt(j.key,G,xf(G.value.mapValue),_t.exists(!0)))}return h.mutationQueue.addMutationBatch(S,d,z,c)}).next(k=>{D=k;let z=k.applyToLocalDocumentSet(T,O);return h.documentOverlayCache.saveOverlays(S,k.batchId,z)})}).then(()=>({batchId:D.batchId,changes:Gf(T)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,h){let d=a.Ba[a.currentUser.toKey()];d||(d=new ae(H)),d=d.insert(c,h),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Jr(r,i.changes),yield Qs(r.remoteStore)}catch(i){let o=Hc(i,"Failed to persist write");t.reject(o)}})}function _p(n,e){return y(this,null,function*(){let t=U(n);try{let r=yield QI(t.localStore,e);e.targetChanges.forEach((i,o)=>{let a=t.Na.get(o);a&&(X(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?X(a.va):i.removedDocuments.size>0&&(X(a.va),a.va=!1))}),yield Jr(t,r,e)}catch(r){yield Hr(r)}})}function Af(n,e,t){let r=U(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((o,a)=>{let c=a.view.Z_(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){let h=U(a);h.onlineState=c;let d=!1;h.queries.forEach((p,T)=>{for(let D of T.j_)D.Z_(c)&&(d=!0)}),d&&Qc(h)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function wE(n,e,t){return y(this,null,function*(){let r=U(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),o=i&&i.key;if(o){let a=new ae(L.comparator);a=a.insert(o,je.newNoDocument(o,B.min()));let c=q().add(o),h=new ws(B.min(),new Map,new ae(H),a,c);yield _p(r,h),r.Oa=r.Oa.remove(o),r.Na.delete(e),Yc(r)}else yield sc(r.localStore,e,!1).then(()=>Ac(r,e,t)).catch(Hr)})}function TE(n,e){return y(this,null,function*(){let t=U(n),r=e.batch.batchId;try{let i=yield HI(t.localStore,e);vp(t,r,null),yp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Jr(t,i)}catch(i){yield Hr(i)}})}function AE(n,e,t){return y(this,null,function*(){let r=U(n);try{let i=yield function(a,c){let h=U(a);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return h.mutationQueue.lookupMutationBatch(d,c).next(T=>(X(T!==null),p=T.keys(),h.mutationQueue.removeMutationBatch(d,T))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,c)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>h.localDocuments.getDocuments(d,p))})}(r.localStore,e);vp(r,e,t),yp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Jr(r,i)}catch(i){yield Hr(i)}})}function yp(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function vp(n,e,t){let r=U(n),i=r.Ba[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Ac(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Ip(n,r)})}function Ip(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(jc(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Yc(n))}function Df(n,e,t){for(let r of t)r instanceof xs?(n.La.addReference(r.key,e),DE(n,r)):r instanceof Ls?(F("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Ip(n,r.key)):V()}function DE(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(F("SyncEngine","New document in limbo: "+t),n.xa.add(r),Yc(n))}function Yc(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new L(oe.fromString(e)),r=n.qa.next();n.Na.set(r,new wc(t)),n.Oa=n.Oa.insert(t,r),lp(n.remoteStore,new $r(Xe($f(t.path)),r,"TargetPurposeLimboResolution",kf.oe))}}function Jr(n,e,t){return y(this,null,function*(){let r=U(n),i=[],o=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((c,h)=>{a.push(r.Ka(h,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let T=d?!d.fromCache:(p=t?.targetChanges.get(h.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(h.targetId,T?"current":"not-current")}if(d){i.push(d);let T=tc.Wi(h.targetId,d);o.push(T)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(h,d){return y(this,null,function*(){let p=U(h);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",T=>R.forEach(d,D=>R.forEach(D.$i,S=>p.persistence.referenceDelegate.addReference(T,D.targetId,S)).next(()=>R.forEach(D.Ui,S=>p.persistence.referenceDelegate.removeReference(T,D.targetId,S)))))}catch(T){if(!Qr(T))throw T;F("LocalStore","Failed to update sequence numbers: "+T)}for(let T of d){let D=T.targetId;if(!T.fromCache){let S=p.os.get(D),N=S.snapshotVersion,O=S.withLastLimboFreeSnapshotVersion(N);p.os=p.os.insert(D,O)}}})}(r.localStore,o))})}function bE(n,e){return y(this,null,function*(){let t=U(n);if(!t.currentUser.isEqual(e)){F("SyncEngine","User change. New user:",e.toKey());let r=yield up(t.localStore,e);t.currentUser=e,function(o,a){o.ka.forEach(c=>{c.forEach(h=>{h.reject(new x(C.CANCELLED,a))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Jr(t,r.hs)}})}function SE(n,e){let t=U(n),r=t.Na.get(e);if(r&&r.va)return q().add(r.key);{let i=q(),o=t.Ma.get(e);if(!o)return i;for(let a of o){let c=t.Fa.get(a);i=i.unionWith(c.view.Va)}return i}}function Ep(n){let e=U(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=_p.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=SE.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wE.bind(null,e),e.Ca.d_=pE.bind(null,e.eventManager),e.Ca.$a=mE.bind(null,e.eventManager),e}function CE(n){let e=U(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=TE.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=AE.bind(null,e),e}var bf=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return y(this,null,function*(){this.serializer=Ks(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return KI(this.persistence,new rc,t.initialUser,this.serializer)}Ga(t){return new Xu(ec.Zr,this.serializer)}Wa(t){return new oc}terminate(){return y(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var RE=(()=>{class n{initialize(t,r){return y(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Af(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bE.bind(null,this.syncEngine),yield hE(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new _c}()}createDatastore(t){let r=Ks(t.databaseInfo.databaseId),i=function(a){return new cc(a)}(t.databaseInfo);return function(a,c,h,d){return new dc(a,c,h,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,a,c,h){return new pc(i,o,a,c,h)}(this.localStore,this.datastore,t.asyncQueue,r=>Af(this.syncEngine,r,0),function(){return Rs.D()?new Rs:new ac}())}createSyncEngine(t,r){return function(o,a,c,h,d,p,T){let D=new Tc(o,a,c,h,d,p);return T&&(D.Qa=!0),D}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return y(this,null,function*(){var t,r;yield function(o){return y(this,null,function*(){let a=U(o);F("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield Yr(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Dc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):yt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var bc=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=gs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,a=>y(this,null,function*(){F("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(F("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ye;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>y(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Hc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function nu(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>y(this,null,function*(){r.isEqual(i)||(yield up(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Sf(n,e){return y(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield PE(n);F("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Ef(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Ef(e.remoteStore,i)),n._onlineComponents=e})}function PE(n){return y(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F("FirestoreClient","Using user provided OfflineComponentProvider");try{yield nu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===C.FAILED_PRECONDITION||i.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Nn("Error using user provided cache. Falling back to memory cache: "+t),yield nu(n,new bf)}}else F("FirestoreClient","Using default OfflineComponentProvider"),yield nu(n,new bf);return n._offlineComponents})}function wp(n){return y(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F("FirestoreClient","Using user provided OnlineComponentProvider"),yield Sf(n,n._uninitializedComponentsProvider._online)):(F("FirestoreClient","Using default OnlineComponentProvider"),yield Sf(n,new RE))),n._onlineComponents})}function kE(n){return wp(n).then(e=>e.syncEngine)}function NE(n){return y(this,null,function*(){let e=yield wp(n),t=e.eventManager;return t.onListen=gE.bind(null,e.syncEngine),t.onUnlisten=vE.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_E.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=IE.bind(null,e.syncEngine),t})}function OE(n,e,t={}){let r=new Ye;return n.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return function(o,a,c,h,d){let p=new Dc({next:D=>{p.Za(),a.enqueueAndForget(()=>fE(o,T)),D.fromCache&&h.source==="server"?d.reject(new x(C.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(D)},error:D=>d.reject(D)}),T=new vc(c,p,{includeMetadataChanges:!0,_a:!0});return dE(o,T)}(yield NE(n),n.asyncQueue,e,t,r)})),r.promise}function Tp(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Cf=new Map;function Ap(n,e,t){if(!t)throw new x(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function FE(n,e,t,r){if(e===!0&&r===!0)throw new x(C.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Rf(n){if(!L.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Pf(n){if(L.isDocumentKey(n))throw new x(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Jc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":V()}function cn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Jc(n);throw new x(C.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Vs=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new x(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Tp((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new x(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},jn=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vs({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vs(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new ru;switch(r.type){case"firstParty":return new au(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return y(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Cf.get(t);r&&(F("ComponentProvider","Removing Datastore"),Cf.delete(t),r.terminate())}(this),Promise.resolve()}};function xE(n,e,t,r={}){var i;let o=(n=cn(n,jn))._getSettings(),a=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==a&&Nn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let c,h;if(typeof r.mockUserToken=="string")c=r.mockUserToken,h=me.MOCK_USER;else{c=Eh(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new x(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new me(d)}n._authCredentials=new iu(new ms(c,h))}}var Ms=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Be=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},xt=class n extends Ms{constructor(e,t,r){super(e,t,$f(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Be(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Xc(n,e,...t){if(n=pe(n),Ap("collection","path",e),n instanceof jn){let r=oe.fromString(e,...t);return Pf(r),new xt(n,null,r)}{if(!(n instanceof Be||n instanceof xt))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return Pf(r),new xt(n.firestore,null,r)}}function Ys(n,e,...t){if(n=pe(n),arguments.length===1&&(e=gs.newId()),Ap("doc","path",e),n instanceof jn){let r=oe.fromString(e,...t);return Rf(r),new Be(n,null,new L(r))}{if(!(n instanceof Be||n instanceof xt))throw new x(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(oe.fromString(e,...t));return Rf(r),new Be(n.firestore,n instanceof xt?n.converter:null,new L(r))}}var Us=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ps(this,"async_queue_retry"),this.Vu=()=>{let r=tu();r&&F("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=tu();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=tu();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Ye;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return y(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Qr(e))throw e;F("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw yt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=mc.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&V()}verifyOperationInProgress(){}wu(){return y(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};var ln=class extends jn{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Us,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return y(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Us(e),this._firestoreClient=void 0,yield e}})}};function Dp(n,e){let t=typeof n=="object"?n:vn(),r=typeof n=="string"?n:e||"(default)",i=_r(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Ih("firestore");o&&xE(i,...o)}return i}function bp(n){if(n._terminated)throw new x(C.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||LE(n),n._firestoreClient}function LE(n){var e,t,r;let i=n._freezeSettings(),o=function(c,h,d,p){return new du(c,h,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Tp(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new bc(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(c){let h=c?._online.build();return{_offline:c?._offline.build(h),_online:h}}(n._componentsProvider))}var jr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(De.fromBase64String(e))}catch(t){throw new x(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(De.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Gn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Gr=class{constructor(e){this._methodName=e}};var Wr=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return H(this._lat,e._lat)||H(this._long,e._long)}};var Kr=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}};var VE=/^__.*__$/,Sc=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new nt(e,this.data,this.fieldMask,t,this.fieldTransforms):new un(e,this.data,t,this.fieldTransforms)}},Bs=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new nt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Sp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw V()}}var Cc=class n{constructor(e,t,r,i,o,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return qs(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Sp(this.Cu)&&VE.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Rc=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ks(e)}Qu(e,t,r,i=!1){return new Cc({Cu:e,methodName:t,qu:r,path:xe.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Cp(n){let e=n._freezeSettings(),t=Ks(n._databaseId);return new Rc(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ME(n,e,t,r,i,o={}){let a=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);Zc("Data must be an object, but it was:",a,r);let c=Rp(r,a),h,d;if(o.merge)h=new Ue(a.fieldMask),d=a.fieldTransforms;else if(o.mergeFields){let p=[];for(let T of o.mergeFields){let D=Pc(e,T,t);if(!a.contains(D))throw new x(C.INVALID_ARGUMENT,`Field '${D}' is specified in your field mask but missing from your input data.`);kp(p,D)||p.push(D)}h=new Ue(p),d=a.fieldTransforms.filter(T=>h.covers(T.field))}else h=null,d=a.fieldTransforms;return new Sc(new Fe(c),h,d)}var $s=class n extends Gr{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function UE(n,e,t,r){let i=n.Qu(1,e,t);Zc("Data must be an object, but it was:",i,r);let o=[],a=Fe.empty();hn(r,(h,d)=>{let p=el(e,h,t);d=pe(d);let T=i.Nu(p);if(d instanceof $s)o.push(p);else{let D=Js(d,T);D!=null&&(o.push(p),a.set(p,D))}});let c=new Ue(o);return new Bs(a,c,i.fieldTransforms)}function BE(n,e,t,r,i,o){let a=n.Qu(1,e,t),c=[Pc(e,r,t)],h=[i];if(o.length%2!=0)throw new x(C.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let D=0;D<o.length;D+=2)c.push(Pc(e,o[D])),h.push(o[D+1]);let d=[],p=Fe.empty();for(let D=c.length-1;D>=0;--D)if(!kp(d,c[D])){let S=c[D],N=h[D];N=pe(N);let O=a.Nu(S);if(N instanceof $s)d.push(S);else{let k=Js(N,O);k!=null&&(d.push(S),p.set(S,k))}}let T=new Ue(d);return new Bs(p,T,a.fieldTransforms)}function Js(n,e){if(Pp(n=pe(n)))return Zc("Unsupported field value:",e,n),Rp(n,e);if(n instanceof Gr)return function(r,i){if(!Sp(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let o=[],a=0;for(let c of r){let h=Js(c,i.Lu(a));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),a++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=pe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return EI(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=ye.fromDate(r);return{timestampValue:bs(i.serializer,o)}}if(r instanceof ye){let o=new ye(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:bs(i.serializer,o)}}if(r instanceof Wr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof jr)return{bytesValue:tp(i.serializer,r._byteString)};if(r instanceof Be){let o=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(o))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:zc(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Kr)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw c.Bu("VectorValues must only contain numeric values.");return qc(c.serializer,h)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Jc(r)}`)}(n,e)}function Rp(n,e){let t={};return Nf(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):hn(n,(r,i)=>{let o=Js(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Pp(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ye||n instanceof Wr||n instanceof jr||n instanceof Be||n instanceof Gr||n instanceof Kr)}function Zc(n,e,t){if(!Pp(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Jc(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Pc(n,e,t){if((e=pe(e))instanceof Gn)return e._internalPath;if(typeof e=="string")return el(n,e);throw qs("Field path arguments must be of type string or ",n,!1,void 0,t)}var $E=new RegExp("[~\\*/\\[\\]]");function el(n,e,t){if(e.search($E)>=0)throw qs(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gn(...e.split("."))._internalPath}catch{throw qs(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function qs(n,e,t,r,i){let o=r&&!r.isEmpty(),a=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let h="";return(o||a)&&(h+=" (found",o&&(h+=` in field ${r}`),a&&(h+=` in document ${i}`),h+=")"),new x(C.INVALID_ARGUMENT,c+n+h)}function kp(n,e){return n.some(t=>t.isEqual(e))}var zs=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new kc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Np("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},kc=class extends zs{data(){return super.data()}};function Np(n,e){return typeof e=="string"?el(n,e):e instanceof Gn?e._internalPath:e._delegate._internalPath}function qE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(C.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Nc=class{convertValue(e,t="none"){switch(sn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Lt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw V()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return hn(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ie(a.doubleValue));return new Kr(o)}convertGeoPoint(e){return new Wr(ie(e.latitude),ie(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Mc(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Vr(e));default:return null}}convertTimestamp(e){let t=vt(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=oe.fromString(e);X(ap(r));let i=new Is(r.get(1),r.get(3)),o=new L(r.popFirst(5));return i.isEqual(t)||yt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function zE(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Rn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Oc=class extends zs{constructor(e,t,r,i,o,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new kn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Np("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},kn=class extends Oc{data(e={}){return super.data(e)}},Fc=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Rn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new kn(this._firestore,this._userDataWriter,r.key,r,new Rn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(C.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{let h=new kn(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Rn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:h,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>o||c.type!==3).map(c=>{let h=new kn(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Rn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:jE(c.type),doc:h,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function jE(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return V()}}var xc=class extends Nc{constructor(e){super(),this.firestore=e}convertBytes(e){return new jr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Be(this.firestore,null,t)}};function Op(n){n=cn(n,Ms);let e=cn(n.firestore,ln),t=bp(e),r=new xc(e);return qE(n._query),OE(t,n._query).then(i=>new Fc(e,r,n,i))}function Fp(n,e,t,...r){n=cn(n,Be);let i=cn(n.firestore,ln),o=Cp(i),a;return a=typeof(e=pe(e))=="string"||e instanceof Gn?BE(o,"updateDoc",n._key,e,t,r):UE(o,"updateDoc",n._key,e),tl(i,[a.toMutation(n._key,_t.exists(!0))])}function xp(n){return tl(cn(n.firestore,ln),[new Ur(n._key,_t.none())])}function Lp(n,e){let t=cn(n.firestore,ln),r=Ys(n),i=zE(n.converter,e);return tl(t,[ME(Cp(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,_t.exists(!1))]).then(()=>r)}function tl(n,e){return function(r,i){let o=new Ye;return r.asyncQueue.enqueueAndForget(()=>y(this,null,function*(){return EE(yield kE(r),i,o)})),o.promise}(bp(n),e)}(function(e,t=!0){(function(i){Wn=i})(kt),Pt(new Ve("firestore",(r,{instanceIdentifier:i,options:o})=>{let a=r.getProvider("app").getImmediate(),c=new ln(new su(r.getProvider("auth-internal")),new cu(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new x(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Is(d.options.projectId,p)}(a,i),a);return o=Object.assign({useFetchStreams:t},o),c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),_e(Zd,"4.7.3",e),_e(Zd,"4.7.3","esm2017")})();var Vp=class n{app=Ti(Yd);db=Dp(this.app);auth=at(ft);constructor(){}addTask(e){return y(this,null,function*(){let t=this.auth.currentUser;if(t){let r=Xc(this.db,`users/${t.uid}/checklists`);yield Lp(r,_n({},e))}else console.log("not login")})}getTasks(){let e=this.auth.currentUser?.uid;return new bt(t=>{if(!e){t.error("User Not Ligged In");return}let r=Xc(this.db,`users/${e}/checklists`);Op(r).then(i=>{let o=i.docs.map(a=>{let c=a.data();return{id:a.id,date:c.date.toDate(),title:c.title,tasks:c.tasks}});t.next(o),t.complete()}).catch(i=>{t.error(i)})})}deleteTask(e){xp(Ys(this.db,`users/${this.auth.currentUser?.uid}/checklists/${e}`))}updateTask(e,t){let r=Ys(this.db,`users/${this.auth.currentUser?.uid}/checklists/${e}`);Fp(r,_n({},t))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=ke({token:n,factory:n.\u0275fac,providedIn:"root"})};var nl=gh("notes"),aA=yi(nl,n=>n.userName),uA=yi(nl,n=>n.tasks),cA=yi(nl,n=>n.curentTask);var Mp=class n{destroy$=new ih;ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}static \u0275fac=function(t){return new(t||n)};static \u0275dir=gi({type:n,selectors:[["","appClearObservable",""]],standalone:!0})};export{Ua as a,_T as b,Ld as c,zd as d,vv as e,yT as f,vT as g,IT as h,ET as i,wT as j,TT as k,AT as l,$d as m,Ti as n,Yd as o,kw as p,b0 as q,S0 as r,Vp as s,aA as t,uA as u,cA as v,Mp as w,xd as x};
